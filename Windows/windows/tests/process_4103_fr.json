{
  "input": {
    "message": "{\"EventTime\":\"2011-04-18 14:51:32\",\"Hostname\":\"PCFOO4147.corp.net\",\"Keywords\":0,\"EventType\":\"INFO\",\"SeverityValue\":2,\"Severity\":\"INFO\",\"EventID\":4103,\"SourceName\":\"Microsoft-Windows-PowerShell\",\"ProviderGuid\":\"{A0C1853B-5C40-4B15-8766-3CF1C58F985A}\",\"Version\":1,\"Task\":106,\"OpcodeValue\":20,\"RecordNumber\":1079309,\"ActivityID\":\"{83B38D2A-3444-0004-D607-B4834434D701}\",\"ProcessID\":5532,\"ThreadID\":7212,\"Channel\":\"Microsoft-Windows-PowerShell/Operational\",\"Domain\":\"AUTORITE NT\",\"AccountName\":\"Syst\u00e8me\",\"UserID\":\"S-1-5-18\",\"AccountType\":\"User\",\"Message\":\"CommandInvocation (Out-Default) : \u00ab Out-Default \u00bb\\r\\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=ApplicationFrameHost} \u00bb\\r\\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=armsvc} \u00bb\\r\\n\\r\\n\\r\\n\\r\\nContexte :\\r\\n        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.18362.1171\\r\\n        ID d\u2019h\u00f4te = b9b8ea4b-cd03-4f71-86f7-2fd8e89b52a4\\r\\n        Application h\u00f4te = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.18362.1171\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = bad57214-6381-4f0a-a2ea-ad1575bdb55d\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = \\r\\n        Type de commande = Script\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence = 18\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\\r\\n\\r\\nDonn\u00e9es utilisateur :\\r\\n\\r\\n\",\"Category\":\"Ex\u00e9cution du pipeline\",\"Opcode\":\"\u00c0 utiliser lorsque l'op\u00e9ration ex\u00e9cute uniquement une m\u00e9thode\",\"ContextInfo\":\"        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.18362.1171\\r\\n        ID d\u2019h\u00f4te = b9b8ea4b-cd03-4f71-86f7-2fd8e89b52a4\\r\\n        Application h\u00f4te = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.18362.1171\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = bad57214-6381-4f0a-a2ea-ad1575bdb55d\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = \\r\\n        Type de commande = Script\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence = 18\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\",\"Payload\":\"CommandInvocation (Out-Default) : \u00ab Out-Default \u00bb\\r\\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=ApplicationFrameHost} \u00bb\\r\\n\",\"EventReceivedTime\":\"2011-04-18 14:51:33\",\"SourceModuleName\":\"evtx_win\",\"SourceModuleType\":\"im_msvistalog\"}"
  },
  "expected": {
    "message": "{\"EventTime\":\"2011-04-18 14:51:32\",\"Hostname\":\"PCFOO4147.corp.net\",\"Keywords\":0,\"EventType\":\"INFO\",\"SeverityValue\":2,\"Severity\":\"INFO\",\"EventID\":4103,\"SourceName\":\"Microsoft-Windows-PowerShell\",\"ProviderGuid\":\"{A0C1853B-5C40-4B15-8766-3CF1C58F985A}\",\"Version\":1,\"Task\":106,\"OpcodeValue\":20,\"RecordNumber\":1079309,\"ActivityID\":\"{83B38D2A-3444-0004-D607-B4834434D701}\",\"ProcessID\":5532,\"ThreadID\":7212,\"Channel\":\"Microsoft-Windows-PowerShell/Operational\",\"Domain\":\"AUTORITE NT\",\"AccountName\":\"Syst\u00e8me\",\"UserID\":\"S-1-5-18\",\"AccountType\":\"User\",\"Message\":\"CommandInvocation (Out-Default) : \u00ab Out-Default \u00bb\\r\\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=ApplicationFrameHost} \u00bb\\r\\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=armsvc} \u00bb\\r\\n\\r\\n\\r\\n\\r\\nContexte :\\r\\n        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.18362.1171\\r\\n        ID d\u2019h\u00f4te = b9b8ea4b-cd03-4f71-86f7-2fd8e89b52a4\\r\\n        Application h\u00f4te = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.18362.1171\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = bad57214-6381-4f0a-a2ea-ad1575bdb55d\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = \\r\\n        Type de commande = Script\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence = 18\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\\r\\n\\r\\nDonn\u00e9es utilisateur :\\r\\n\\r\\n\",\"Category\":\"Ex\u00e9cution du pipeline\",\"Opcode\":\"\u00c0 utiliser lorsque l'op\u00e9ration ex\u00e9cute uniquement une m\u00e9thode\",\"ContextInfo\":\"        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.18362.1171\\r\\n        ID d\u2019h\u00f4te = b9b8ea4b-cd03-4f71-86f7-2fd8e89b52a4\\r\\n        Application h\u00f4te = C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.18362.1171\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = bad57214-6381-4f0a-a2ea-ad1575bdb55d\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = \\r\\n        Type de commande = Script\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence = 18\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\",\"Payload\":\"CommandInvocation (Out-Default) : \u00ab Out-Default \u00bb\\r\\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=ApplicationFrameHost} \u00bb\\r\\n\",\"EventReceivedTime\":\"2011-04-18 14:51:33\",\"SourceModuleName\":\"evtx_win\",\"SourceModuleType\":\"im_msvistalog\"}",
    "event": {
      "code": "4103",
      "message": "CommandInvocation (Out-Default) : \u00ab Out-Default \u00bb\r\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=ApplicationFrameHost} \u00bb\r\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=armsvc} \u00bb\r\n\r\n\r\n\r\nContexte :\r\n        Gravit\u00e9 = Informational\r\n        Nom d\u2019h\u00f4te = ConsoleHost\r\n        Version de l\u2019h\u00f4te = 5.1.18362.1171\r\n        ID d\u2019h\u00f4te = b9b8ea4b-cd03-4f71-86f7-2fd8e89b52a4\r\n        Application h\u00f4te = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe get-process | select processname\r\n        Version du moteur = 5.1.18362.1171\r\n        ID d\u2019instance d\u2019ex\u00e9cution = bad57214-6381-4f0a-a2ea-ad1575bdb55d\r\n        ID de pipeline = 1\r\n        Nom de commande = \r\n        Type de commande = Script\r\n        Nom du script = \r\n        Chemin de la commande = \r\n        Num\u00e9ro de s\u00e9quence = 18\r\n        Utilisateur = FOOBAR\\Syst\u00e8me\r\n        Utilisateur connect\u00e9 = \r\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\r\n\r\n\r\nDonn\u00e9es utilisateur :\r\n\r\n",
      "provider": "Microsoft-Windows-PowerShell"
    },
    "action": {
      "id": 4103,
      "properties": {
        "AccountName": "Syst\u00e8me",
        "AccountType": "User",
        "Category": "Ex\u00e9cution du pipeline",
        "ContextInfo": "        Gravit\u00e9 = Informational\r\n        Nom d\u2019h\u00f4te = ConsoleHost\r\n        Version de l\u2019h\u00f4te = 5.1.18362.1171\r\n        ID d\u2019h\u00f4te = b9b8ea4b-cd03-4f71-86f7-2fd8e89b52a4\r\n        Application h\u00f4te = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe get-process | select processname\r\n        Version du moteur = 5.1.18362.1171\r\n        ID d\u2019instance d\u2019ex\u00e9cution = bad57214-6381-4f0a-a2ea-ad1575bdb55d\r\n        ID de pipeline = 1\r\n        Nom de commande = \r\n        Type de commande = Script\r\n        Nom du script = \r\n        Chemin de la commande = \r\n        Num\u00e9ro de s\u00e9quence = 18\r\n        Utilisateur = FOOBAR\\Syst\u00e8me\r\n        Utilisateur connect\u00e9 = \r\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\r\n",
        "Domain": "AUTORITE NT",
        "EventType": "INFO",
        "HostApplication": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe get-process | select processname",
        "HostName": "ConsoleHost",
        "Keywords": "0",
        "OpcodeValue": 20,
        "Payload": "CommandInvocation (Out-Default) : \u00ab Out-Default \u00bb\r\nLiaison de param\u00e8tre (Out-Default) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab @{ProcessName=ApplicationFrameHost} \u00bb\r\n",
        "ProviderGuid": "{A0C1853B-5C40-4B15-8766-3CF1C58F985A}",
        "Severity": "INFO",
        "SourceName": "Microsoft-Windows-PowerShell",
        "Task": 106
      },
      "record_id": 1079309,
      "type": "Microsoft-Windows-PowerShell/Operational"
    },
    "host": {
      "hostname": "PCFOO4147.corp.net",
      "name": "PCFOO4147.corp.net"
    },
    "log": {
      "hostname": "PCFOO4147.corp.net",
      "level": "info"
    },
    "os": {
      "family": "windows",
      "platform": "windows"
    },
    "process": {
      "id": 5532,
      "name": "powershell.exe",
      "pid": 5532,
      "thread": {
        "id": 7212
      }
    },
    "related": {
      "hosts": [
        "PCFOO4147.corp.net"
      ],
      "user": [
        "Syst\u00e8me"
      ]
    },
    "user": {
      "domain": "AUTORITE NT",
      "id": "S-1-5-18",
      "name": "Syst\u00e8me"
    }
  }
}