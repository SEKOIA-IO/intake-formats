{
  "input": {
    "message": "{\"EventTime\":\"2012-09-13 16:15:44\",\"Hostname\":\"<REDACTED>\",\"Keywords\":-9182839640208441000,\"EventType\":\"AUDIT_FAILURE\",\"SeverityValue\":4,\"Severity\":\"ERROR\",\"EventID\":1201,\"SourceName\":\"AD FS Auditing\",\"Task\":3,\"RecordNumber\":1012533579,\"ProcessID\":0,\"ThreadID\":0,\"Channel\":\"Security\",\"Domain\":\"KEY\",\"AccountName\":\"<REDACTED>\",\"UserID\":\"S-1-5-21-0000000000-0000000000-0000000000-000000\",\"AccountType\":\"User\",\"Message\":\"The Federation Service failed to issue a valid token. See XML for failure details. \\r\\n\\r\\nActivity ID: bc38fffc-f8ab-42f2-b5e3-69fabf2e20e6 \\r\\n\\r\\nAdditional Data \\r\\nXML: <?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?>\\r\\n<AuditBase xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:type=\\\"AppTokenAudit\\\">\\r\\n  <AuditType>AppToken</AuditType>\\r\\n  <AuditResult>Failure</AuditResult>\\r\\n  <FailureType>GenericError</FailureType>\\r\\n  <ErrorCode>N/A</ErrorCode>\\r\\n  <ContextComponents>\\r\\n    <Component xsi:type=\\\"ResourceAuditComponent\\\">\\r\\n      <RelyingParty>http://auth.example.org/adfs/services/trust</RelyingParty>\\r\\n      <ClaimsProvider>N/A</ClaimsProvider>\\r\\n      <UserId>firstname.lastname@example.org</UserId>\\r\\n    </Component>\\r\\n    <Component xsi:type=\\\"AuthNAuditComponent\\\">\\r\\n      <PrimaryAuth>N/A</PrimaryAuth>\\r\\n      <DeviceAuth>false</DeviceAuth>\\r\\n      <DeviceId>N/A</DeviceId>\\r\\n      <MfaPerformed>false</MfaPerformed>\\r\\n      <MfaMethod>N/A</MfaMethod>\\r\\n      <TokenBindingProvidedId>false</TokenBindingProvidedId>\\r\\n      <TokenBindingReferredId>false</TokenBindingReferredId>\\r\\n      <SsoBindingValidationLevel>NotSet</SsoBindingValidationLevel>\\r\\n    </Component>\\r\\n    <Component xsi:type=\\\"ProtocolAuditComponent\\\">\\r\\n      <OAuthClientId>N/A</OAuthClientId>\\r\\n      <OAuthGrant>N/A</OAuthGrant>\\r\\n    </Component>\\r\\n    <Component xsi:type=\\\"RequestAuditComponent\\\">\\r\\n      <Server>http://auth.example.org/adfs/services/trust</Server>\\r\\n      <AuthProtocol>WSFederation</AuthProtocol>\\r\\n      <NetworkLocation>Extranet</NetworkLocation>\\r\\n      <IpAddress>1.1.1.1,1.1.1.1,1.1.1.1</IpAddress>\\r\\n      <ForwardedIpAddress>1.1.1.1,1.1.1.1,1.1.1.1</ForwardedIpAddress>\\r\\n      <ProxyIpAddress>N/A</ProxyIpAddress>\\r\\n      <NetworkIpAddress>N/A</NetworkIpAddress>\\r\\n      <ProxyServer>proxy-server</ProxyServer>\\r\\n      <UserAgentString>Mozilla/5.0 (Linux; Android 11; SM-A217F Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/94.0.4606.85 Mobile Safari/537.36</UserAgentString>\\r\\n      <Endpoint>/adfs/ls/</Endpoint>\\r\\n    </Component>\\r\\n  </ContextComponents>\\r\\n</AuditBase>\",\"Opcode\":\"Info\",\"EventReceivedTime\":\"2012-09-13 16:15:45\",\"SourceModuleName\":\"in\",\"SourceModuleType\":\"im_msvistalog\"}"
  },
  "expected": {
    "message": "{\"EventTime\":\"2012-09-13 16:15:44\",\"Hostname\":\"<REDACTED>\",\"Keywords\":-9182839640208441000,\"EventType\":\"AUDIT_FAILURE\",\"SeverityValue\":4,\"Severity\":\"ERROR\",\"EventID\":1201,\"SourceName\":\"AD FS Auditing\",\"Task\":3,\"RecordNumber\":1012533579,\"ProcessID\":0,\"ThreadID\":0,\"Channel\":\"Security\",\"Domain\":\"KEY\",\"AccountName\":\"<REDACTED>\",\"UserID\":\"S-1-5-21-0000000000-0000000000-0000000000-000000\",\"AccountType\":\"User\",\"Message\":\"The Federation Service failed to issue a valid token. See XML for failure details. \\r\\n\\r\\nActivity ID: bc38fffc-f8ab-42f2-b5e3-69fabf2e20e6 \\r\\n\\r\\nAdditional Data \\r\\nXML: <?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?>\\r\\n<AuditBase xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:type=\\\"AppTokenAudit\\\">\\r\\n  <AuditType>AppToken</AuditType>\\r\\n  <AuditResult>Failure</AuditResult>\\r\\n  <FailureType>GenericError</FailureType>\\r\\n  <ErrorCode>N/A</ErrorCode>\\r\\n  <ContextComponents>\\r\\n    <Component xsi:type=\\\"ResourceAuditComponent\\\">\\r\\n      <RelyingParty>http://auth.example.org/adfs/services/trust</RelyingParty>\\r\\n      <ClaimsProvider>N/A</ClaimsProvider>\\r\\n      <UserId>firstname.lastname@example.org</UserId>\\r\\n    </Component>\\r\\n    <Component xsi:type=\\\"AuthNAuditComponent\\\">\\r\\n      <PrimaryAuth>N/A</PrimaryAuth>\\r\\n      <DeviceAuth>false</DeviceAuth>\\r\\n      <DeviceId>N/A</DeviceId>\\r\\n      <MfaPerformed>false</MfaPerformed>\\r\\n      <MfaMethod>N/A</MfaMethod>\\r\\n      <TokenBindingProvidedId>false</TokenBindingProvidedId>\\r\\n      <TokenBindingReferredId>false</TokenBindingReferredId>\\r\\n      <SsoBindingValidationLevel>NotSet</SsoBindingValidationLevel>\\r\\n    </Component>\\r\\n    <Component xsi:type=\\\"ProtocolAuditComponent\\\">\\r\\n      <OAuthClientId>N/A</OAuthClientId>\\r\\n      <OAuthGrant>N/A</OAuthGrant>\\r\\n    </Component>\\r\\n    <Component xsi:type=\\\"RequestAuditComponent\\\">\\r\\n      <Server>http://auth.example.org/adfs/services/trust</Server>\\r\\n      <AuthProtocol>WSFederation</AuthProtocol>\\r\\n      <NetworkLocation>Extranet</NetworkLocation>\\r\\n      <IpAddress>1.1.1.1,1.1.1.1,1.1.1.1</IpAddress>\\r\\n      <ForwardedIpAddress>1.1.1.1,1.1.1.1,1.1.1.1</ForwardedIpAddress>\\r\\n      <ProxyIpAddress>N/A</ProxyIpAddress>\\r\\n      <NetworkIpAddress>N/A</NetworkIpAddress>\\r\\n      <ProxyServer>proxy-server</ProxyServer>\\r\\n      <UserAgentString>Mozilla/5.0 (Linux; Android 11; SM-A217F Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/94.0.4606.85 Mobile Safari/537.36</UserAgentString>\\r\\n      <Endpoint>/adfs/ls/</Endpoint>\\r\\n    </Component>\\r\\n  </ContextComponents>\\r\\n</AuditBase>\",\"Opcode\":\"Info\",\"EventReceivedTime\":\"2012-09-13 16:15:45\",\"SourceModuleName\":\"in\",\"SourceModuleType\":\"im_msvistalog\"}",
    "event": {
      "code": "1201",
      "message": "The Federation Service failed to issue a valid token. See XML for failure details. \r\n\r\nActivity ID: bc38fffc-f8ab-42f2-b5e3-69fabf2e20e6 \r\n\r\nAdditional Data \r\nXML: <?xml version=\"1.0\" encoding=\"utf-16\"?>\r\n<AuditBase xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"AppTokenAudit\">\r\n  <AuditType>AppToken</AuditType>\r\n  <AuditResult>Failure</AuditResult>\r\n  <FailureType>GenericError</FailureType>\r\n  <ErrorCode>N/A</ErrorCode>\r\n  <ContextComponents>\r\n    <Component xsi:type=\"ResourceAuditComponent\">\r\n      <RelyingParty>http://auth.example.org/adfs/services/trust</RelyingParty>\r\n      <ClaimsProvider>N/A</ClaimsProvider>\r\n      <UserId>firstname.lastname@example.org</UserId>\r\n    </Component>\r\n    <Component xsi:type=\"AuthNAuditComponent\">\r\n      <PrimaryAuth>N/A</PrimaryAuth>\r\n      <DeviceAuth>false</DeviceAuth>\r\n      <DeviceId>N/A</DeviceId>\r\n      <MfaPerformed>false</MfaPerformed>\r\n      <MfaMethod>N/A</MfaMethod>\r\n      <TokenBindingProvidedId>false</TokenBindingProvidedId>\r\n      <TokenBindingReferredId>false</TokenBindingReferredId>\r\n      <SsoBindingValidationLevel>NotSet</SsoBindingValidationLevel>\r\n    </Component>\r\n    <Component xsi:type=\"ProtocolAuditComponent\">\r\n      <OAuthClientId>N/A</OAuthClientId>\r\n      <OAuthGrant>N/A</OAuthGrant>\r\n    </Component>\r\n    <Component xsi:type=\"RequestAuditComponent\">\r\n      <Server>http://auth.example.org/adfs/services/trust</Server>\r\n      <AuthProtocol>WSFederation</AuthProtocol>\r\n      <NetworkLocation>Extranet</NetworkLocation>\r\n      <IpAddress>1.1.1.1,1.1.1.1,1.1.1.1</IpAddress>\r\n      <ForwardedIpAddress>1.1.1.1,1.1.1.1,1.1.1.1</ForwardedIpAddress>\r\n      <ProxyIpAddress>N/A</ProxyIpAddress>\r\n      <NetworkIpAddress>N/A</NetworkIpAddress>\r\n      <ProxyServer>proxy-server</ProxyServer>\r\n      <UserAgentString>Mozilla/5.0 (Linux; Android 11; SM-A217F Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/94.0.4606.85 Mobile Safari/537.36</UserAgentString>\r\n      <Endpoint>/adfs/ls/</Endpoint>\r\n    </Component>\r\n  </ContextComponents>\r\n</AuditBase>",
      "outcome": "failure",
      "provider": "AD FS Auditing"
    },
    "action": {
      "id": 1201,
      "outcome": "failure",
      "properties": {
        "AccountName": "<REDACTED>",
        "AccountType": "User",
        "Domain": "KEY",
        "EventType": "AUDIT_FAILURE",
        "Keywords": "-9182839640208441000",
        "ProxyServer": "proxy-server",
        "Severity": "ERROR",
        "SourceName": "AD FS Auditing",
        "Task": 3
      },
      "record_id": 1012533579,
      "type": "Security"
    },
    "host": {
      "hostname": "<REDACTED>",
      "name": "<REDACTED>"
    },
    "log": {
      "hostname": "<REDACTED>",
      "level": "error"
    },
    "os": {
      "family": "windows",
      "platform": "windows"
    },
    "process": {
      "id": 0,
      "pid": 0,
      "thread": {
        "id": 0
      }
    },
    "related": {
      "hosts": [
        "<REDACTED>"
      ],
      "ip": [
        "1.1.1.1"
      ],
      "user": [
        "<REDACTED>"
      ]
    },
    "source": {
      "address": "1.1.1.1",
      "ip": "1.1.1.1"
    },
    "user": {
      "domain": "KEY",
      "id": "S-1-5-21-0000000000-0000000000-0000000000-000000",
      "name": "<REDACTED>"
    },
    "user_agent": {
      "device": {
        "name": "Samsung SM-A217F"
      },
      "name": "Chrome Mobile WebView",
      "original": "Mozilla/5.0 (Linux; Android 11; SM-A217F Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/94.0.4606.85 Mobile Safari/537.36",
      "os": {
        "name": "Android",
        "version": "11"
      },
      "version": "94.0.4606"
    }
  }
}