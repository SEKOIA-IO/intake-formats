{
  "input": {
    "message": "{\"EventTime\":\"2011-06-02 15:04:18\",\"Hostname\":\"PCFOO.corp.net\",\"Keywords\":0,\"EventType\":\"INFO\",\"SeverityValue\":2,\"Severity\":\"INFO\",\"EventID\":4103,\"SourceName\":\"Microsoft-Windows-PowerShell\",\"ProviderGuid\":\"{A0C1853B-5C40-4B15-8766-3CF1C58F985A}\",\"Version\":1,\"Task\":106,\"OpcodeValue\":20,\"RecordNumber\":712900,\"ActivityID\":\"{260C9E3C-4B0F-0002-DC86-2D260F4BD701}\",\"ProcessID\":22244,\"ThreadID\":16456,\"Channel\":\"Microsoft-Windows-PowerShell/Operational\",\"Domain\":\"AUTORITE NT\",\"AccountName\":\"Syst\u00e8me\",\"UserID\":\"S-1-5-18\",\"AccountType\":\"User\",\"Message\":\"CommandInvocation (Select-Object) : \u00ab Select-Object \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab First \u00bb ; valeur = \u00ab 1 \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab __AllParameterSets \u00bb\\r\\n\\r\\n\\r\\nContexte :\\r\\n        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.19041.906\\r\\n        ID d\u2019h\u00f4te = d480b34d-9bc5-4b03-bef2-0c4642484e60\\r\\n        Application h\u00f4te = C:\\\\WINDOWS\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.19041.906\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = de38a11e-707d-4cc0-a009-a4af63866bf6\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = Select-Object\\r\\n        Type de commande = Cmdlet\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence = 138\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\\r\\n\\r\\nDonn\u00e9es utilisateur :\\r\\n\\r\\n\",\"Category\":\"Ex\u00e9cution du pipeline\",\"Opcode\":\"\u00c0 utiliser lorsque l'op\u00e9ration ex\u00e9cute uniquement une m\u00e9thode\",\"ContextInfo\":\"        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.19041.906\\r\\n        ID d\u2019h\u00f4te = d480b34d-9bc5-4b03-bef2-0c4642484e60\\r\\n        Application h\u00f4te = C:\\\\WINDOWS\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.19041.906\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = de38a11e-707d-4cc0-a009-a4af63866bf6\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = Select-Object\\r\\n        Type de commande = Cmdlet\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence\u00a0= 138\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\",\"Payload\":\"CommandInvocation (Select-Object) : \u00ab Select-Object \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab First \u00bb ; valeur = \u00ab 1 \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab __AllParameterSets \u00bb\\r\\n\",\"EventReceivedTime\":\"2011-06-02 15:04:18\",\"SourceModuleName\":\"evtx_win\",\"SourceModuleType\":\"im_msvistalog\"}"
  },
  "expected": {
    "message": "{\"EventTime\":\"2011-06-02 15:04:18\",\"Hostname\":\"PCFOO.corp.net\",\"Keywords\":0,\"EventType\":\"INFO\",\"SeverityValue\":2,\"Severity\":\"INFO\",\"EventID\":4103,\"SourceName\":\"Microsoft-Windows-PowerShell\",\"ProviderGuid\":\"{A0C1853B-5C40-4B15-8766-3CF1C58F985A}\",\"Version\":1,\"Task\":106,\"OpcodeValue\":20,\"RecordNumber\":712900,\"ActivityID\":\"{260C9E3C-4B0F-0002-DC86-2D260F4BD701}\",\"ProcessID\":22244,\"ThreadID\":16456,\"Channel\":\"Microsoft-Windows-PowerShell/Operational\",\"Domain\":\"AUTORITE NT\",\"AccountName\":\"Syst\u00e8me\",\"UserID\":\"S-1-5-18\",\"AccountType\":\"User\",\"Message\":\"CommandInvocation (Select-Object) : \u00ab Select-Object \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab First \u00bb ; valeur = \u00ab 1 \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab __AllParameterSets \u00bb\\r\\n\\r\\n\\r\\nContexte :\\r\\n        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.19041.906\\r\\n        ID d\u2019h\u00f4te = d480b34d-9bc5-4b03-bef2-0c4642484e60\\r\\n        Application h\u00f4te = C:\\\\WINDOWS\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.19041.906\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = de38a11e-707d-4cc0-a009-a4af63866bf6\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = Select-Object\\r\\n        Type de commande = Cmdlet\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence = 138\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\\r\\n\\r\\nDonn\u00e9es utilisateur :\\r\\n\\r\\n\",\"Category\":\"Ex\u00e9cution du pipeline\",\"Opcode\":\"\u00c0 utiliser lorsque l'op\u00e9ration ex\u00e9cute uniquement une m\u00e9thode\",\"ContextInfo\":\"        Gravit\u00e9 = Informational\\r\\n        Nom d\u2019h\u00f4te = ConsoleHost\\r\\n        Version de l\u2019h\u00f4te = 5.1.19041.906\\r\\n        ID d\u2019h\u00f4te = d480b34d-9bc5-4b03-bef2-0c4642484e60\\r\\n        Application h\u00f4te = C:\\\\WINDOWS\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe get-process | select processname\\r\\n        Version du moteur = 5.1.19041.906\\r\\n        ID d\u2019instance d\u2019ex\u00e9cution = de38a11e-707d-4cc0-a009-a4af63866bf6\\r\\n        ID de pipeline = 1\\r\\n        Nom de commande = Select-Object\\r\\n        Type de commande = Cmdlet\\r\\n        Nom du script = \\r\\n        Chemin de la commande = \\r\\n        Num\u00e9ro de s\u00e9quence\u00a0= 138\\r\\n        Utilisateur = FOOBAR\\\\Syst\u00e8me\\r\\n        Utilisateur connect\u00e9 = \\r\\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\\r\\n\",\"Payload\":\"CommandInvocation (Select-Object) : \u00ab Select-Object \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab First \u00bb ; valeur = \u00ab 1 \u00bb\\r\\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab __AllParameterSets \u00bb\\r\\n\",\"EventReceivedTime\":\"2011-06-02 15:04:18\",\"SourceModuleName\":\"evtx_win\",\"SourceModuleType\":\"im_msvistalog\"}",
    "event": {
      "code": "4103",
      "message": "CommandInvocation (Select-Object) : \u00ab Select-Object \u00bb\r\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab First \u00bb ; valeur = \u00ab 1 \u00bb\r\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab __AllParameterSets \u00bb\r\n\r\n\r\nContexte :\r\n        Gravit\u00e9 = Informational\r\n        Nom d\u2019h\u00f4te = ConsoleHost\r\n        Version de l\u2019h\u00f4te = 5.1.19041.906\r\n        ID d\u2019h\u00f4te = d480b34d-9bc5-4b03-bef2-0c4642484e60\r\n        Application h\u00f4te = C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe get-process | select processname\r\n        Version du moteur = 5.1.19041.906\r\n        ID d\u2019instance d\u2019ex\u00e9cution = de38a11e-707d-4cc0-a009-a4af63866bf6\r\n        ID de pipeline = 1\r\n        Nom de commande = Select-Object\r\n        Type de commande = Cmdlet\r\n        Nom du script = \r\n        Chemin de la commande = \r\n        Num\u00e9ro de s\u00e9quence = 138\r\n        Utilisateur = FOOBAR\\Syst\u00e8me\r\n        Utilisateur connect\u00e9 = \r\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\r\n\r\n\r\nDonn\u00e9es utilisateur :\r\n\r\n",
      "provider": "Microsoft-Windows-PowerShell"
    },
    "action": {
      "id": 4103,
      "properties": {
        "AccountName": "Syst\u00e8me",
        "AccountType": "User",
        "Category": "Ex\u00e9cution du pipeline",
        "ContextInfo": "        Gravit\u00e9 = Informational\r\n        Nom d\u2019h\u00f4te = ConsoleHost\r\n        Version de l\u2019h\u00f4te = 5.1.19041.906\r\n        ID d\u2019h\u00f4te = d480b34d-9bc5-4b03-bef2-0c4642484e60\r\n        Application h\u00f4te = C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe get-process | select processname\r\n        Version du moteur = 5.1.19041.906\r\n        ID d\u2019instance d\u2019ex\u00e9cution = de38a11e-707d-4cc0-a009-a4af63866bf6\r\n        ID de pipeline = 1\r\n        Nom de commande = Select-Object\r\n        Type de commande = Cmdlet\r\n        Nom du script = \r\n        Chemin de la commande = \r\n        Num\u00e9ro de s\u00e9quence = 138\r\n        Utilisateur = FOOBAR\\Syst\u00e8me\r\n        Utilisateur connect\u00e9 = \r\n        ID d\u2019interpr\u00e9teur de commandes = Microsoft.PowerShell\r\n",
        "Domain": "AUTORITE NT",
        "EventType": "INFO",
        "HostApplication": "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe get-process | select processname",
        "HostName": "ConsoleHost",
        "Keywords": "0",
        "OpcodeValue": 20,
        "Payload": "CommandInvocation (Select-Object) : \u00ab Select-Object \u00bb\r\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab First \u00bb ; valeur = \u00ab 1 \u00bb\r\nLiaison de param\u00e8tre (Select-Object) : nom = \u00ab InputObject \u00bb ; valeur = \u00ab __AllParameterSets \u00bb\r\n",
        "ProviderGuid": "{A0C1853B-5C40-4B15-8766-3CF1C58F985A}",
        "Severity": "INFO",
        "SourceName": "Microsoft-Windows-PowerShell",
        "Task": 106
      },
      "record_id": 712900,
      "type": "Microsoft-Windows-PowerShell/Operational"
    },
    "host": {
      "hostname": "PCFOO",
      "name": "PCFOO.corp.net"
    },
    "log": {
      "hostname": "PCFOO.corp.net",
      "level": "info"
    },
    "os": {
      "family": "windows",
      "platform": "windows"
    },
    "process": {
      "id": 22244,
      "name": "powershell.exe",
      "pid": 22244,
      "thread": {
        "id": 16456
      }
    },
    "related": {
      "hosts": [
        "PCFOO"
      ],
      "user": [
        "Syst\u00e8me"
      ]
    },
    "user": {
      "domain": "AUTORITE NT",
      "id": "S-1-5-18",
      "name": "Syst\u00e8me"
    }
  }
}