{
  "input": {
    "message": "{\n  \"@timestamp\": \"2024-07-12T11:44:00.978Z\",\n  \"log\": {\n    \"level\": \"information\"\n  },\n  \"@version\": \"1\",\n  \"event\": {\n    \"action\": \"Kerberos Authentication Service\",\n    \"outcome\": \"failure\",\n    \"created\": \"2024-07-12T11:44:01.917Z\",\n    \"provider\": \"Microsoft-Windows-Security-Auditing\",\n    \"kind\": \"event\",\n    \"code\": \"4768\"\n  },\n  \"message\": \"A Kerberos authentication ticket (TGT) was requested.\\n\\nAccount Information:\\n\\tAccount Name:\\t\\ttestusername\\n\\tSupplied Realm Name:\\ttest.local\\n\\tUser ID:\\t\\t\\tS-1-0-0\\n\\nService Information:\\n\\tService Name:\\t\\tkrbtgt/test.local\\n\\tService ID:\\t\\tS-1-0-0\\n\\nNetwork Information:\\n\\tClient Address:\\t\\t::ffff:1.2.3.4\\n\\tClient Port:\\t\\t8000\\n\\nAdditional Information:\\n\\tTicket Options:\\t\\t0x40810010\\n\\tResult Code:\\t\\t0x17\\n\\tTicket Encryption Type:\\t0xFFFFFFFF\\n\\tPre-Authentication Type:\\t-\\n\\nCertificate Information:\\n\\tCertificate Issuer Name:\\t\\t\\n\\tCertificate Serial Number:\\t\\n\\tCertificate Thumbprint:\\t\\t\\n\\nCertificate information is only provided if a certificate was used for pre-authentication.\\n\\nPre-authentication types, ticket options, encryption types and result codes are defined in RFC 4120.\",\n  \"winlog\": {\n    \"record_id\": 123123123,\n    \"channel\": \"Security\",\n    \"computer_name\": \"testhost.test.local\",\n    \"provider_guid\": \"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\n    \"process\": {\n      \"thread\": {\n        \"id\": 5732\n      },\n      \"pid\": 652\n    },\n    \"provider_name\": \"Microsoft-Windows-Security-Auditing\",\n    \"api\": \"wineventlog\",\n    \"event_id\": \"4768\",\n    \"event_data\": {\n      \"PreAuthType\": \"-\",\n      \"ServiceName\": \"krbtgt/test.local\",\n      \"TicketOptions\": \"0x40810010\",\n      \"TargetDomainName\": \"test.local\",\n      \"IpAddress\": \"::ffff:1.2.3.4\",\n      \"ServiceSid\": \"S-1-0-0\",\n      \"IpPort\": \"8000\",\n      \"TicketEncryptionType\": \"0xffffffff\",\n      \"Status\": \"0x17\",\n      \"TargetSid\": \"S-1-0-0\",\n      \"TargetUserName\": \"testusername\"\n    },\n    \"task\": \"Kerberos Authentication Service\"\n  },\n  \"ecs\": {\n    \"version\": \"1.12.0\"\n  },\n  \"zone\": \"int\",\n  \"tags\": [\n    \"windows\",\n    \"domain-controller\",\n    \"beats_input_codec_plain_applied\"\n  ],\n  \"site\": \"tl\",\n  \"host\": {\n    \"name\": \"testhost.test.local\"\n  },\n  \"agent\": {\n    \"hostname\": \"testhost\",\n    \"id\": \"xxxxxx-xxxxxx-xxx-xx\",\n    \"ephemeral_id\": \"xxxxxx-xxxxx-xxx-xx\",\n    \"name\": \"testhost\",\n    \"version\": \"7.17.1\",\n    \"type\": \"winlogbeat\"\n  }\n}"
  },
  "expected": {
    "message": "{\n  \"@timestamp\": \"2024-07-12T11:44:00.978Z\",\n  \"log\": {\n    \"level\": \"information\"\n  },\n  \"@version\": \"1\",\n  \"event\": {\n    \"action\": \"Kerberos Authentication Service\",\n    \"outcome\": \"failure\",\n    \"created\": \"2024-07-12T11:44:01.917Z\",\n    \"provider\": \"Microsoft-Windows-Security-Auditing\",\n    \"kind\": \"event\",\n    \"code\": \"4768\"\n  },\n  \"message\": \"A Kerberos authentication ticket (TGT) was requested.\\n\\nAccount Information:\\n\\tAccount Name:\\t\\ttestusername\\n\\tSupplied Realm Name:\\ttest.local\\n\\tUser ID:\\t\\t\\tS-1-0-0\\n\\nService Information:\\n\\tService Name:\\t\\tkrbtgt/test.local\\n\\tService ID:\\t\\tS-1-0-0\\n\\nNetwork Information:\\n\\tClient Address:\\t\\t::ffff:1.2.3.4\\n\\tClient Port:\\t\\t8000\\n\\nAdditional Information:\\n\\tTicket Options:\\t\\t0x40810010\\n\\tResult Code:\\t\\t0x17\\n\\tTicket Encryption Type:\\t0xFFFFFFFF\\n\\tPre-Authentication Type:\\t-\\n\\nCertificate Information:\\n\\tCertificate Issuer Name:\\t\\t\\n\\tCertificate Serial Number:\\t\\n\\tCertificate Thumbprint:\\t\\t\\n\\nCertificate information is only provided if a certificate was used for pre-authentication.\\n\\nPre-authentication types, ticket options, encryption types and result codes are defined in RFC 4120.\",\n  \"winlog\": {\n    \"record_id\": 123123123,\n    \"channel\": \"Security\",\n    \"computer_name\": \"testhost.test.local\",\n    \"provider_guid\": \"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\n    \"process\": {\n      \"thread\": {\n        \"id\": 5732\n      },\n      \"pid\": 652\n    },\n    \"provider_name\": \"Microsoft-Windows-Security-Auditing\",\n    \"api\": \"wineventlog\",\n    \"event_id\": \"4768\",\n    \"event_data\": {\n      \"PreAuthType\": \"-\",\n      \"ServiceName\": \"krbtgt/test.local\",\n      \"TicketOptions\": \"0x40810010\",\n      \"TargetDomainName\": \"test.local\",\n      \"IpAddress\": \"::ffff:1.2.3.4\",\n      \"ServiceSid\": \"S-1-0-0\",\n      \"IpPort\": \"8000\",\n      \"TicketEncryptionType\": \"0xffffffff\",\n      \"Status\": \"0x17\",\n      \"TargetSid\": \"S-1-0-0\",\n      \"TargetUserName\": \"testusername\"\n    },\n    \"task\": \"Kerberos Authentication Service\"\n  },\n  \"ecs\": {\n    \"version\": \"1.12.0\"\n  },\n  \"zone\": \"int\",\n  \"tags\": [\n    \"windows\",\n    \"domain-controller\",\n    \"beats_input_codec_plain_applied\"\n  ],\n  \"site\": \"tl\",\n  \"host\": {\n    \"name\": \"testhost.test.local\"\n  },\n  \"agent\": {\n    \"hostname\": \"testhost\",\n    \"id\": \"xxxxxx-xxxxxx-xxx-xx\",\n    \"ephemeral_id\": \"xxxxxx-xxxxx-xxx-xx\",\n    \"name\": \"testhost\",\n    \"version\": \"7.17.1\",\n    \"type\": \"winlogbeat\"\n  }\n}",
    "event": {
      "action": "Kerberos Authentication Service",
      "code": "4768",
      "kind": "event",
      "module": "security",
      "original": "A Kerberos authentication ticket (TGT) was requested.\n\nAccount Information:\n\tAccount Name:\t\ttestusername\n\tSupplied Realm Name:\ttest.local\n\tUser ID:\t\t\tS-1-0-0\n\nService Information:\n\tService Name:\t\tkrbtgt/test.local\n\tService ID:\t\tS-1-0-0\n\nNetwork Information:\n\tClient Address:\t\t::ffff:1.2.3.4\n\tClient Port:\t\t8000\n\nAdditional Information:\n\tTicket Options:\t\t0x40810010\n\tResult Code:\t\t0x17\n\tTicket Encryption Type:\t0xFFFFFFFF\n\tPre-Authentication Type:\t-\n\nCertificate Information:\n\tCertificate Issuer Name:\t\t\n\tCertificate Serial Number:\t\n\tCertificate Thumbprint:\t\t\n\nCertificate information is only provided if a certificate was used for pre-authentication.\n\nPre-authentication types, ticket options, encryption types and result codes are defined in RFC 4120.",
      "outcome": "failure",
      "provider": "Microsoft-Windows-Security-Auditing"
    },
    "@timestamp": "2024-07-12T11:44:00.978000Z",
    "action": {
      "id": 4768,
      "outcome": "failure",
      "properties": {
        "EventType": "AUDIT_FAILURE",
        "IpAddress": "::ffff:1.2.3.4",
        "IpPort": "8000",
        "PreAuthType": "-",
        "ServiceName": "krbtgt/test.local",
        "ServiceSid": "S-1-0-0",
        "Status": "0x17",
        "TargetDomainName": "test.local",
        "TargetSid": "S-1-0-0",
        "TargetUserName": "testusername",
        "TicketEncryptionType": "0xffffffff",
        "TicketOptions": "0x40810010"
      }
    },
    "agent": {
      "ephemeral_id": "xxxxxx-xxxxx-xxx-xx",
      "id": "xxxxxx-xxxxxx-xxx-xx",
      "name": "testhost",
      "type": "winlogbeat",
      "version": "7.17.1"
    },
    "host": {
      "name": "testhost.test.local"
    },
    "log": {
      "level": "information"
    },
    "related": {
      "ip": [
        "::ffff:102:304"
      ],
      "user": [
        "testusername"
      ]
    },
    "service": {
      "name": "krbtgt/test.local"
    },
    "source": {
      "address": "::ffff:102:304",
      "ip": "::ffff:102:304",
      "port": 8000
    },
    "user": {
      "domain": "test.local",
      "id": "S-1-0-0",
      "name": "testusername",
      "target": {
        "domain": "test.local",
        "name": "testusername"
      }
    },
    "winlog": {
      "api": "wineventlog",
      "channel": "Security",
      "computer_name": "testhost.test.local",
      "event_data": {
        "StatusDescription": "KDC_ERR_KEY_EXPIRED",
        "TicketOptionsDescription": [
          "Forwardable",
          "Name-canonicalize",
          "Renewable",
          "Renewable-ok"
        ]
      },
      "event_id": "4768",
      "process": {
        "pid": 652,
        "thread": {
          "id": 5732
        }
      },
      "provider_guid": "{54849625-5478-4994-a5ba-3e3b0328c30d}",
      "provider_name": "Microsoft-Windows-Security-Auditing",
      "record_id": "123123123",
      "task": "Kerberos Authentication Service"
    }
  }
}