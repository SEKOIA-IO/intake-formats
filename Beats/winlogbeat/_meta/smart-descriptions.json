[
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} logged on to {host.hostname} (LogonType {action.properties.LogonType})",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "logged on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4624
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.LogonType"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} logged on to {host.hostname} from IP {source.ip} (LogonType {action.properties.LogonType})",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "logged on to"
      },
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "connected from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4624
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.LogonType"
      },
      {
        "field": "source.ip"
      }
    ]
  },
  {
    "value": "{action.properties.TargetUserSid} failed to log on to {host.hostname} (LogonType {action.properties.LogonType})",
    "relationships": [
      {
        "source": "action.properties.TargetUserSid",
        "target": "host.hostname",
        "type": "failed to log on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4625
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} failed to log on to {host.hostname} (LogonType {action.properties.LogonType})",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "failed to log on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4625
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} failed to log on to {host.hostname} from IP {source.ip} (LogonType {action.properties.LogonType})",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "failed to log on to"
      },
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "connected from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4625
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "source.ip"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} logged off from {host.hostname}",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "logged off from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4634
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} attempted to log on to {action.properties.TargetServerName} using explicit credentials",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.TargetServerName",
        "type": "attempted to log on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4648
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} attempted to log on to {host.hostname} using explicit credentials",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "attempted to log on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4648
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.TargetServerName",
        "value": "localhost"
      }
    ]
  },
  {
    "value": "{action.properties.SubjectDomainName}\\{action.properties.SubjectUserName} accessed the object {action.properties.ObjectName} on {host.hostname}",
    "relationships": [
      {
        "source": "action.properties.SubjectUserName",
        "target": "action.properties.ObjectName",
        "type": "accessed"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4662
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.SubjectDomainName}\\{action.properties.SubjectUserName} logged on to {host.name} with special privileges",
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "logged on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4672
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.SubjectDomainName"
      },
      {
        "field": "action.properties.SubjectuserName"
      },
      {
        "field": "host.name"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} logged on to {host.name} with special privileges",
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "logged on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4672
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "user.domain"
      },
      {
        "field": "user.name"
      },
      {
        "field": "host.name"
      }
    ]
  },
  {
    "value": "{action.properties.SubjectDomainName}\\{action.properties.SubjectUserName} logged on to {host.name} with special privileges",
    "relationships": [
      {
        "source": "action.properties.SubjectUserName",
        "target": "host.name",
        "type": "logged on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4672
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} executed {process.command_line} on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "user.name",
        "target": "process.parent.executable",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "jost.hostname",
        "type": "executed on"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.executable",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "process.parent.executable",
        "target": "process.command_line",
        "type": "started"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4688
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "Process {process.name} exited. It was executed by {user.domain}\\{user.name} on {host.name}",
    "relationships": [
      {
        "source": "user.name",
        "target": "process.executable",
        "type": "executed"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4689
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} created account {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.name}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetDomainName",
        "type": "created account"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4720
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} enabled account {action.properties.TargetDomainName}\\{action.properties.TargetUserName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetDomainName",
        "type": "enabled account"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4722
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} changed their password on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "changed their password on"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4723
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} failed to change their password on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "failed to change their password on"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4723
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} disabled account {action.properties.TargetDomainName}\\{action.properties.TargetUserName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "disabled account"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4725
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} deleted account {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.name}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "deleted account"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4726
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} created group {action.properties.TargetDomainName}\\{action.properties.TargetUserName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "created group"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4727
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} effectuated changes about {action.properties.TargetDomainName}\\{action.properties.TargetUserName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "effectuated changes about"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4742
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} created security-disabled local group {action.properties.TargetDomainName}\\{action.properties.TargetUserName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "created security-disabled local group"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4744
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} effectuated changes about the security-disabled global group {action.properties.TargetDomainName}\\{action.properties.TargetUserName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "effectuated changes about"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4750
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} failed to authenticate from {source.ip} (Error Code: {action.properties.Status})",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "failed to log authenticate from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4768
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} successfully authenticated from {source.ip}",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "authenticated from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4768
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} was denied a service ticket for {action.properties.ServiceName} from {source.ip} (Error Code: {action.properties.Status})",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.ServiceName",
        "type": "was denied a ticket for"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4769
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} was granted a service ticket for {action.properties.ServiceName} from {source.ip}",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.ServiceName",
        "type": "was granted a ticket for"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4769
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ]
  },
  {
    "value": "{action.properties.TargetUserName} failed to authenticate from {source.ip}",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "failed to authenticate from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4771
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{action.properties.TargetUserName} failed to authenticate on {action.properties.Workstation} (Reason: {action.properties.Status})",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.Workstation",
        "type": "failed to log on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4776
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ]
  },
  {
    "value": "{action.properties.TargetUserName} successfully authenticated on {action.properties.Workstation}",
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.Workstation",
        "type": "logged on to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4776
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ]
  },
  {
    "value": "{user.name} reconnected on session {action.properties.SessionName} from {source.ip}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      },
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "reconnected from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "source.ip"
      }
    ]
  },
  {
    "value": "{user.name} reconnected on session {action.properties.SessionName} on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      },
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "reconnected from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "host.hostname"
      }
    ]
  },
  {
    "value": "{user.name} reconnected on session {action.properties.SessionName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} reconnected on session {action.properties.SessionName} from {source.ip}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      },
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "reconnected from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "source.ip"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} reconnected on session {action.properties.SessionName} on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      },
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "reconnected from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "host.hostname"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} reconnected on session {action.properties.SessionName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} reconnected on session {action.properties.SessionName} on {host.hostname} from {source.ip}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      },
      {
        "source": "user.name",
        "target": "source.ip",
        "type": "reconnected from"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "host.hostname"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} reconnected on session {action.properties.SessionName} on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.SessionName",
        "type": "reconnected on session"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4778
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} enumerated local groups of {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "enumerated local groups of"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4798
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} enumerated members of local group {action.properties.TargetUserName} on {log.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "enumerated members of"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4799
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "Authenticated user {user.name} was denied the access to Remote Desktop to {log.hostname} from IP {action.properties.ClientAddress}",
    "relationships": [
      {
        "source": "user.name",
        "target": "log.hostname",
        "type": "wad denied RDP access to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4825
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} assigned a new logon to special group {action.properties.TargetDomainName}\\{action.properties.TargetUserName}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "assigned a new logon to special group"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4964
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} assigned a new logon to special group {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "assigned a new logon to special group"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 4964
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "host.hostname"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} accessed network share {action.properties.ShareName} from IP {source.ip}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.ShareName",
        "type": "accessed network share"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 5140
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} failed to access network share {action.properties.ShareName} from IP {source.ip}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.ShareName",
        "type": "failed to access network share"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 5140
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} was granted access to {action.properties.ShareName}\\{action.properties.RelativeTargetName} from IP {source.ip}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.RelativeTargetName",
        "type": "accessed shared file"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 5145
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} was denied access to {action.properties.ShareName}\\{action.properties.RelativeTargetName} from IP {source.ip}",
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.RelativeTargetName",
        "type": "failed to access shared file"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 5145
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ]
  },
  {
    "value": "{host.hostname} allowed a connection from {action.properties.SourceAddress}:{action.properties.SourcePort}",
    "relationships": [
      {
        "source": "action.properties.SourceAddress",
        "target": "action.properties.DestAddress",
        "type": "connected to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 5156
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.SourceAddress"
      },
      {
        "field": "action.properties.SourcePort"
      }
    ]
  },
  {
    "value": "{host.hostname} allowed a connection to {action.properties.DestAddress}:{action.properties.DestPort}",
    "relationships": [
      {
        "source": "action.properties.SourceAddress",
        "target": "action.properties.DestAddress",
        "type": "connected to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 5156
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.DestAddress"
      },
      {
        "field": "action.properties.DestPort"
      }
    ]
  },
  {
    "value": "{host.hostname} allowed a connection from {action.properties.SourceAddress}:{action.properties.SourcePort} to {action.properties.DestAddress}:{action.properties.DestPort}",
    "relationships": [
      {
        "source": "action.properties.SourceAddress",
        "target": "action.properties.DestAddress",
        "type": "connected to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 5156
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.SourceAddress"
      },
      {
        "field": "action.properties.DestAddress"
      },
      {
        "field": "action.properties.SourcePort"
      },
      {
        "field": "action.properties.DestPort"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} executed PowerShell code on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4103
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "{user.id} executed PowerShell code on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4104
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} executed PowerShell code on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4104
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Started invocation of PowerShell ScriptBlock on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4105
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Completed invocation of PowerShell ScriptBlock on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4106
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Process {process.executable} created by {user.name}",
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.parent.name",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.command_line",
        "type": "started"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 1
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "user.name"
      }
    ]
  },
  {
    "value": "Process {process.executable} created by {user.domain}\\{user.name}",
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.parent.name",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.command_line",
        "type": "started"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 1
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "user.domain"
      },
      {
        "field": "user.name"
      }
    ]
  },
  {
    "value": "Process {process.executable} created by {user.name} on {host.name}",
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "host.name",
        "type": "executed on"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.parent.name",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "host.name",
        "type": "executed on"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.command_line",
        "type": "started"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 1
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "user.name"
      },
      {
        "field": "host.name"
      }
    ]
  },
  {
    "value": "Process {process.executable} created on {host.name}",
    "relationships": [
      {
        "source": "process.command_line",
        "target": "host.name",
        "type": "executed on"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.parent.name",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "host.name",
        "type": "executed on"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.command_line",
        "type": "started"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 1
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "host.name"
      }
    ]
  },
  {
    "value": "Process {process.executable} created by {user.domain}\\{user.name} on {host.name}",
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "host.name",
        "type": "executed on"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.parent.name",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "host.name",
        "type": "executed on"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.command_line",
        "type": "started"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 1
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "user.domain"
      },
      {
        "field": "user.name"
      },
      {
        "field": "host.name"
      }
    ]
  },
  {
    "value": "Process {process.executable} changed the creation time of the file {file.name} on {host.name}",
    "relationships": [
      {
        "source": "process.executable",
        "target": "file.name",
        "type": "changed creation time of"
      },
      {
        "source": "process.executable",
        "target": "host.name",
        "type": "executed on"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 2
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Network connection from {source.ip} to {destination.ip}:{destination.port} by {process.executable} on {host.name}",
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      }
    ],
    "conditions": [
      {
        "field": "action.id",
        "value": 3
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "{file.name} created by {process.executable} on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 11
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry value {action.properties.TargetObject} created by {process.executable} on {log.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 12
      },
      {
        "field": "action.properties.MessEventType",
        "value": "CreateValue"
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry key {registry.key} set by {process.executable} on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 13
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Sysmon configuration was updated on {host.name}",
    "conditions": [
      {
        "field": "action.id",
        "value": 16
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "{host.name} performed a DNS query for name {dns.question.name} (status: {sysmon.dns.status})",
    "conditions": [
      {
        "field": "action.id",
        "value": 22
      },
      {
        "field": "winlog.provider_name",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Auditing event on {winlog.computer_name}: {event.action}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{54849625-5478-4994-a5ba-3e3b0328c30d}"
      }
    ]
  },
  {
    "value": "Auditing event on {winlog.computer_name} for {winlog.SubjectUserSid}: {event.action}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{54849625-5478-4994-a5ba-3e3b0328c30d}"
      }
    ]
  },
  {
    "value": "Filtering connection on {winlog.computer_name} from {winlog.event_data.SourceAddress} to {winlog.event_data.DestAddress}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{54849625-5478-4994-a5ba-3e3b0328c30d}"
      },
      {
        "field": "event.action",
        "value": "Filtering Platform Connection"
      },
      {
        "field": "winlog.event_data.SourceAddress"
      },
      {
        "field": "winlog.event_data.DestAddress"
      }
    ]
  },
  {
    "value": "Filtering connection on {winlog.computer_name} from {winlog.event_data.SourceAddress}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{54849625-5478-4994-a5ba-3e3b0328c30d}"
      },
      {
        "field": "event.action",
        "value": "Filtering Platform Connection"
      },
      {
        "field": "winlog.event_data.SourceAddress"
      }
    ]
  },
  {
    "value": "Filtering connection on {winlog.computer_name} to {winlog.event_data.DestAddress}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{54849625-5478-4994-a5ba-3e3b0328c30d}"
      },
      {
        "field": "event.action",
        "value": "Filtering Platform Connection"
      },
      {
        "field": "winlog.event_data.DestAddress"
      }
    ]
  },
  {
    "value": "Filtering connection on {winlog.computer_name}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{54849625-5478-4994-a5ba-3e3b0328c30d}"
      },
      {
        "field": "event.action",
        "value": "Filtering Platform Connection"
      }
    ]
  },
  {
    "value": "Service Control Manager on {host.hostname}: {event.original}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{555908d1-a6d7-4695-8e1e-26931d2012f4}"
      }
    ]
  },
  {
    "value": "Sysmon {winlog.opcode} event on {winlog.computer_name}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}"
      }
    ]
  },
  {
    "value": "Sysmon : no event on {winlog.computer_name}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{00000000-0000-0000-0000-000000000000}"
      }
    ]
  },
  {
    "value": "Security event : {event.action} on {winlog.computer_name}",
    "conditions": [
      {
        "field": "winlog.provider_guid",
        "value": "{fc65ddd8-d6ef-4962-83d5-6e5cfe9ce148}"
      }
    ]
  },
  {
    "value": "Powershell event : {event.action} on {winlog.computer_name}",
    "conditions": [
      {
        "field": "event.module",
        "value": "powershell"
      }
    ]
  },
  {
    "value": "{event.action} event on {host.hostname}",
    "conditions": [
      {
        "field": "host.hostname"
      },
      {
        "field": "event.action"
      }
    ]
  },
  {
    "value": "{host.hostname}: {event.original}",
    "conditions": [
      {
        "field": "host.hostname"
      },
      {
        "field": "event.original"
      }
    ]
  }
]
