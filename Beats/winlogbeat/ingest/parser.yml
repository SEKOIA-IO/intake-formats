name: Winlogbeat
pipeline:
  - name: json
    external:
      name: json.parse-json
      properties:
        output_field: event
  - name: parse_kv_hashes
    filter: "{{json.event.winlog.event_data.Hashes != null}}"
    external:
      name: kv.parse-kv
      properties:
        raise_errors: false
        input_field: "{{json.event.winlog.event_data.Hashes}}"
        output_field: hash
        value_sep: "="
        item_sep: ","
  - name: fields
  - name: sysmon_fields
    filter: "{{json.event.event.get('module') == 'sysmon'}}"
  - name: security_fields
    filter: "{{json.event.winlog.get('channel') == 'Security'}}"
  - name: powershell_fields
    filter: "{{json.event.event.get('module') == 'powershell'}}"

stages:
  fields:
    actions:
      - set:
          "@timestamp": '{{json.event["@timestamp"]}}'
          action: "{{json.event.action}}"
          action.properties: "{{json.event.winlog.event_data}}"
          user.target.name: "{{json.event.winlog.event_data.TargetUserName}}"
          user.target.domain: "{{json.event.winlog.event_data.TargetDomainName}}"
          action.id: "{{json.event.event.code | string}}"
          agent: "{{json.event.agent}}"
          as: "{{json_event.event.as}}"
          beat: "{{json.event.beat}}"
          client: "{{json_event.event.client}}"
          cloud: "{{json_event.event.cloud}}"
          cloud.image.id: "{{json_event.event.cloud.image.id}}"
          code_signature: "{{json_event.event.code_signature}}"
          container: "{{json_event.event.container}}"
          data_stream: "{{json_event.event.data_stream}}"
          destination: "{{json.event.destination}}"
          dll: "{{json.event.dll}}"
          dns: "{{json.event.dns}}"
          docker: "{{json_event.event.docker}}"
          error: "{{json.event.error}}"
          event.action: "{{json.event.event.action}}"
          event.category: "{{json.event.event.category}}"
          event.code: "{{json.event.event.code | string}}"
          event.kind: "{{json.event.event.kind}}"
          event.module: "{{json.event.event.module}}"
          event.reason: "{{json.event.event.reason}}"
          event.provider: "{{json.event.event.provider}}"
          event.type: "{{json.event.event.type}}"
          event.original: "{{json.event.message}}"
          file.directory: "{{json.event.winlog.event_data.TargetFilename | dirname}}"
          file.name: "{{json.event.winlog.event_data.TargetFilename | basename}}"
          file.path: "{{json.event.winlog.event_data.TargetFilename}}"
          file.extension: "{{json.event.winlog.event_data.TargetFilename.split('.') | last}}"
          file.drive_letter: "{{json.event.winlog.event_data.TargetFilename.split(':') | first}}"
          action.outcome: "{{json.event.event.outcome}}"
          file: "{{json.event.file}}"
          jolokia: "{{json_event.event.jolokia}}"
          kubernetes: "{{json_event.event.kubernetes}}"
          host: "{{json.event.host}}"
          log: "{{json.event.log}}"
          network: "{{json.event.network}}"
          powershell: "{{json.event.powershell}}"
          process: "{{json.event.process}}"
          process.command_line: "{{json.event.winlog.event_data.CommandLine}}"
          process.executable: "{{json.event.winlog.event_data.Image}}"
          process.name: "{{json.event.winlog.event_data.Image | basename}}"
          process.parent.executable: "{{json.event.winlog.event_data.ParentImage}}"
          process.parent.name: "{{json.event.winlog.event_data.ParentImage| basename}}"
          process.working_directory: "{{json.event.winlog.event_data.CurrentDirectory}}"
          process.pe.original_file_name: "{{json.event.winlog.event_data.OriginalFileName}}"
          registry: "{{json.event.registry}}"
          registry.path: "{{json.event.winlog.event_data.TargetObject}}"
          registry.data.strings: "{{json.event.winlog.event_data.Details}}"
          registry.value: '{{json.event.winlog.event_data.TargetObject.split("\\") | last}}'
          registry.hive: '{{json.event.winlog.event_data.TargetObject.split("\\") | first}}'
          registry.key: '{{json.event.winlog.event_data.TargetObject.split("\\")[:-1] | join("\\")}}'
          source: "{{json.event.source}}"
          sysmon: "{{json.event.sysmon}}"
          timeseries: "{{json_event.event.timeseries}}"
          url: "{{json.event.url}}"
          user: "{{json.event.user}}"
          winlog: "{{json.event.winlog}}"
      - set:
          winlog.provider_guid: "{{json.event.winlog.provider_guid | lower}}"
        filter: '{{json.event.winlog.get("provider_guid") != None}}'
      - set:
          winlog.activity_id: "{{json.event.winlog.activity_id | lower}}"
        filter: '{{json.event.winlog.get("activity_id") != None}}'
      - set:
          process.hash.md5: "{{parse_kv_hashes.hash.MD5| lower }}"
          process.hash.sha1: "{{parse_kv_hashes.hash.SHA1| lower }}"
          process.hash.sha256: "{{parse_kv_hashes.hash.SHA256| lower }}"
          process.hash.sha384: "{{parse_kv_hashes.hash.SHA384| lower }}"
          process.hash.sha512: "{{parse_kv_hashes.hash.SHA512| lower }}"
          process.hash.ssdeep: "{{parse_kv_hashes.hash.SSDEEP| lower }}"
          process.hash.tlsh: "{{parse_kv_hashes.hash.TLSH| lower }}"
          process.pe.imphash: "{{parse_kv_hashes.hash.IMPHASH| lower }}"
        filter: "{{parse_kv_hashes.hash != None and json.event.event.get('code') in ['1', '23', '24', '25', '26']}}"
      - set:
          file.hash.md5: "{{parse_kv_hashes.hash.MD5| lower }}"
          file.hash.sha1: "{{parse_kv_hashes.hash.SHA1| lower }}"
          file.hash.sha256: "{{parse_kv_hashes.hash.SHA256| lower }}"
          file.hash.sha384: "{{parse_kv_hashes.hash.SHA384| lower }}"
          file.hash.sha512: "{{parse_kv_hashes.hash.SHA512| lower }}"
          file.hash.ssdeep: "{{parse_kv_hashes.hash.SSDEEP| lower }}"
          file.hash.tlsh: "{{parse_kv_hashes.hash.TLSH| lower }}"
          file.pe.imphash: "{{parse_kv_hashes.hash.IMPHASH| lower }}"
        filter: "{{parse_kv_hashes.hash != None and json.event.event.get('code') in ['6', '7', '15']}}"

  sysmon_fields:
    actions:
      - set:
          destination.domain: "{{json.event.winlog.event_data.DestinationHostname}}"
          destination.ip: "{{json.event.winlog.event_data.DestinationIp}}"
          destination.port: "{{json.event.winlog.event_data.DestinationPort | int}}"
          dns.question.name: "{{json.event.winlog.event_data.QueryName}}"
          dns.answers: >
            {% set mapping = {
              "1": "A",
              "2": "NS",
              "3": "MD",
              "4": "MF",
              "5": "CNAME",
              "6": "SOA",
              "7": "MB",
              "8": "MG",
              "9": "MR",
              "10": "NULL",
              "11": "WKS",
              "12": "PTR",
              "13": "HINFO",
              "14": "MINFO",
              "15": "MX",
              "16": "TXT",
              "17": "RP",
              "18": "AFSDB",
              "19": "X25",
              "20": "ISDN",
              "21": "RT",
              "22": "NSAP",
              "23": "NSAPPTR",
              "24": "SIG",
              "25": "KEY",
              "26": "PX",
              "27": "GPOS",
              "28": "AAAA",
              "29": "LOC",
              "30": "NXT",
              "31": "EID",
              "32": "NIMLOC",
              "33": "SRV",
              "34": "ATMA",
              "35": "NAPTR",
              "36": "KX",
              "37": "CERT",
              "38": "A6",
              "39": "DNAME",
              "40": "SINK",
              "41": "OPT",
              "43": "DS",
              "46": "RRSIG",
              "47": "NSEC",
              "48": "DNSKEY",
              "49": "DHCID",
              "100": "UINFO",
              "101": "UID",
              "102": "GID",
              "103": "UNSPEC",
              "248": "ADDRS",
              "249": "TKEY",
              "250": "TSIG",
              "251": "IXFR",
              "252": "AXFR",
              "253": "MAILB",
              "254": "MAILA",
              "255": "ANY",
              "65281": "WINS",
              "65282": "WINSR",
              }
            %}
            [ {% for answer in json.event.winlog.event_data.QueryResults.split(";")|select('ne', '')|list %}
              {% if "type:" in answer %}
              {% set list_answer = answer.split(" ")|select('ne', '')|list %}
              {"type": '{{mapping.get(list_answer[1])}}'
              {%- if list_answer|length > 2 -%}
              ,
              "data": '{{list_answer[2:]|join(" ")}}'
              {%- endif -%}
              },
              {% else %}
              {% set type = "A" %}
              {% set ip = answer[7:] %}
              {% if ip[-1] != ":" %}
              {% set type = "AAAA" %}
              {% endif %}
              {"type": '{{type}}',
              "data": '{{ip}}'},
              {% endif %}
              {% endfor %} ]
          dns.resolved_ip: >
            {% set ips = [] %}
            {%- for answer in json.event.winlog.event_data.QueryResults.split(";")|select('ne', '')|list -%}
            {%- if "type:" not in answer -%}
            {% set ips = ips.append(answer[7:]) %}
            {%- endif -%}
            {%- endfor -%}
            {{ips}}
          file.code_signature.subject_name: "{{json.event.winlog.event_data.Signature}}"
          file.code_signature.status: "{{json.event.winlog.event_data.SignatureStatus}}"
          file.name: "{{json.event.winlog.event_data.PipeName}}"
          file.path: "{{json.event.winlog.event_data.Device or json.event.winlog.event_data.ImageLoaded or json.event.winlog.event_data.TargetFilename}}"
          network.transport: "{{json.event.winlog.event_data.Protocol}}"
          network.direction: >
            {%- if json.event.winlog.event_data.get("Initiated") == "true" -%}
              "egress"
            {%- elif json.event.winlog.event_data.get("Initiated") == "false" -%}
              "ingress"
            {%- endif -%}
          network.type: >
            {%- if json.event.winlog.event_data.get("SourceIsIpv6") == "true" -%}
              "ipv6"
            {%- elif json.event.winlog.event_data.get("SourceIsIpv6") == "false" -%}
              "ipv4"
            {%- endif -%}
          process.entity_id: "{{json.event.winlog.event_data.ProcessGuid or json.event.winlog.event_data.SourceProcessGuid or json.event.winlog.event_data.SourceProcessGUID}}"
          process.executable: "{{json.event.winlog.event_data.SourceImage or json.event.winlog.event_data.Destination}}"
          process.parent.command_line: "{{json.event.winlog.event_data.ParentCommandLine}}"
          process.parent.entity_id: "{{json.event.winlog.event_data.ParentProcessGuid}}"
          process.parent.executable: "{{json.event.winlog.event_data.ParentImage}}"
          process.parent.pid: "{{json.event.winlog.event_data.ParentProcessId}}"
          process.pid: "{{json.event.winlog.event_data.ProcessId or json.event.winlog.event_data.SourceProcessId}}"
          process.thread.id: "{{json.event.winlog.event_data.SourceThreadId}}"
          process.working_directory: "{{json.event.winlog.event_data.CurrentDirectory}}"
          rule.name: "{{json.event.winlog.event_data.RuleName}}"
          source.domain: "{{json.event.winlog.event_data.SourceHostname}}"
          source.ip: "{{json.event.winlog.event_data.SourceIp }}"
          source.port: "{{json.event.winlog.event_data.SourcePort | int}}"
          sysmon.dns.status: "{{json.event.winlog.event_data.QueryStatus}}"
          sysmon.file.archived: "{{json.event.winlog.event_data.Archived}}"
          sysmon.file.is_executable: "{{json.event.winlog.event_data.IsExecutable}}"
          user.id: "{{json.event.winlog.user.identifier}}"
      - set:
          error.code: "{{json.event.winlog.event_data.ID}}"
        filter: "{{json.event.event.get('code') == '255'}}"
      - set:
          process.pe.company: "{{json.event.winlog.event_data.Company}}"
          process.pe.description: "{{json.event.winlog.event_data.Description}}"
          process.pe.file_version: "{{json.event.winlog.event_data.FileVersion}}"
          process.pe.original_file_name: "{{json.event.winlog.event_data.OriginalFileName}}"
          process.pe.product: "{{json.event.winlog.event_data.Product}}"
        filter: "{{json.event.event.get('code') != '7'}}"
      - set:
          file.pe.company: "{{json.event.winlog.event_data.Company}}"
          file.pe.description: "{{json.event.winlog.event_data.Description}}"
          file.pe.file_version: "{{json.event.winlog.event_data.FileVersion}}"
          file.pe.original_file_name: "{{json.event.winlog.event_data.OriginalFileName}}"
          file.pe.product: "{{json.event.winlog.event_data.Product}}"
        filter: "{{json.event.event.get('code') == '7'}}"
      - set:
          file.code_signature.valid: "{{json.event.winlog.event_data.get('SignatureStatus') == 'Valid' }}"
        filter: "{{json.event.winlog.event_data.get('Signed') == true }}"
      - set:
          network.protocol: "{{json.event.winlog.event_data.DestinationPortName or json.event.winlog.event_data.SourcePortName}}"
        filter: "{{json.event.event.get('code') != '22'}}"
      - set:
          network.protocol: "dns"
        filter: "{{json.event.event.get('code') == '22'}}"
      - set:
          user.domain: '{{json.event.winlog.event_data.User.split("\\") | first}}'
          user.name: '{{json.event.winlog.event_data.User.split("\\") | last}}'
        filter: '{{ json.event.winlog.event_data.User.split("\\") | length == 2 }}'

  security_fields:
    actions:
      - set:
          event.module: "security"
          service.name: "{{json.event.winlog.event_data.ServiceName}}"
          user.changes.name: "{{json.event.winlog.event_data.NewTargetUserName.split('$')|first}}"
          user.target.name: "{{json.event. winlog.event_data.OldTargetUserName.split('$')|first}}"
          winlog.logon.id: "{{json.event.winlog.event_data.SubjectLogonId}}"
      - set:
          winlog.logon.id: "{{json.event.winlog.event_data.TargetLogonId}}"
        filter: '{{json.event.event.get("code") in ["4634", "4647", "4964"]}}'
      - set:
          file.directory: "{{json.event.winlog.event_data.ShareLocalPath}}"
          file.name: "{{json.event.winlog.event_data.RelativeTargetName}}"
          file.path: "{{json.event.winlog.event_data.ShareLocalPath}}\\{{json.event.winlog.event_data.RelativeTargetName}}"
          file.target_path: "{{json.event.winlog.event_data.ShareName}}\\{{json.event.winlog.event_data.RelativeTargetName}}"
        filter: "{{json.event.event.get('code') in ['5140', '5145'] }}"
      - set:
          winlog.event_data.Category: >
            {% set mapping = {
              "0CCE9210-69AE-11D9-BED3-505054503030": ["Security State Change", "System"],
              "0CCE9211-69AE-11D9-BED3-505054503030": ["Security System Extension", "System"],
              "0CCE9212-69AE-11D9-BED3-505054503030": ["System Integrity", "System"],
              "0CCE9213-69AE-11D9-BED3-505054503030": ["IPsec Driver", "System"],
              "0CCE9214-69AE-11D9-BED3-505054503030": ["Other System Events", "System"],
              "0CCE9215-69AE-11D9-BED3-505054503030": ["Logon", "Logon/Logoff"],
              "0CCE9216-69AE-11D9-BED3-505054503030": ["Logoff", "Logon/Logoff"],
              "0CCE9217-69AE-11D9-BED3-505054503030": ["Account Lockout", "Logon/Logoff"],
              "0CCE9218-69AE-11D9-BED3-505054503030": ["IPsec Main Mode", "Logon/Logoff"],
              "0CCE9219-69AE-11D9-BED3-505054503030": ["IPsec Quick Mode", "Logon/Logoff"],
              "0CCE921A-69AE-11D9-BED3-505054503030": ["IPsec Extended Mode", "Logon/Logoff"],
              "0CCE921B-69AE-11D9-BED3-505054503030": ["Special Logon", "Logon/Logoff"],
              "0CCE921C-69AE-11D9-BED3-505054503030": ["Other Logon/Logoff Events", "Logon/Logoff"],
              "0CCE9243-69AE-11D9-BED3-505054503030": ["Network Policy Server", "Logon/Logoff"],
              "0CCE9247-69AE-11D9-BED3-505054503030": ["User / Device Claims", "Logon/Logoff"],
              "0CCE921D-69AE-11D9-BED3-505054503030": ["File System", "Object Access"],
              "0CCE921E-69AE-11D9-BED3-505054503030": ["Registry", "Object Access"],
              "0CCE921F-69AE-11D9-BED3-505054503030": ["Kernel Object", "Object Access"],
              "0CCE9220-69AE-11D9-BED3-505054503030": ["SAM", "Object Access"],
              "0CCE9221-69AE-11D9-BED3-505054503030": ["Certification Services", "Object Access"],
              "0CCE9222-69AE-11D9-BED3-505054503030": ["Application Generated", "Object Access"],
              "0CCE9223-69AE-11D9-BED3-505054503030": ["Handle Manipulation", "Object Access"],
              "0CCE9224-69AE-11D9-BED3-505054503030": ["File Share", "Object Access"],
              "0CCE9225-69AE-11D9-BED3-505054503030": ["Filtering Platform Packet Drop", "Object Access"],
              "0CCE9226-69AE-11D9-BED3-505054503030": ["Filtering Platform Connection ", "Object Access"],
              "0CCE9227-69AE-11D9-BED3-505054503030": ["Other Object Access Events", "Object Access"],
              "0CCE9244-69AE-11D9-BED3-505054503030": ["Detailed File Share", "Object Access"],
              "0CCE9245-69AE-11D9-BED3-505054503030": ["Removable Storage", "Object Access"],
              "0CCE9246-69AE-11D9-BED3-505054503030": ["Central Policy Staging", "Object Access"],
              "0CCE9228-69AE-11D9-BED3-505054503030": ["Sensitive Privilege Use", "Privilege Use"],
              "0CCE9229-69AE-11D9-BED3-505054503030": ["Non Sensitive Privilege Use", "Privilege Use"],
              "0CCE922A-69AE-11D9-BED3-505054503030": ["Other Privilege Use Events", "Privilege Use"],
              "0CCE922B-69AE-11D9-BED3-505054503030": ["Process Creation", "Detailed Tracking"],
              "0CCE922C-69AE-11D9-BED3-505054503030": ["Process Termination", "Detailed Tracking"],
              "0CCE922D-69AE-11D9-BED3-505054503030": ["DPAPI Activity", "Detailed Tracking"],
              "0CCE922E-69AE-11D9-BED3-505054503030": ["RPC Events", "Detailed Tracking"],
              "0CCE9248-69AE-11D9-BED3-505054503030": ["Plug and Play Events", "Detailed Tracking"],
              "0CCE922F-69AE-11D9-BED3-505054503030": ["Audit Policy Change", "Policy Change"],
              "0CCE9230-69AE-11D9-BED3-505054503030": ["Authentication Policy Change", "Policy Change"],
              "0CCE9231-69AE-11D9-BED3-505054503030": ["Authorization Policy Change", "Policy Change"],
              "0CCE9232-69AE-11D9-BED3-505054503030": ["MPSSVC Rule-Level Policy Change", "Policy Change"],
              "0CCE9233-69AE-11D9-BED3-505054503030": ["Filtering Platform Policy Change", "Policy Change"],
              "0CCE9234-69AE-11D9-BED3-505054503030": ["Other Policy Change Events", "Policy Change"],
              "0CCE9235-69AE-11D9-BED3-505054503030": ["User Account Management", "Account Management"],
              "0CCE9236-69AE-11D9-BED3-505054503030": ["Computer Account Management", "Account Management"],
              "0CCE9237-69AE-11D9-BED3-505054503030": ["Security Group Management", "Account Management"],
              "0CCE9238-69AE-11D9-BED3-505054503030": ["Distribution Group Management", "Account Management"],
              "0CCE9239-69AE-11D9-BED3-505054503030": ["Application Group Management", "Account Management"],
              "0CCE923A-69AE-11D9-BED3-505054503030": ["Other Account Management Events", "Account Management"],
              "0CCE923B-69AE-11D9-BED3-505054503030": ["Directory Service Access", "Account Management"],
              "0CCE923C-69AE-11D9-BED3-505054503030": ["Directory Service Changes", "Account Management"],
              "0CCE923D-69AE-11D9-BED3-505054503030": ["Directory Service Replication", "Account Management"],
              "0CCE923E-69AE-11D9-BED3-505054503030": ["Detailed Directory Service Replication", "Account Management"],
              "0CCE923F-69AE-11D9-BED3-505054503030": ["Credential Validation", "Account Logon"],
              "0CCE9240-69AE-11D9-BED3-505054503030": ["Kerberos Service Ticket Operations", "Account Logon"],
              "0CCE9241-69AE-11D9-BED3-505054503030": ["Other Account Logon Events", "Account Logon"],
              "0CCE9242-69AE-11D9-BED3-505054503030": ["Kerberos Authentication Service", "Account Logon"]
              }
            %}
            {% set subCatGuid = json.event.winlog.event_data.get("SubcategoryGuid").replace("{","").replace("}","").toUpperCase() %}
            {%- if subCatGuid in mapping -%}
            {{subCatGuid[1]}}
            {%- endif -%}
          winlog.event_data.SubCategory: >
            {% set mapping = {
              "0CCE9210-69AE-11D9-BED3-505054503030": ["Security State Change", "System"],
              "0CCE9211-69AE-11D9-BED3-505054503030": ["Security System Extension", "System"],
              "0CCE9212-69AE-11D9-BED3-505054503030": ["System Integrity", "System"],
              "0CCE9213-69AE-11D9-BED3-505054503030": ["IPsec Driver", "System"],
              "0CCE9214-69AE-11D9-BED3-505054503030": ["Other System Events", "System"],
              "0CCE9215-69AE-11D9-BED3-505054503030": ["Logon", "Logon/Logoff"],
              "0CCE9216-69AE-11D9-BED3-505054503030": ["Logoff", "Logon/Logoff"],
              "0CCE9217-69AE-11D9-BED3-505054503030": ["Account Lockout", "Logon/Logoff"],
              "0CCE9218-69AE-11D9-BED3-505054503030": ["IPsec Main Mode", "Logon/Logoff"],
              "0CCE9219-69AE-11D9-BED3-505054503030": ["IPsec Quick Mode", "Logon/Logoff"],
              "0CCE921A-69AE-11D9-BED3-505054503030": ["IPsec Extended Mode", "Logon/Logoff"],
              "0CCE921B-69AE-11D9-BED3-505054503030": ["Special Logon", "Logon/Logoff"],
              "0CCE921C-69AE-11D9-BED3-505054503030": ["Other Logon/Logoff Events", "Logon/Logoff"],
              "0CCE9243-69AE-11D9-BED3-505054503030": ["Network Policy Server", "Logon/Logoff"],
              "0CCE9247-69AE-11D9-BED3-505054503030": ["User / Device Claims", "Logon/Logoff"],
              "0CCE921D-69AE-11D9-BED3-505054503030": ["File System", "Object Access"],
              "0CCE921E-69AE-11D9-BED3-505054503030": ["Registry", "Object Access"],
              "0CCE921F-69AE-11D9-BED3-505054503030": ["Kernel Object", "Object Access"],
              "0CCE9220-69AE-11D9-BED3-505054503030": ["SAM", "Object Access"],
              "0CCE9221-69AE-11D9-BED3-505054503030": ["Certification Services", "Object Access"],
              "0CCE9222-69AE-11D9-BED3-505054503030": ["Application Generated", "Object Access"],
              "0CCE9223-69AE-11D9-BED3-505054503030": ["Handle Manipulation", "Object Access"],
              "0CCE9224-69AE-11D9-BED3-505054503030": ["File Share", "Object Access"],
              "0CCE9225-69AE-11D9-BED3-505054503030": ["Filtering Platform Packet Drop", "Object Access"],
              "0CCE9226-69AE-11D9-BED3-505054503030": ["Filtering Platform Connection ", "Object Access"],
              "0CCE9227-69AE-11D9-BED3-505054503030": ["Other Object Access Events", "Object Access"],
              "0CCE9244-69AE-11D9-BED3-505054503030": ["Detailed File Share", "Object Access"],
              "0CCE9245-69AE-11D9-BED3-505054503030": ["Removable Storage", "Object Access"],
              "0CCE9246-69AE-11D9-BED3-505054503030": ["Central Policy Staging", "Object Access"],
              "0CCE9228-69AE-11D9-BED3-505054503030": ["Sensitive Privilege Use", "Privilege Use"],
              "0CCE9229-69AE-11D9-BED3-505054503030": ["Non Sensitive Privilege Use", "Privilege Use"],
              "0CCE922A-69AE-11D9-BED3-505054503030": ["Other Privilege Use Events", "Privilege Use"],
              "0CCE922B-69AE-11D9-BED3-505054503030": ["Process Creation", "Detailed Tracking"],
              "0CCE922C-69AE-11D9-BED3-505054503030": ["Process Termination", "Detailed Tracking"],
              "0CCE922D-69AE-11D9-BED3-505054503030": ["DPAPI Activity", "Detailed Tracking"],
              "0CCE922E-69AE-11D9-BED3-505054503030": ["RPC Events", "Detailed Tracking"],
              "0CCE9248-69AE-11D9-BED3-505054503030": ["Plug and Play Events", "Detailed Tracking"],
              "0CCE922F-69AE-11D9-BED3-505054503030": ["Audit Policy Change", "Policy Change"],
              "0CCE9230-69AE-11D9-BED3-505054503030": ["Authentication Policy Change", "Policy Change"],
              "0CCE9231-69AE-11D9-BED3-505054503030": ["Authorization Policy Change", "Policy Change"],
              "0CCE9232-69AE-11D9-BED3-505054503030": ["MPSSVC Rule-Level Policy Change", "Policy Change"],
              "0CCE9233-69AE-11D9-BED3-505054503030": ["Filtering Platform Policy Change", "Policy Change"],
              "0CCE9234-69AE-11D9-BED3-505054503030": ["Other Policy Change Events", "Policy Change"],
              "0CCE9235-69AE-11D9-BED3-505054503030": ["User Account Management", "Account Management"],
              "0CCE9236-69AE-11D9-BED3-505054503030": ["Computer Account Management", "Account Management"],
              "0CCE9237-69AE-11D9-BED3-505054503030": ["Security Group Management", "Account Management"],
              "0CCE9238-69AE-11D9-BED3-505054503030": ["Distribution Group Management", "Account Management"],
              "0CCE9239-69AE-11D9-BED3-505054503030": ["Application Group Management", "Account Management"],
              "0CCE923A-69AE-11D9-BED3-505054503030": ["Other Account Management Events", "Account Management"],
              "0CCE923B-69AE-11D9-BED3-505054503030": ["Directory Service Access", "Account Management"],
              "0CCE923C-69AE-11D9-BED3-505054503030": ["Directory Service Changes", "Account Management"],
              "0CCE923D-69AE-11D9-BED3-505054503030": ["Directory Service Replication", "Account Management"],
              "0CCE923E-69AE-11D9-BED3-505054503030": ["Detailed Directory Service Replication", "Account Management"],
              "0CCE923F-69AE-11D9-BED3-505054503030": ["Credential Validation", "Account Logon"],
              "0CCE9240-69AE-11D9-BED3-505054503030": ["Kerberos Service Ticket Operations", "Account Logon"],
              "0CCE9241-69AE-11D9-BED3-505054503030": ["Other Account Logon Events", "Account Logon"],
              "0CCE9242-69AE-11D9-BED3-505054503030": ["Kerberos Authentication Service", "Account Logon"]
              }
            %}
            {% set subCatGuid = json.event.winlog.event_data.get("SubcategoryGuid").replace("{","").replace("}","").toUpperCase() %}
            {%- if subCatGuid in mapping -%}
            {{subCatGuid[0]}}
            {%- endif -%}
        filter: "{{json.event.winlog.event_data.get('SubcategoryGuid') != None}}"
      - set:
          winlog.event_data.AccessMaskDescription: >
            {%- set mapping = {
                "0x00000001": "Create Child",
                "0x00000002": "Delete Child",
                "0x00000004": "List Contents",
                "0x00000008": "SELF",
                "0x00000010": "Read Property",
                "0x00000020": "Write Property",
                "0x00000040": "Delete Treee",
                "0x00000080": "List Object",
                "0x00000100": "Control Access",
                "0x00010000": "DELETE",
                "0x00020000": "READ_CONTROL",
                "0x00040000": "WRITE_DAC",
                "0x00080000": "WRITE_OWNER",
                "0x00100000": "SYNCHRONIZE",
                "0x00F00000": "STANDARD_RIGHTS_REQUIRED",
                "0x001F0000": "STANDARD_RIGHTS_ALL",
                "0x0000FFFF": "SPECIFIC_RIGHTS_ALL",
                "0x01000000": "ADS_RIGHT_ACCESS_SYSTEM_SECURITY",
                "0x10000000": "ADS_RIGHT_GENERIC_ALL",
                "0x20000000": "ADS_RIGHT_GENERIC_EXECUTE",
                "0x40000000": "ADS_RIGHT_GENERIC_WRITE",
                "0x80000000": "ADS_RIGHT_GENERIC_READ"
                }
            -%}
            {% set new_val = json.event.winlog.event_data.AccessMask.split('x')[-1] %}
            {% set len_val = json.event.winlog.event_data.AccessMask.split('x')[-1] | length %}
            {% set accessmask_list = [] %}
            {% set str_zeros = "0x00000000" %}
            {%- for i in range(len_val) -%}
              {% set str_val = str_zeros[:9-i]+new_val[len_val-1-i]+str_zeros[10-i:] %}
              {%- if str_val in mapping -%}
                {% set accessmask_list = accessmask_list.append(mapping.get(str_val)) %}
              {%- endif -%}
            {%- endfor -%}
            {%- if accessmask_list != [] -%}
            {{accessmask_list}}
            {%- endif -%}
        filter: '{{json.event.winlog.event_data.get("AccessMask") != None}}'
      - set:
          winlog.event_data.NewUACList: >
            {% set mapping = {
              "0x00000001": "USER_ACCOUNT_DISABLED",
              "0x00000002": "USER_HOME_DIRECTORY_REQUIRED",
              "0x00000004": "USER_PASSWORD_NOT_REQUIRED",
              "0x00000008": "USER_TEMP_DUPLICATE_ACCOUNT",
              "0x00000010": "USER_NORMAL_ACCOUNT",
              "0x00000020": "USER_MNS_LOGON_ACCOUNT",
              "0x00000040": "USER_INTERDOMAIN_TRUST_ACCOUNT",
              "0x00000080": "USER_WORKSTATION_TRUST_ACCOUNT",
              "0x00000100": "USER_SERVER_TRUST_ACCOUNT",
              "0x00000200": "USER_DONT_EXPIRE_PASSWORD",
              "0x00000400": "USER_ACCOUNT_AUTO_LOCKED",
              "0x00000800": "USER_ENCRYPTED_TEXT_PASSWORD_ALLOWED",
              "0x00001000": "USER_SMARTCARD_REQUIRED",
              "0x00002000": "USER_TRUSTED_FOR_DELEGATION",
              "0x00004000": "USER_NOT_DELEGATED",
              "0x00008000": "USER_USE_DES_KEY_ONLY",
              "0x00010000": "USER_DONT_REQUIRE_PREAUTH",
              "0x00020000": "USER_PASSWORD_EXPIRED",
              "0x00040000": "USER_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION",
              "0x00080000": "USER_NO_AUTH_DATA_REQUIRED",
              "0x00100000": "USER_PARTIAL_SECRETS_ACCOUNT",
              "0x00200000": "USER_USE_AES_KEYS"
              }
            %}
            {% set new_val = json.event.winlog.event_data.NewUacValue.split('x')[-1] %}
            {% set len_val = json.event.winlog.event_data.NewUacValue.split('x')[-1] | length %}
            {% set uac_list = [] %}
            {% set str_zeros = "0x00000000" %}
            {%- for i in range(len_val) -%}
              {% set str_val = str_zeros[:9-i]+new_val[len_val-1-i]+str_zeros[10-i:] %}
              {%- if str_val in mapping -%}
                {% set uac_list = uac_list.append(mapping.get(str_val)) %}
              {%- endif -%}
            {%- endfor -%}
            {%- if uac_list != [] -%}
            {{uac_list}}
            {%- endif -%}
        filter: "{{ json.event.winlog.event_data.get('NewUacValue') != None }}"
      - set:
          winlog.event_data.TicketOptionsDescription: >
            {% set mapping = {
              "0x40000000": "Forwardable",
              "0x20000000": "Forwarded",
              "0x10000000": "Proxiable",
              "0x08000000": "Proxy",
              "0x04000000": "Allow-postdate",
              "0x02000000": "Postdated",
              "0x01000000": "Invalid",
              "0x00800000": "Renewable",
              "0x00400000": "Initial",
              "0x00200000": "Pre-authent",
              "0x00100000": "Opt-hardware-auth",
              "0x00080000": "Transited-policy-checked",
              "0x00040000": "Ok-as-delegate",
              "0x00020000": "Request-anonymous",
              "0x00010000": "Name-canonicalize",
              "0x00000020": "Disable-transited-check",
              "0x00000010": "Renewable-ok",
              "0x00000008": "Enc-tkt-in-skey",
              "0x00000002": "Renew",
              "0x00000001": "Validate"
              }
            %}
            {% set new_val = json.event.winlog.event_data.TicketOptions.split('x')[-1] %}
            {% set len_val = json.event.winlog.event_data.TicketOptions.split('x')[-1] | length %}
            {% set tod_list = [] %}
            {% set str_zeros = "0x00000000" %}
            {%- for i in range(len_val) -%}
              {% set str_val = str_zeros[:9-i]+new_val[len_val-1-i]+str_zeros[10-i:] %}
              {%- if str_val in mapping -%}
                {% set tod_list = tod_list.append(mapping.get(str_val)) %}
              {%- endif -%}
            {%- endfor -%}
            {%- if tod_list != [] -%}
            {{tod_list}}
            {%- endif -%}
        filter: "{{ json.event.winlog.event_data.get('TicketOptions') != None }}"
      - set:
          user.domain: "{{json.event.winlog.event_data.SubjectDomainName}}"
          user.id: "{{json.event.winlog.event_data.SubjectUserSid}}"
          user.name: "{{json.event.winlog.event_data.SubjectUserName.split('$')|first}}"
        filter: '{{ json.event.event.get("code") in ["4657", "4670", "4672", "4673", "4674", "4688", "4689", "4697","4698", "4699", "4700", "4701", "4702", "4706", "4707", "4713","4716", "4717", "4718", "4719", "4720", "4722", "4723", "4724","4725", "4726", "4727", "4728", "4729", "4730", "4731", "4732","4733", "4734", "4735", "4737", "4738", "4739", "4740", "4741","4742", "4743", "4744", "4745", "4746", "4747", "4748", "4749","4750", "4751", "4752", "4753", "4754", "4755", "4756", "4757","4758", "4759", "4760", "4761", "4762", "4763", "4764", "4767","4781", "4798", "4799", "4817", "4904", "4905", "4907", "4912","4648", "4797", "5140", "5145", "5379", "5380", "5381", "5382"]}}'
      - set:
          user.effective.domain: "{{json.event.winlog.event_data.TargetDomainName}}"
          user.effective.id: "{{ json.event.winlog.event_data.TargetUserSid }}"
          user.effective.name: '{{json.event.winlog.event_data.TargetUserName.split("@")|first}}'
        filter: '{{ json.event.event.get("code") in ["4648", "4688"]}}'
      - set:
          user.domain: "{{json.event.winlog.event_data.AccountDomain}}"
          user.name: "{{json.event.winlog.event_data.AccountName.split('$')|first}}"
          source.ip: >
            {%- if json.event.winlog.event_data.get("ClientAddress") != None -%}
              {%- set ip = json.event.winlog.event_data.get("ClientAddress") -%}
              {%- if json.event.winlog.event_data.get("ClientAddress") == "LOCAL" -%}
                {%- set ip = "127.0.0.1" -%}
              {%- endif -%}
              {{ip}}
            {%- endif -%}
          source.domain: "{{json.event.winlog.event_data.ClientName}}"
          winlog.logon.id: "{{json.event.winlog.event_data.LogonID}}"
        filter: '{{ json.event.event.get("code") in ["4778", "4779"]}}'
      - set:
          user.domain: "{{json.event.winlog.user_data.SubjectDomainName}}"
          user.id: "{{json.event.winlog.user_data.SubjectUserSid}}"
          user.name: "{{json.event.winlog.user_data.SubjectUserName.split('$')|first}}"
          winlog.logon.id: "{{json.event.winlog.user_data.SubjectLogonId}}"
        filter: '{{ json.event.event.get("code") == "1102"}}'
      - set:
          user.target.id: "{{json.event.winlog.event_data.TargetSid or json.event.winlog.event_data.TargetUserSid}}"
          user.target.name: '{{json.event.winlog.event_data.TargetUserName.split("@")|first}}'
          user.target.domain: "{{json.event.winlog.event_data.TargetDomainName}}"
        filter: '{{json.event.get("user") != None and json.event.event.get("code") in ["4624", "4625", "4634", "4647", "4648", "4768", "4769", "4770","4771", "4776", "4964"]}}'
      - set:
          user.id: "{{json.event.winlog.event_data.TargetSid or json.event.winlog.event_data.TargetUserSid}}"
          user.name: '{{json.event.winlog.event_data.TargetUserName.split("@")|first}}'
          user.domain: "{{json.event.winlog.event_data.TargetDomainName}}"
        filter: '{{json.event.get("user") == None and json.event.event.get("code") in ["4624", "4625", "4634", "4647", "4648", "4768", "4769", "4770","4771", "4776", "4964"]}}'
      - set:
          user.target: >
            {
            {%- if json.event.winlog.event_data.get("MemberName") != None -%}
            "name":{{json.event.winlog.event_data.memberName.split(",")[0].replace("CN=","").replace("cn=","")}},
            {%- endif -%}
            {%- if json.event.winlog.event_data.memberName.split(",")|length >= 4 -%}
            "domain":{{json.event.winlog.event_data.memberName.split(",")[3].replace("DC=","").replace("dc=","")}},
            {%- endif -%}
            }
          group.domain: '{{json.event.winlog.event_data.TargetDomainName.replace("DC=", "").replace("dc=", "")}}'
          group.id: "{{json.event.winlog.event_data.TargetUserSid or json.event.winlog.event_data.TargetSid}}"
          group.name: "{{json.event.winlog.event_data.TargetUserName}}"
        filter: '{{json.event.event.get("code") in ["4727", "4728", "4729", "4730", "4731", "4732", "4733", "4734", "4735","4737", "4744", "4745", "4746", "4747", "4748", "4749", "4750", "4751","4752", "4753", "4754", "4755", "4756", "4757", "4758", "4759", "4760","4761", "4762", "4763", "4764", "4799"]}}'
      - set:
          winlog.computerObject.domain: "{{json.event.winlog.event_data.TargetDomainName}}"
          winlog.computerObject.id: "{{json.event.winlog.event_data.TargetSid}}"
          winlog.computerObject.name: "{{json.event.winlog.event_data.TargetUserName}}"
        filter: '{{json.event.event.get("code") in ["4741", "4742", "4743"]}}'
      - set:
          process.executable: "{{json.event.winlog.event_data.ProcessName}}"
          process.name: '{{json.event.winlog.event_data.ProcessName.split("\\")|last}}'
          process.pid: >
            {%- if json.event.winlog.event_data.get("ProcessId") != None -%}
              {% set value = json.event.winlog.event_data.ProcessId %}
              {{value|int(value,16)}}
            {%- endif -%}
          source.domain: "{{json.event.winlog.event_data.WorkstationName}}"
          source.ip: >
            {%- if json.event.winlog.event_data.get('IpAddress') not in [None,'','-'] -%}
              {{json.event.winlog.event_data.IpAddress}}
            {%- endif -%}
          source.port: "{{json.event.winlog.event_data.IpPort|int}}"
        filter: '{{json.event.event.get("code") in ["1100", "1102", "1104", "1105", "1108", "4624", "4648", "4625","4670", "4673", "4674", "4689", "4697", "4719", "4720", "4722","4723", "4724", "4725", "4726", "4727", "4728", "4729", "4730","4731", "4732", "4733", "4734", "4735", "4737", "4738", "4740","4741", "4742", "4743", "4744", "4745", "4746", "4747", "4748","4749", "4750", "4751", "4752", "4753", "4754", "4755", "4756","4757", "4758", "4759", "4760", "4761", "4762", "4763", "4764","4767", "4768", "4769", "4770", "4771", "4798", "4799", "4817","4904", "4905", "4907", "4912", "5140", "5145"]}}'
      - set:
          process.args: >
            {%- set start = 0 -%}
            {%- set end = 0 -%}
            {%- set in_quote = false -%}
            {%- set al = [] -%}
            {%- for i in range (len(json.event.winlog.event_data.CommandLine)) -%}
              {%- set end = i -%}
              {%- if json.event.winlog.event_data.CommandLine[i] == '\"' -%}
                {%- if in_quote -%}
                  {%- set in_quote = false -%}
                {%- else -%}
                  {%- set in_quote = true -%}
                {%- endif -%}
              {%- endif -%}
              {%- if json.event.winlog.event_data.CommandLine[i] == " " and in_quote == false -%}
                {%- set al = al.append(json.event.winlog.event_data.CommandLine[start:end]) -%}
                {%- set start = i + 1 -%}
              {%- endif -%}
              {%- if (i == len(json.event.winlog.event_data.CommandLine) - 1) -%}
                {%- set al = al.append(json.event.winlog.event_data.CommandLine[start:end+1]) -%}
              {%- endif -%}
            {%- endfor -%}
            {{al}}
          process.command_line: "{{json.event.winlog.event_data.CommandLine}}"
          process.executable: "{{json.event.winlog.event_data.NewProcessName}}"
          process.name: '{{json.event.winlog.event_data.NewProcessName.split("\\")|last}}'
          process.parent.executable: "{{json.event.winlog.event_data.ParentProcessName}}"
          process.parent.name: '{{json.event.winlog.event_data.ParentProcessName.split("\\")|last}}'
          process.parent.pid: >
            {%- if json.event.winlog.event_data.get("ProcessId") != None -%}
              {% set value = json.event.winlog.event_data.ProcessId %}
              {{value|int(value,16)}}
            {%- endif -%}
          process.pid: >
            {%- if json.event.winlog.event_data.get("NewProcessId") != None -%}
              {% set value = json.event.winlog.event_data.NewProcessId %}
              {{value|int(value,16)}}
            {%- endif -%}
        filter: '{{json.event.event.get("code") == "4688"}}'
      - translate:
        filter: '{{json.event.winlog.event_data.get("TicketEncryptionType")|lower in ["0x1","0x3","0x11","0x12","0x17","0x18","0xffffffff"]}}'
        dictionary:
          "0x1": "DES-CBC-CRC"
          "0x3": "DES-CBC-MD5"
          "0x11": "AES128-CTS-HMAC-SHA1-96"
          "0x12": "AES256-CTS-HMAC-SHA1-96"
          "0x17": "RC4-HMAC"
          "0x18": "RC4-HMAC-EXP"
          "0xffffffff": "FAIL"
        mapping:
          json.event.winlog.event_data.TicketEncryptionType|lower: winlog.event_data.TicketEncryptionTypeDescription
      - translate:
        dictionary:
          "0x0": "KDC_ERR_NONE"
          "0x1": "KDC_ERR_NAME_EXP"
          "0x2": "KDC_ERR_SERVICE_EXP"
          "0x3": "KDC_ERR_BAD_PVNO"
          "0x4": "KDC_ERR_C_OLD_MAST_KVNO"
          "0x5": "KDC_ERR_S_OLD_MAST_KVNO"
          "0x6": "KDC_ERR_C_PRINCIPAL_UNKNOWN"
          "0x7": "KDC_ERR_S_PRINCIPAL_UNKNOWN"
          "0x8": "KDC_ERR_PRINCIPAL_NOT_UNIQUE"
          "0x9": "KDC_ERR_NULL_KEY"
          "0xA": "KDC_ERR_CANNOT_POSTDATE"
          "0xB": "KDC_ERR_NEVER_VALID"
          "0xC": "KDC_ERR_POLICY"
          "0xD": "KDC_ERR_BADOPTION"
          "0xE": "KDC_ERR_ETYPE_NOTSUPP"
          "0xF": "KDC_ERR_SUMTYPE_NOSUPP"
          "0x10": "KDC_ERR_PADATA_TYPE_NOSUPP"
          "0x11": "KDC_ERR_TRTYPE_NO_SUPP"
          "0x12": "KDC_ERR_CLIENT_REVOKED"
          "0x13": "KDC_ERR_SERVICE_REVOKED"
          "0x14": "KDC_ERR_TGT_REVOKED"
          "0x15": "KDC_ERR_CLIENT_NOTYET"
          "0x16": "KDC_ERR_SERVICE_NOTYET"
          "0x17": "KDC_ERR_KEY_EXPIRED"
          "0x18": "KDC_ERR_PREAUTH_FAILED"
          "0x19": "KDC_ERR_PREAUTH_REQUIRED"
          "0x1A": "KDC_ERR_SERVER_NOMATCH"
          "0x1B": "KDC_ERR_MUST_USE_USER2USER"
          "0x1F": "KRB_AP_ERR_BAD_INTEGRITY"
          "0x20": "KRB_AP_ERR_TKT_EXPIRED"
          "0x21": "KRB_AP_ERR_TKT_NYV"
          "0x22": "KRB_AP_ERR_REPEAT"
          "0x23": "KRB_AP_ERR_NOT_US"
          "0x24": "KRB_AP_ERR_BADMATCH"
          "0x25": "KRB_AP_ERR_SKEW"
          "0x26": "KRB_AP_ERR_BADADDR"
          "0x27": "KRB_AP_ERR_BADVERSION"
          "0x28": "KRB_AP_ERR_MSG_TYPE"
          "0x29": "KRB_AP_ERR_MODIFIED"
          "0x2A": "KRB_AP_ERR_BADORDER"
          "0x2C": "KRB_AP_ERR_BADKEYVER"
          "0x2D": "KRB_AP_ERR_NOKEY"
          "0x2E": "KRB_AP_ERR_MUT_FAIL"
          "0x2F": "KRB_AP_ERR_BADDIRECTION"
          "0x30": "KRB_AP_ERR_METHOD"
          "0x31": "KRB_AP_ERR_BADSEQ"
          "0x32": "KRB_AP_ERR_INAPP_CKSUM"
          "0x33": "KRB_AP_PATH_NOT_ACCEPTED"
          "0x34": "KRB_ERR_RESPONSE_TOO_BIG"
          "0x3C": "KRB_ERR_GENERIC"
          "0x3D": "KRB_ERR_FIELD_TOOLONG"
          "0x3E": "KDC_ERR_CLIENT_NOT_TRUSTED"
          "0x3F": "KDC_ERR_KDC_NOT_TRUSTED"
          "0x40": "KDC_ERR_INVALID_SIG"
          "0x41": "KDC_ERR_KEY_TOO_WEAK"
          "0x42": "KRB_AP_ERR_USER_TO_USER_REQUIRED"
          "0x43": "KRB_AP_ERR_NO_TGT"
          "0x44": "KDC_ERR_WRONG_REALM"
        mapping:
          json.event.winlog.event_data.Status: winlog.event_data.StatusDescription
        filter: '{{json.event.winlog.event_data.get("Status") != None and json.event.event.get("code") in ["4768", "4769", "4770", "4771"]}}'
      - translate:
        dictionary:
          "0xc000005e": "There are currently no logon servers available to service the logon request."
          "0xc0000064": "User logon with misspelled or bad user account"
          "0xc000006a": "User logon with misspelled or bad password"
          "0xc000006d": "This is either due to a bad username or authentication information"
          "0xc000006e": "Unknown user name or bad password."
          "0xc000006f": "User logon outside authorized hours"
          "0xc0000070": "User logon from unauthorized workstation"
          "0xc0000071": "User logon with expired password"
          "0xc0000072": "User logon to account disabled by administrator"
          "0xc00000dc": "Indicates the Sam Server was in the wrong state to perform the desired operation."
          "0xc0000133": "Clocks between DC and other computer too far out of sync"
          "0xc000015b": "The user has not been granted the requested logon type (aka logon right) at this machine"
          "0xc000018c": "The logon request failed because the trust relationship between the primary domain and the trusted domain failed."
          "0xc0000192": "An attempt was made to logon, but the Netlogon service was not started."
          "0xc0000193": "User logon with expired account"
          "0xc0000224": "User is required to change password at next logon"
          "0xc0000225": "Evidently a bug in Windows and not a risk"
          "0xc0000234": "User logon with account locked"
          "0xc00002ee": "Failure Reason: An Error occurred during Logon"
          "0xc0000413": "Logon Failure: The machine you are logging onto is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine."
          "0xc0000371": "The local account store does not contain secret material for the specified account"
          "0x0": "Status OK."
        mapping:
          json.event.winlog.event_data.Status: winlog.logon.failure.status
          json.event.winlog.event_data.SubStatus: winlog.logon.failure.sub_status
        filter: '{{json.event.event.get("code") in ["4625", "4776"]}}'
      - translate:
        filter: '{{json.event.winlog.event_data.get("TdoType") in ["1","2","3","4"]}}'
        dictionary:
          "1": "TRUST_TYPE_DOWNLEVEL"
          "2": "TRUST_TYPE_UPLEVEL"
          "3": "TRUST_TYPE_MIT"
          "4": "TRUST_TYPE_DCE"
        mapping:
          json.event.winlog.event_data.TdoType: winlog.trustType
      - translate:
        filter: '{{json.event.winlog.event_data.get("TdoDirection") in ["0","1","2","3"]}}'
        dictionary:
          "0": "TRUST_DIRECTION_DISABLED"
          "1": "TRUST_DIRECTION_INBOUND"
          "2": "TRUST_DIRECTION_OUTBOUND"
          "3": "TRUST_DIRECTION_BIDIRECTIONAL"
        mapping:
          json.event.winlog.event_data.TdoDirection: winlog.trustDirection
      - translate:
        filter: '{{json.event.winlog.event_data.get("TdoAttributes") in ["0","1","2","4","8","16","32","64","128","512","1024"]}}'
        dictionary:
          "0": "UNDEFINED"
          "1": "TRUST_ATTRIBUTE_NON_TRANSITIVE"
          "2": "TRUST_ATTRIBUTE_UPLEVEL_ONLY"
          "4": "TRUST_ATTRIBUTE_QUARANTINED_DOMAIN"
          "8": "TRUST_ATTRIBUTE_FOREST_TRANSITIVE"
          "16": "TRUST_ATTRIBUTE_CROSS_ORGANIZATION"
          "32": "TRUST_ATTRIBUTE_WITHIN_FOREST"
          "64": "TRUST_ATTRIBUTE_TREAT_AS_EXTERNAL"
          "128": "TRUST_ATTRIBUTE_USES_RC4_ENCRYPTION"
          "512": "TRUST_ATTRIBUTE_CROSS_ORGANIZATION_NO_TGT_DELEGATION"
          "1024": "TRUST_ATTRIBUTE_PIM_TRUST"
        mapping:
          json.event.winlog.event_data.TdoAttributes: winlog.trustAttribute
      - translate:
        filter: '{{json.event.winlog.event_data.get("ServiceName") in ["0x1","0x2","0x8","0x10","0x20","0x110","0x120"]}}'
        dictionary:
          "0x1": "Kernel Driver"
          "0x2": "File System Driver"
          "0x8": "Recognizer Driver"
          "0x10": "Win32 Own Process"
          "0x20": "Win32 Share Process"
          "0x110": "Interactive Own Process"
          "0x120": "Interactive Share Process"
        mapping:
          json.event.winlog.event_data.ServiceName: service.type
      - translate:
        filter: '{{json.event.winlog.event_data.get("LogonType") in ["2","3","4","5","7","8","9","10","11"]}}'
        dictionary:
          "2": "Interactive"
          "3": "Network"
          "4": "Batch"
          "5": "Service"
          "7": "Unlock"
          "8": "NetworkCleartext"
          "9": "NewCredentials"
          "10": "RemoteInteractive"
          "11": "CachedInteractive"
        mapping:
          json.event.winlog.event_data.LogonType: winlog.logon.type
      - translate:
        dictionary:
          "%%279": "Undefined Access (no effect) Bit 7"
          "%%1536": "Unused message ID"
          "%%1537": "DELETE"
          "%%1538": "READ_CONTROL"
          "%%1539": "WRITE_DAC"
          "%%1540": "WRITE_OWNER"
          "%%1541": "SYNCHRONIZE"
          "%%1542": "ACCESS_SYS_SEC"
          "%%1543": "MAX_ALLOWED"
          "%%1552": "Unknown specific access (bit 0)"
          "%%1553": "Unknown specific access (bit 1)"
          "%%1554": "Unknown specific access (bit 2)"
          "%%1555": "Unknown specific access (bit 3)"
          "%%1556": "Unknown specific access (bit 4)"
          "%%1557": "Unknown specific access (bit 5)"
          "%%1558": "Unknown specific access (bit 6)"
          "%%1559": "Unknown specific access (bit 7)"
          "%%1560": "Unknown specific access (bit 8)"
          "%%1561": "Unknown specific access (bit 9)"
          "%%1562": "Unknown specific access (bit 10)"
          "%%1563": "Unknown specific access (bit 11)"
          "%%1564": "Unknown specific access (bit 12)"
          "%%1565": "Unknown specific access (bit 13)"
          "%%1566": "Unknown specific access (bit 14)"
          "%%1567": "Unknown specific access (bit 15)"
          "%%1601": "Not used"
          "%%1603": "Assign Primary Token Privilege"
          "%%1604": "Lock Memory Privilege"
          "%%1605": "Increase Memory Quota Privilege"
          "%%1606": "Unsolicited Input Privilege"
          "%%1607": "Trusted Computer Base Privilege"
          "%%1608": "Security Privilege"
          "%%1609": "Take Ownership Privilege"
          "%%1610": "Load/Unload Driver Privilege"
          "%%1611": "Profile System Privilege"
          "%%1612": "Set System Time Privilege"
          "%%1613": "Profile Single Process Privilege"
          "%%1614": "Increment Base Priority Privilege"
          "%%1615": "Create Pagefile Privilege"
          "%%1616": "Create Permanent Object Privilege"
          "%%1617": "Backup Privilege"
          "%%1618": "Restore From Backup Privilege"
          "%%1619": "Shutdown System Privilege"
          "%%1620": "Debug Privilege"
          "%%1621": "View or Change Audit Log Privilege"
          "%%1622": "Change Hardware Environment Privilege"
          "%%1623": "Change Notify (and Traverse) Privilege"
          "%%1624": "Remotely Shut System Down Privilege"
          "%%1792": "<value changed"
          "%%1793": "<value not set>"
          "%%1794": "<never>"
          "%%1795": "Enabled"
          "%%1796": "Disabled"
          "%%1797": "All"
          "%%1798": "None"
          "%%1799": "Audit Policy query/set API Operation"
          "%%1800": "<Value change auditing for this registry type is not supported>"
          "%%1801": "Granted by"
          "%%1802": "Denied by"
          "%%1803": "Denied by Integrity Policy check"
          "%%1804": "Granted by Ownership"
          "%%1805": "Not granted"
          "%%1806": "Granted by NULL DACL"
          "%%1807": "Denied by Empty DACL"
          "%%1808": "Granted by NULL Security Descriptor"
          "%%1809": "Unknown or unchecked"
          "%%1810": "Not granted due to missing"
          "%%1811": "Granted by ACE on parent folder"
          "%%1812": "Denied by ACE on parent folder"
          "%%1813": "Granted by Central Access Rule"
          "%%1814": "NOT Granted by Central Access Rule"
          "%%1815": "Granted by parent folder's Central Access Rule"
          "%%1816": "NOT Granted by parent folder's Central Access Rule"
          "%%1817": "Unknown Type"
          "%%1818": "String"
          "%%1819": "Unsigned 64-bit Integer"
          "%%1820": "64-bit Integer"
          "%%1821": "FQBN"
          "%%1822": "Blob"
          "%%1823": "Sid"
          "%%1824": "Boolean"
          "%%1825": "TRUE"
          "%%1826": "FALSE"
          "%%1827": "Invalid"
          "%%1828": "an ACE too long to display"
          "%%1829": "a Security Descriptor too long to display"
          "%%1830": "Not granted to AppContainers"
          "%%1831": "..."
          "%%1832": "Identification"
          "%%1833": "Impersonation"
          "%%1840": "Delegation"
          "%%1841": "Denied by Process Trust Label ACE"
          "%%1842": "Yes"
          "%%1843": "No"
          "%%1844": "System"
          "%%1845": "Not Available"
          "%%1846": "Default"
          "%%1847": "DisallowMmConfig"
          "%%1848": "Off"
          "%%1849": "Auto"
          "%%1872": "REG_NONE"
          "%%1873": "REG_SZ"
          "%%1874": "REG_EXPAND_SZ"
          "%%1875": "REG_BINARY"
          "%%1876": "REG_DWORD"
          "%%1877": "REG_DWORD_BIG_ENDIAN"
          "%%1878": "REG_LINK"
          "%%1879": "REG_MULTI_SZ (New lines are replaced with *. A * is replaced with **)"
          "%%1880": "REG_RESOURCE_LIST"
          "%%1881": "REG_FULL_RESOURCE_DESCRIPTOR"
          "%%1882": "REG_RESOURCE_REQUIREMENTS_LIST"
          "%%1883": "REG_QWORD"
          "%%1904": "New registry value created"
          "%%1905": "Existing registry value modified"
          "%%1906": "Registry value deleted"
          "%%1920": "Sunday"
          "%%1921": "Monday"
          "%%1922": "Tuesday"
          "%%1923": "Wednesday"
          "%%1924": "Thursday"
          "%%1925": "Friday"
          "%%1926": "Saturday"
          "%%1936": "TokenElevationTypeDefault (1)"
          "%%1937": "TokenElevationTypeFull (2)"
          "%%1938": "TokenElevationTypeLimited (3)"
          "%%2048": "Account Enabled"
          "%%2049": "Home Directory Required' - Disabled"
          "%%2050": "Password Not Required' - Disabled"
          "%%2051": "Temp Duplicate Account' - Disabled"
          "%%2052": "Normal Account' - Disabled"
          "%%2053": "MNS Logon Account' - Disabled"
          "%%2054": "Interdomain Trust Account' - Disabled"
          "%%2055": "Workstation Trust Account' - Disabled"
          "%%2056": "Server Trust Account' - Disabled"
          "%%2057": "Don't Expire Password' - Disabled"
          "%%2058": "Account Unlocked"
          "%%2059": "Encrypted Text Password Allowed' - Disabled"
          "%%2060": "Smartcard Required' - Disabled"
          "%%2061": "Trusted For Delegation' - Disabled"
          "%%2062": "Not Delegated' - Disabled"
          "%%2063": "Use DES Key Only' - Disabled"
          "%%2064": "Don't Require Preauth' - Disabled"
          "%%2065": "Password Expired' - Disabled"
          "%%2066": "Trusted To Authenticate For Delegation' - Disabled"
          "%%2067": "Exclude Authorization Information' - Disabled"
          "%%2068": "Undefined UserAccountControl Bit 20' - Disabled"
          "%%2069": "Protect Kerberos Service Tickets with AES Keys' - Disabled"
          "%%2070": "Undefined UserAccountControl Bit 22' - Disabled"
          "%%2071": "Undefined UserAccountControl Bit 23' - Disabled"
          "%%2072": "Undefined UserAccountControl Bit 24' - Disabled"
          "%%2073": "Undefined UserAccountControl Bit 25' - Disabled"
          "%%2074": "Undefined UserAccountControl Bit 26' - Disabled"
          "%%2075": "Undefined UserAccountControl Bit 27' - Disabled"
          "%%2076": "Undefined UserAccountControl Bit 28' - Disabled"
          "%%2077": "Undefined UserAccountControl Bit 29' - Disabled"
          "%%2078": "Undefined UserAccountControl Bit 30' - Disabled"
          "%%2079": "Undefined UserAccountControl Bit 31' - Disabled"
          "%%2080": "Account Disabled"
          "%%2081": "Home Directory Required' - Enabled"
          "%%2082": "Password Not Required' - Enabled"
          "%%2083": "Temp Duplicate Account' - Enabled"
          "%%2084": "Normal Account' - Enabled"
          "%%2085": "MNS Logon Account' - Enabled"
          "%%2086": "Interdomain Trust Account' - Enabled"
          "%%2087": "Workstation Trust Account' - Enabled"
          "%%2088": "Server Trust Account' - Enabled"
          "%%2089": "Don't Expire Password' - Enabled"
          "%%2090": "Account Locked"
          "%%2091": "Encrypted Text Password Allowed' - Enabled"
          "%%2092": "Smartcard Required' - Enabled"
          "%%2093": "Trusted For Delegation' - Enabled"
          "%%2094": "Not Delegated' - Enabled"
          "%%2095": "Use DES Key Only' - Enabled"
          "%%2096": "Don't Require Preauth' - Enabled"
          "%%2097": "Password Expired' - Enabled"
          "%%2098": "Trusted To Authenticate For Delegation' - Enabled"
          "%%2099": "Exclude Authorization Information' - Enabled"
          "%%2100": "Undefined UserAccountControl Bit 20' - Enabled"
          "%%2101": "Protect Kerberos Service Tickets with AES Keys' - Enabled"
          "%%2102": "Undefined UserAccountControl Bit 22' - Enabled"
          "%%2103": "Undefined UserAccountControl Bit 23' - Enabled"
          "%%2104": "Undefined UserAccountControl Bit 24' - Enabled"
          "%%2105": "Undefined UserAccountControl Bit 25' - Enabled"
          "%%2106": "Undefined UserAccountControl Bit 26' - Enabled"
          "%%2107": "Undefined UserAccountControl Bit 27' - Enabled"
          "%%2108": "Undefined UserAccountControl Bit 28' - Enabled"
          "%%2109": "Undefined UserAccountControl Bit 29' - Enabled"
          "%%2110": "Undefined UserAccountControl Bit 30' - Enabled"
          "%%2111": "Undefined UserAccountControl Bit 31' - Enabled"
          "%%2304": "An Error occured during Logon."
          "%%2305": "The specified user account has expired."
          "%%2306": "The NetLogon component is not active."
          "%%2307": "Account locked out."
          "%%2308": "The user has not been granted the requested logon type at this machine."
          "%%2309": "The specified account's password has expired."
          "%%2310": "Account currently disabled."
          "%%2311": "Account logon time restriction violation."
          "%%2312": "User not allowed to logon at this computer."
          "%%2313": "Unknown user name or bad password."
          "%%2314": "Domain sid inconsistent."
          "%%2315": "Smartcard logon is required and was not used."
          "%%2432": "Not Available."
          "%%2436": "Random number generator failure."
          "%%2437": "Random number generation failed FIPS-140 pre-hash check."
          "%%2438": "Failed to zero secret data."
          "%%2439": "Key failed pair wise consistency check."
          "%%2448": "Failed to unprotect persistent cryptographic key."
          "%%2449": "Key export checks failed."
          "%%2450": "Validation of public key failed."
          "%%2451": "Signature verification failed."
          "%%2456": "Open key file."
          "%%2457": "Delete key file."
          "%%2458": "Read persisted key from file."
          "%%2459": "Write persisted key to file."
          "%%2464": "Export of persistent cryptographic key."
          "%%2465": "Import of persistent cryptographic key."
          "%%2480": "Open Key."
          "%%2481": "Create Key."
          "%%2482": "Delete Key."
          "%%2483": "Encrypt."
          "%%2484": "Decrypt."
          "%%2485": "Sign hash."
          "%%2486": "Secret agreement."
          "%%2487": "Domain settings"
          "%%2488": "Local settings"
          "%%2489": "Add provider."
          "%%2490": "Remove provider."
          "%%2491": "Add context."
          "%%2492": "Remove context."
          "%%2493": "Add function."
          "%%2494": "Remove function."
          "%%2495": "Add function provider."
          "%%2496": "Remove function provider."
          "%%2497": "Add function property."
          "%%2498": "Remove function property."
          "%%2499": "Machine key."
          "%%2500": "User key."
          "%%2501": "Key Derivation."
          "%%4352": "Device Access Bit 0"
          "%%4353": "Device Access Bit 1"
          "%%4354": "Device Access Bit 2"
          "%%4355": "Device Access Bit 3"
          "%%4356": "Device Access Bit 4"
          "%%4357": "Device Access Bit 5"
          "%%4358": "Device Access Bit 6"
          "%%4359": "Device Access Bit 7"
          "%%4360": "Device Access Bit 8"
          "%%4361": "Undefined Access (no effect) Bit 9"
          "%%4362": "Undefined Access (no effect) Bit 10"
          "%%4363": "Undefined Access (no effect) Bit 11"
          "%%4364": "Undefined Access (no effect) Bit 12"
          "%%4365": "Undefined Access (no effect) Bit 13"
          "%%4366": "Undefined Access (no effect) Bit 14"
          "%%4367": "Undefined Access (no effect) Bit 15"
          "%%4368": "Query directory"
          "%%4369": "Traverse"
          "%%4370": "Create object in directory"
          "%%4371": "Create sub-directory"
          "%%4372": "Undefined Access (no effect) Bit 4"
          "%%4373": "Undefined Access (no effect) Bit 5"
          "%%4374": "Undefined Access (no effect) Bit 6"
          "%%4375": "Undefined Access (no effect) Bit 7"
          "%%4376": "Undefined Access (no effect) Bit 8"
          "%%4377": "Undefined Access (no effect) Bit 9"
          "%%4378": "Undefined Access (no effect) Bit 10"
          "%%4379": "Undefined Access (no effect) Bit 11"
          "%%4380": "Undefined Access (no effect) Bit 12"
          "%%4381": "Undefined Access (no effect) Bit 13"
          "%%4382": "Undefined Access (no effect) Bit 14"
          "%%4383": "Undefined Access (no effect) Bit 15"
          "%%4384": "Query event state"
          "%%4385": "Modify event state"
          "%%4386": "Undefined Access (no effect) Bit 2"
          "%%4387": "Undefined Access (no effect) Bit 3"
          "%%4388": "Undefined Access (no effect) Bit 4"
          "%%4389": "Undefined Access (no effect) Bit 5"
          "%%4390": "Undefined Access (no effect) Bit 6"
          "%%4391": "Undefined Access (no effect) Bit 7"
          "%%4392": "Undefined Access (no effect) Bit 8"
          "%%4393": "Undefined Access (no effect) Bit 9"
          "%%4394": "Undefined Access (no effect) Bit 10"
          "%%4395": "Undefined Access (no effect) Bit 11"
          "%%4396": "Undefined Access (no effect) Bit 12"
          "%%4397": "Undefined Access (no effect) Bit 13"
          "%%4398": "Undefined Access (no effect) Bit 14"
          "%%4399": "Undefined Access (no effect) Bit 15"
          "%%4416": "ReadData (or ListDirectory)"
          "%%4417": "WriteData (or AddFile)"
          "%%4418": "AppendData (or AddSubdirectory or CreatePipeInstance)"
          "%%4419": "ReadEA"
          "%%4420": "WriteEA"
          "%%4421": "Execute/Traverse"
          "%%4422": "DeleteChild"
          "%%4423": "ReadAttributes"
          "%%4424": "WriteAttributes"
          "%%4425": "Undefined Access (no effect) Bit 9"
          "%%4426": "Undefined Access (no effect) Bit 10"
          "%%4427": "Undefined Access (no effect) Bit 11"
          "%%4428": "Undefined Access (no effect) Bit 12"
          "%%4429": "Undefined Access (no effect) Bit 13"
          "%%4430": "Undefined Access (no effect) Bit 14"
          "%%4431": "Undefined Access (no effect) Bit 15"
          "%%4432": "Query key value"
          "%%4433": "Set key value"
          "%%4434": "Create sub-key"
          "%%4435": "Enumerate sub-keys"
          "%%4436": "Notify about changes to keys"
          "%%4437": "Create Link"
          "%%4438": "Undefined Access (no effect) Bit 6"
          "%%4439": "Undefined Access (no effect) Bit 7"
          "%%4440": "Enable 64(or 32) bit application to open 64 bit key"
          "%%4441": "Enable 64(or 32) bit application to open 32 bit key"
          "%%4442": "Undefined Access (no effect) Bit 10"
          "%%4443": "Undefined Access (no effect) Bit 11"
          "%%4444": "Undefined Access (no effect) Bit 12"
          "%%4445": "Undefined Access (no effect) Bit 13"
          "%%4446": "Undefined Access (no effect) Bit 14"
          "%%4447": "Undefined Access (no effect) Bit 15"
          "%%4448": "Query mutant state"
          "%%4449": "Undefined Access (no effect) Bit 1"
          "%%4450": "Undefined Access (no effect) Bit 2"
          "%%4451": "Undefined Access (no effect) Bit 3"
          "%%4452": "Undefined Access (no effect) Bit 4"
          "%%4453": "Undefined Access (no effect) Bit 5"
          "%%4454": "Undefined Access (no effect) Bit 6"
          "%%4455": "Undefined Access (no effect) Bit 7"
          "%%4456": "Undefined Access (no effect) Bit 8"
          "%%4457": "Undefined Access (no effect) Bit 9"
          "%%4458": "Undefined Access (no effect) Bit 10"
          "%%4459": "Undefined Access (no effect) Bit 11"
          "%%4460": "Undefined Access (no effect) Bit 12"
          "%%4461": "Undefined Access (no effect) Bit 13"
          "%%4462": "Undefined Access (no effect) Bit 14"
          "%%4463": "Undefined Access (no effect) Bit 15"
          "%%4464": "Communicate using port"
          "%%4465": "Undefined Access (no effect) Bit 1"
          "%%4466": "Undefined Access (no effect) Bit 2"
          "%%4467": "Undefined Access (no effect) Bit 3"
          "%%4468": "Undefined Access (no effect) Bit 4"
          "%%4469": "Undefined Access (no effect) Bit 5"
          "%%4470": "Undefined Access (no effect) Bit 6"
          "%%4471": "Undefined Access (no effect) Bit 7"
          "%%4472": "Undefined Access (no effect) Bit 8"
          "%%4473": "Undefined Access (no effect) Bit 9"
          "%%4474": "Undefined Access (no effect) Bit 10"
          "%%4475": "Undefined Access (no effect) Bit 11"
          "%%4476": "Undefined Access (no effect) Bit 12"
          "%%4477": "Undefined Access (no effect) Bit 13"
          "%%4478": "Undefined Access (no effect) Bit 14"
          "%%4479": "Undefined Access (no effect) Bit 15"
          "%%4480": "Force process termination"
          "%%4481": "Create new thread in process"
          "%%4482": "Set process session ID"
          "%%4483": "Perform virtual memory operation"
          "%%4484": "Read from process memory"
          "%%4485": "Write to process memory"
          "%%4486": "Duplicate handle into or out of process"
          "%%4487": "Create a subprocess of process"
          "%%4488": "Set process quotas"
          "%%4489": "Set process information"
          "%%4490": "Query process information"
          "%%4491": "Set process termination port"
          "%%4492": "Undefined Access (no effect) Bit 12"
          "%%4493": "Undefined Access (no effect) Bit 13"
          "%%4494": "Undefined Access (no effect) Bit 14"
          "%%4495": "Undefined Access (no effect) Bit 15"
          "%%4496": "Control profile"
          "%%4497": "Undefined Access (no effect) Bit 1"
          "%%4498": "Undefined Access (no effect) Bit 2"
          "%%4499": "Undefined Access (no effect) Bit 3"
          "%%4500": "Undefined Access (no effect) Bit 4"
          "%%4501": "Undefined Access (no effect) Bit 5"
          "%%4502": "Undefined Access (no effect) Bit 6"
          "%%4503": "Undefined Access (no effect) Bit 7"
          "%%4504": "Undefined Access (no effect) Bit 8"
          "%%4505": "Undefined Access (no effect) Bit 9"
          "%%4506": "Undefined Access (no effect) Bit 10"
          "%%4507": "Undefined Access (no effect) Bit 11"
          "%%4508": "Undefined Access (no effect) Bit 12"
          "%%4509": "Undefined Access (no effect) Bit 13"
          "%%4510": "Undefined Access (no effect) Bit 14"
          "%%4511": "Undefined Access (no effect) Bit 15"
          "%%4512": "Query section state"
          "%%4513": "Map section for write"
          "%%4514": "Map section for read"
          "%%4515": "Map section for execute"
          "%%4516": "Extend size"
          "%%4517": "Undefined Access (no effect) Bit 5"
          "%%4518": "Undefined Access (no effect) Bit 6"
          "%%4519": "Undefined Access (no effect) Bit 7"
          "%%4520": "Undefined Access (no effect) Bit 8"
          "%%4521": "Undefined Access (no effect) Bit 9"
          "%%4522": "Undefined Access (no effect) Bit 10"
          "%%4523": "Undefined Access (no effect) Bit 11"
          "%%4524": "Undefined Access (no effect) Bit 12"
          "%%4525": "Undefined Access (no effect) Bit 13"
          "%%4526": "Undefined Access (no effect) Bit 14"
          "%%4527": "Undefined Access (no effect) Bit 15"
          "%%4528": "Query semaphore state"
          "%%4529": "Modify semaphore state"
          "%%4530": "Undefined Access (no effect) Bit 2"
          "%%4531": "Undefined Access (no effect) Bit 3"
          "%%4532": "Undefined Access (no effect) Bit 4"
          "%%4533": "Undefined Access (no effect) Bit 5"
          "%%4534": "Undefined Access (no effect) Bit 6"
          "%%4535": "Undefined Access (no effect) Bit 7"
          "%%4536": "Undefined Access (no effect) Bit 8"
          "%%4537": "Undefined Access (no effect) Bit 9"
          "%%4538": "Undefined Access (no effect) Bit 10"
          "%%4539": "Undefined Access (no effect) Bit 11"
          "%%4540": "Undefined Access (no effect) Bit 12"
          "%%4541": "Undefined Access (no effect) Bit 13"
          "%%4542": "Undefined Access (no effect) Bit 14"
          "%%4543": "Undefined Access (no effect) Bit 15"
          "%%4544": "Use symbolic link"
          "%%4545": "Undefined Access (no effect) Bit 1"
          "%%4546": "Undefined Access (no effect) Bit 2"
          "%%4547": "Undefined Access (no effect) Bit 3"
          "%%4548": "Undefined Access (no effect) Bit 4"
          "%%4549": "Undefined Access (no effect) Bit 5"
          "%%4550": "Undefined Access (no effect) Bit 6"
          "%%4551": "Undefined Access (no effect) Bit 7"
          "%%4552": "Undefined Access (no effect) Bit 8"
          "%%4553": "Undefined Access (no effect) Bit 9"
          "%%4554": "Undefined Access (no effect) Bit 10"
          "%%4555": "Undefined Access (no effect) Bit 11"
          "%%4556": "Undefined Access (no effect) Bit 12"
          "%%4557": "Undefined Access (no effect) Bit 13"
          "%%4558": "Undefined Access (no effect) Bit 14"
          "%%4559": "Undefined Access (no effect) Bit 15"
          "%%4560": "Force thread termination"
          "%%4561": "Suspend or resume thread"
          "%%4562": "Send an alert to thread"
          "%%4563": "Get thread context"
          "%%4564": "Set thread context"
          "%%4565": "Set thread information"
          "%%4566": "Query thread information"
          "%%4567": "Assign a token to the thread"
          "%%4568": "Cause thread to directly impersonate another thread"
          "%%4569": "Directly impersonate this thread"
          "%%4570": "Undefined Access (no effect) Bit 10"
          "%%4571": "Undefined Access (no effect) Bit 11"
          "%%4572": "Undefined Access (no effect) Bit 12"
          "%%4573": "Undefined Access (no effect) Bit 13"
          "%%4574": "Undefined Access (no effect) Bit 14"
          "%%4575": "Undefined Access (no effect) Bit 15"
          "%%4576": "Query timer state"
          "%%4577": "Modify timer state"
          "%%4578": "Undefined Access (no effect) Bit 2"
          "%%4579": "Undefined Access (no effect) Bit 3"
          "%%4580": "Undefined Access (no effect) Bit 4"
          "%%4581": "Undefined Access (no effect) Bit 5"
          "%%4582": "Undefined Access (no effect) Bit 6"
          "%%4584": "Undefined Access (no effect) Bit 8"
          "%%4585": "Undefined Access (no effect) Bit 9"
          "%%4586": "Undefined Access (no effect) Bit 10"
          "%%4587": "Undefined Access (no effect) Bit 11"
          "%%4588": "Undefined Access (no effect) Bit 12"
          "%%4589": "Undefined Access (no effect) Bit 13"
          "%%4590": "Undefined Access (no effect) Bit 14"
          "%%4591": "Undefined Access (no effect) Bit 15"
          "%%4592": "AssignAsPrimary"
          "%%4593": "Duplicate"
          "%%4594": "Impersonate"
          "%%4595": "Query"
          "%%4596": "QuerySource"
          "%%4597": "AdjustPrivileges"
          "%%4598": "AdjustGroups"
          "%%4599": "AdjustDefaultDacl"
          "%%4600": "AdjustSessionID"
          "%%4601": "Undefined Access (no effect) Bit 9"
          "%%4602": "Undefined Access (no effect) Bit 10"
          "%%4603": "Undefined Access (no effect) Bit 11"
          "%%4604": "Undefined Access (no effect) Bit 12"
          "%%4605": "Undefined Access (no effect) Bit 13"
          "%%4606": "Undefined Access (no effect) Bit 14"
          "%%4607": "Undefined Access (no effect) Bit 15"
          "%%4608": "Create instance of object type"
          "%%4609": "Undefined Access (no effect) Bit 1"
          "%%4610": "Undefined Access (no effect) Bit 2"
          "%%4611": "Undefined Access (no effect) Bit 3"
          "%%4612": "Undefined Access (no effect) Bit 4"
          "%%4613": "Undefined Access (no effect) Bit 5"
          "%%4614": "Undefined Access (no effect) Bit 6"
          "%%4615": "Undefined Access (no effect) Bit 7"
          "%%4616": "Undefined Access (no effect) Bit 8"
          "%%4617": "Undefined Access (no effect) Bit 9"
          "%%4618": "Undefined Access (no effect) Bit 10"
          "%%4619": "Undefined Access (no effect) Bit 11"
          "%%4620": "Undefined Access (no effect) Bit 12"
          "%%4621": "Undefined Access (no effect) Bit 13"
          "%%4622": "Undefined Access (no effect) Bit 14"
          "%%4623": "Undefined Access (no effect) Bit 15"
          "%%4864": "Query State"
          "%%4865": "Modify State"
          "%%5120": "Channel read message"
          "%%5121": "Channel write message"
          "%%5122": "Channel query information"
          "%%5123": "Channel set information"
          "%%5124": "Undefined Access (no effect) Bit 4"
          "%%5125": "Undefined Access (no effect) Bit 5"
          "%%5126": "Undefined Access (no effect) Bit 6"
          "%%5127": "Undefined Access (no effect) Bit 7"
          "%%5128": "Undefined Access (no effect) Bit 8"
          "%%5129": "Undefined Access (no effect) Bit 9"
          "%%5130": "Undefined Access (no effect) Bit 10"
          "%%5131": "Undefined Access (no effect) Bit 11"
          "%%5132": "Undefined Access (no effect) Bit 12"
          "%%5133": "Undefined Access (no effect) Bit 13"
          "%%5134": "Undefined Access (no effect) Bit 14"
          "%%5135": "Undefined Access (no effect) Bit 15"
          "%%5136": "Assign process"
          "%%5137": "Set Attributes"
          "%%5138": "Query Attributes"
          "%%5139": "Terminate Job"
          "%%5140": "Set Security Attributes"
          "%%5141": "Undefined Access (no effect) Bit 5"
          "%%5142": "Undefined Access (no effect) Bit 6"
          "%%5143": "Undefined Access (no effect) Bit 7"
          "%%5144": "Undefined Access (no effect) Bit 8"
          "%%5145": "Undefined Access (no effect) Bit 9"
          "%%5146": "Undefined Access (no effect) Bit 10"
          "%%5147": "Undefined Access (no effect) Bit 11"
          "%%5148": "Undefined Access (no effect) Bit 12"
          "%%5149": "Undefined Access (no effect) Bit 13"
          "%%5150": "Undefined Access (no effect) Bit 14"
          "%%5151": "Undefined Access (no effect) Bit 15"
          "%%5376": "ConnectToServer"
          "%%5377": "ShutdownServer"
          "%%5378": "InitializeServer"
          "%%5379": "CreateDomain"
          "%%5380": "EnumerateDomains"
          "%%5381": "LookupDomain"
          "%%5382": "Undefined Access (no effect) Bit 6"
          "%%5383": "Undefined Access (no effect) Bit 7"
          "%%5384": "Undefined Access (no effect) Bit 8"
          "%%5385": "Undefined Access (no effect) Bit 9"
          "%%5386": "Undefined Access (no effect) Bit 10"
          "%%5387": "Undefined Access (no effect) Bit 11"
          "%%5388": "Undefined Access (no effect) Bit 12"
          "%%5389": "Undefined Access (no effect) Bit 13"
          "%%5390": "Undefined Access (no effect) Bit 14"
          "%%5391": "Undefined Access (no effect) Bit 15"
          "%%5392": "ReadPasswordParameters"
          "%%5393": "WritePasswordParameters"
          "%%5394": "ReadOtherParameters"
          "%%5395": "WriteOtherParameters"
          "%%5396": "CreateUser"
          "%%5397": "CreateGlobalGroup"
          "%%5398": "CreateLocalGroup"
          "%%5399": "GetLocalGroupMembership"
          "%%5400": "ListAccounts"
          "%%5401": "LookupIDs"
          "%%5402": "AdministerServer"
          "%%5403": "Undefined Access (no effect) Bit 11"
          "%%5404": "Undefined Access (no effect) Bit 12"
          "%%5405": "Undefined Access (no effect) Bit 13"
          "%%5406": "Undefined Access (no effect) Bit 14"
          "%%5407": "Undefined Access (no effect) Bit 15"
          "%%5408": "ReadInformation"
          "%%5409": "WriteAccount"
          "%%5410": "AddMember"
          "%%5411": "RemoveMember"
          "%%5412": "ListMembers"
          "%%5413": "Undefined Access (no effect) Bit 5"
          "%%5414": "Undefined Access (no effect) Bit 6"
          "%%5415": "Undefined Access (no effect) Bit 7"
          "%%5416": "Undefined Access (no effect) Bit 8"
          "%%5417": "Undefined Access (no effect) Bit 9"
          "%%5418": "Undefined Access (no effect) Bit 10"
          "%%5419": "Undefined Access (no effect) Bit 11"
          "%%5420": "Undefined Access (no effect) Bit 12"
          "%%5421": "Undefined Access (no effect) Bit 13"
          "%%5422": "Undefined Access (no effect) Bit 14"
          "%%5423": "Undefined Access (no effect) Bit 15"
          "%%5424": "AddMember"
          "%%5425": "RemoveMember"
          "%%5426": "ListMembers"
          "%%5427": "ReadInformation"
          "%%5428": "WriteAccount"
          "%%5429": "Undefined Access (no effect) Bit 5"
          "%%5430": "Undefined Access (no effect) Bit 6"
          "%%5431": "Undefined Access (no effect) Bit 7"
          "%%5432": "Undefined Access (no effect) Bit 8"
          "%%5433": "Undefined Access (no effect) Bit 9"
          "%%5434": "Undefined Access (no effect) Bit 10"
          "%%5435": "Undefined Access (no effect) Bit 11"
          "%%5436": "Undefined Access (no effect) Bit 12"
          "%%5437": "Undefined Access (no effect) Bit 13"
          "%%5438": "Undefined Access (no effect) Bit 14"
          "%%5439": "Undefined Access (no effect) Bit 15"
          "%%5440": "ReadGeneralInformation"
          "%%5441": "ReadPreferences"
          "%%5442": "WritePreferences"
          "%%5443": "ReadLogon"
          "%%5444": "ReadAccount"
          "%%5445": "WriteAccount"
          "%%5446": "ChangePassword (with knowledge of old password)"
          "%%5447": "SetPassword (without knowledge of old password)"
          "%%5448": "ListGroups"
          "%%5449": "ReadGroupMembership"
          "%%5450": "ChangeGroupMembership"
          "%%5451": "Undefined Access (no effect) Bit 11"
          "%%5452": "Undefined Access (no effect) Bit 12"
          "%%5453": "Undefined Access (no effect) Bit 13"
          "%%5454": "Undefined Access (no effect) Bit 14"
          "%%5455": "Undefined Access (no effect) Bit 15"
          "%%5632": "View non-sensitive policy information"
          "%%5633": "View system audit requirements"
          "%%5634": "Get sensitive policy information"
          "%%5635": "Modify domain trust relationships"
          "%%5636": "Create special accounts (for assignment of user rights)"
          "%%5637": "Create a secret object"
          "%%5638": "Create a privilege"
          "%%5639": "Set default quota limits"
          "%%5640": "Change system audit requirements"
          "%%5641": "Administer audit log attributes"
          "%%5642": "Enable/Disable LSA"
          "%%5643": "Lookup Names/SIDs"
          "%%5648": "Change secret value"
          "%%5649": "Query secret value"
          "%%5650": "Undefined Access (no effect) Bit 2"
          "%%5651": "Undefined Access (no effect) Bit 3"
          "%%5652": "Undefined Access (no effect) Bit 4"
          "%%5653": "Undefined Access (no effect) Bit 5"
          "%%5654": "Undefined Access (no effect) Bit 6"
          "%%5655": "Undefined Access (no effect) Bit 7"
          "%%5656": "Undefined Access (no effect) Bit 8"
          "%%5657": "Undefined Access (no effect) Bit 9"
          "%%5658": "Undefined Access (no effect) Bit 10"
          "%%5659": "Undefined Access (no effect) Bit 11"
          "%%5660": "Undefined Access (no effect) Bit 12"
          "%%5661": "Undefined Access (no effect) Bit 13"
          "%%5662": "Undefined Access (no effect) Bit 14"
          "%%5663": "Undefined Access (no effect) Bit 15"
          "%%5664": "Query trusted domain name/SID"
          "%%5665": "Retrieve the controllers in the trusted domain"
          "%%5666": "Change the controllers in the trusted domain"
          "%%5667": "Query the Posix ID offset assigned to the trusted domain"
          "%%5668": "Change the Posix ID offset assigned to the trusted domain"
          "%%5669": "Undefined Access (no effect) Bit 5"
          "%%5670": "Undefined Access (no effect) Bit 6"
          "%%5671": "Undefined Access (no effect) Bit 7"
          "%%5672": "Undefined Access (no effect) Bit 8"
          "%%5673": "Undefined Access (no effect) Bit 9"
          "%%5674": "Undefined Access (no effect) Bit 10"
          "%%5675": "Undefined Access (no effect) Bit 11"
          "%%5676": "Undefined Access (no effect) Bit 12"
          "%%5677": "Undefined Access (no effect) Bit 13"
          "%%5678": "Undefined Access (no effect) Bit 14"
          "%%5679": "Undefined Access (no effect) Bit 15"
          "%%5680": "Query account information"
          "%%5681": "Change privileges assigned to account"
          "%%5682": "Change quotas assigned to account"
          "%%5683": "Change logon capabilities assigned to account"
          "%%5684": "Change the Posix ID offset assigned to the accounted domain"
          "%%5685": "Undefined Access (no effect) Bit 5"
          "%%5686": "Undefined Access (no effect) Bit 6"
          "%%5687": "Undefined Access (no effect) Bit 7"
          "%%5688": "Undefined Access (no effect) Bit 8"
          "%%5689": "Undefined Access (no effect) Bit 9"
          "%%5690": "Undefined Access (no effect) Bit 10"
          "%%5691": "Undefined Access (no effect) Bit 11"
          "%%5692": "Undefined Access (no effect) Bit 12"
          "%%5693": "Undefined Access (no effect) Bit 13"
          "%%5694": "Undefined Access (no effect) Bit 14"
          "%%5695": "Undefined Access (no effect) Bit 15"
          "%%5696": "KeyedEvent Wait"
          "%%5697": "KeyedEvent Wake"
          "%%5698": "Undefined Access (no effect) Bit 2"
          "%%5699": "Undefined Access (no effect) Bit 3"
          "%%5700": "Undefined Access (no effect) Bit 4"
          "%%5701": "Undefined Access (no effect) Bit 5"
          "%%5702": "Undefined Access (no effect) Bit 6"
          "%%5703": "Undefined Access (no effect) Bit 7"
          "%%5704": "Undefined Access (no effect) Bit 8"
          "%%5705": "Undefined Access (no effect) Bit 9"
          "%%5706": "Undefined Access (no effect) Bit 10"
          "%%5707": "Undefined Access (no effect) Bit 11"
          "%%5708": "Undefined Access (no effect) Bit 12"
          "%%5709": "Undefined Access (no effect) Bit 13"
          "%%5710": "Undefined Access (no effect) Bit 14"
          "%%5711": "Undefined Access (no effect) Bit 15"
          "%%6656": "Enumerate desktops"
          "%%6657": "Read attributes"
          "%%6658": "Access Clipboard"
          "%%6659": "Create desktop"
          "%%6660": "Write attributes"
          "%%6661": "Access global atoms"
          "%%6662": "Exit windows"
          "%%6663": "Unused Access Flag"
          "%%6664": "Include this windowstation in enumerations"
          "%%6665": "Read screen"
          "%%6672": "Read Objects"
          "%%6673": "Create window"
          "%%6674": "Create menu"
          "%%6675": "Hook control"
          "%%6676": "Journal (record)"
          "%%6677": "Journal (playback)"
          "%%6678": "Include this desktop in enumerations"
          "%%6679": "Write objects"
          "%%6680": "Switch to this desktop"
          "%%6912": "Administer print server"
          "%%6913": "Enumerate printers"
          "%%6930": "Full Control"
          "%%6931": "Print"
          "%%6948": "Administer Document"
          "%%7168": "Connect to service controller"
          "%%7169": "Create a new service"
          "%%7170": "Enumerate services"
          "%%7171": "Lock service database for exclusive access"
          "%%7172": "Query service database lock state"
          "%%7173": "Set last-known-good state of service database"
          "%%7184": "Query service configuration information"
          "%%7185": "Set service configuration information"
          "%%7186": "Query status of service"
          "%%7187": "Enumerate dependencies of service"
          "%%7188": "Start the service"
          "%%7189": "Stop the service"
          "%%7190": "Pause or continue the service"
          "%%7191": "Query information from service"
          "%%7192": "Issue service-specific control commands"
          "%%7424": "DDE Share Read"
          "%%7425": "DDE Share Write"
          "%%7426": "DDE Share Initiate Static"
          "%%7427": "DDE Share Initiate Link"
          "%%7428": "DDE Share Request"
          "%%7429": "DDE Share Advise"
          "%%7430": "DDE Share Poke"
          "%%7431": "DDE Share Execute"
          "%%7432": "DDE Share Add Items"
          "%%7433": "DDE Share List Items"
          "%%7680": "Create Child"
          "%%7681": "Delete Child"
          "%%7682": "List Contents"
          "%%7683": "Write Self"
          "%%7684": "Read Property"
          "%%7685": "Write Property"
          "%%7686": "Delete Tree"
          "%%7687": "List Object"
          "%%7688": "Control Access"
          "%%7689": "Undefined Access (no effect) Bit 9"
          "%%7690": "Undefined Access (no effect) Bit 10"
          "%%7691": "Undefined Access (no effect) Bit 11"
          "%%7692": "Undefined Access (no effect) Bit 12"
          "%%7693": "Undefined Access (no effect) Bit 13"
          "%%7694": "Undefined Access (no effect) Bit 14"
          "%%7695": "Undefined Access (no effect) Bit 15"
          "%%7936": "Audit Set System Policy"
          "%%7937": "Audit Query System Policy"
          "%%7938": "Audit Set Per User Policy"
          "%%7939": "Audit Query Per User Policy"
          "%%7940": "Audit Enumerate Users"
          "%%7941": "Audit Set Options"
          "%%7942": "Audit Query Options"
          "%%8064": "Port sharing (read)"
          "%%8065": "Port sharing (write)"
          "%%8096": "Default credentials"
          "%%8097": "Credentials manager"
          "%%8098": "Fresh credentials"
          "%%8192": "Kerberos"
          "%%8193": "Preshared key"
          "%%8194": "Unknown authentication"
          "%%8195": "DES"
          "%%8196": "3DES"
          "%%8197": "MD5"
          "%%8198": "SHA1"
          "%%8199": "Local computer"
          "%%8200": "Remote computer"
          "%%8201": "No state"
          "%%8202": "Sent first (SA) payload"
          "%%8203": "Sent second (KE) payload"
          "%%8204": "Sent third (ID) payload"
          "%%8205": "Initiator"
          "%%8206": "Responder"
          "%%8207": "No state"
          "%%8208": "Sent first (SA) payload"
          "%%8209": "Sent final payload"
          "%%8210": "Complete"
          "%%8211": "Unknown"
          "%%8212": "Transport"
          "%%8213": "Tunnel"
          "%%8214": "IKE/AuthIP DoS prevention mode started"
          "%%8215": "IKE/AuthIP DoS prevention mode stopped"
          "%%8216": "Enabled"
          "%%8217": "Not enabled"
          "%%8218": "No state"
          "%%8219": "Sent first (EM attributes) payload"
          "%%8220": "Sent second (SSPI) payload"
          "%%8221": "Sent third (hash) payload"
          "%%8222": "IKEv1"
          "%%8223": "AuthIP"
          "%%8224": "Anonymous"
          "%%8225": "NTLM V2"
          "%%8226": "CGA"
          "%%8227": "Certificate"
          "%%8228": "SSL"
          "%%8229": "None"
          "%%8230": "DH group 1"
          "%%8231": "DH group 2"
          "%%8232": "DH group 14"
          "%%8233": "DH group ECP 256"
          "%%8234": "DH group ECP 384"
          "%%8235": "AES-128"
          "%%8236": "AES-192"
          "%%8237": "AES-256"
          "%%8238": "Certificate ECDSA P256"
          "%%8239": "Certificate ECDSA P384"
          "%%8240": "SSL ECDSA P256"
          "%%8241": "SSL ECDSA P384"
          "%%8242": "SHA 256"
          "%%8243": "SHA 384"
          "%%8244": "IKEv2"
          "%%8245": "EAP payload sent"
          "%%8246": "Authentication payload sent"
          "%%8247": "EAP"
          "%%8248": "DH group 24"
          "%%8272": "System"
          "%%8273": "Logon/Logoff"
          "%%8274": "Object Access"
          "%%8275": "Privilege Use"
          "%%8276": "Detailed Tracking"
          "%%8277": "Policy Change"
          "%%8278": "Account Management"
          "%%8279": "DS Access"
          "%%8280": "Account Logon"
          "%%8448": "Success removed"
          "%%8449": "Success Added"
          "%%8450": "Failure removed"
          "%%8451": "Failure Added"
          "%%8452": "Success include removed"
          "%%8453": "Success include added"
          "%%8454": "Success exclude removed"
          "%%8455": "Success exclude added"
          "%%8456": "Failure include removed"
          "%%8457": "Failure include added"
          "%%8458": "Failure exclude removed"
          "%%8459": "Failure exclude added"
          "%%12288": "Security State Change"
          "%%12289": "Security System Extension"
          "%%12290": "System Integrity"
          "%%12291": "IPsec Driver"
          "%%12292": "Other System Events"
          "%%12544": "Logon"
          "%%12545": "Logoff"
          "%%12546": "Account Lockout"
          "%%12547": "IPsec Main Mode"
          "%%12548": "Special Logon"
          "%%12549": "IPsec Quick Mode"
          "%%12550": "IPsec Extended Mode"
          "%%12551": "Other Logon/Logoff Events"
          "%%12552": "Network Policy Server"
          "%%12553": "User / Device Claims"
          "%%12554": "Group Membership"
          "%%12800": "File System"
          "%%12801": "Registry"
          "%%12802": "Kernel Object"
          "%%12803": "SAM"
          "%%12804": "Other Object Access Events"
          "%%12805": "Certification Services"
          "%%12806": "Application Generated"
          "%%12807": "Handle Manipulation"
          "%%12808": "File Share"
          "%%12809": "Filtering Platform Packet Drop"
          "%%12810": "Filtering Platform Connection"
          "%%12811": "Detailed File Share"
          "%%12812": "Removable Storage"
          "%%12813": "Central Policy Staging"
          "%%13056": "Sensitive Privilege Use"
          "%%13057": "Non Sensitive Privilege Use"
          "%%13058": "Other Privilege Use Events"
          "%%13312": "Process Creation"
          "%%13313": "Process Termination"
          "%%13314": "DPAPI Activity"
          "%%13315": "RPC Events"
          "%%13316": "Plug and Play Events"
          "%%13317": "Token Right Adjusted Events"
          "%%13568": "Audit Policy Change"
          "%%13569": "Authentication Policy Change"
          "%%13570": "Authorization Policy Change"
          "%%13571": "MPSSVC Rule-Level Policy Change"
          "%%13572": "Filtering Platform Policy Change"
          "%%13573": "Other Policy Change Events"
          "%%13824": "User Account Management"
          "%%13825": "Computer Account Management"
          "%%13826": "Security Group Management"
          "%%13827": "Distribution Group Management"
          "%%13828": "Application Group Management"
          "%%13829": "Other Account Management Events"
          "%%14080": "Directory Service Access"
          "%%14081": "Directory Service Changes"
          "%%14082": "Directory Service Replication"
          "%%14083": "Detailed Directory Service Replication"
          "%%14336": "Credential Validation"
          "%%14337": "Kerberos Service Ticket Operations"
          "%%14338": "Other Account Logon Events"
          "%%14339": "Kerberos Authentication Service"
          "%%14592": "Inbound"
          "%%14593": "Outbound"
          "%%14594": "Forward"
          "%%14595": "Bidirectional"
          "%%14596": "IP Packet"
          "%%14597": "Transport"
          "%%14598": "Forward"
          "%%14599": "Stream"
          "%%14600": "Datagram Data"
          "%%14601": "ICMP Error"
          "%%14602": "MAC 802.3"
          "%%14603": "MAC Native"
          "%%14604": "vSwitch"
          "%%14608": "Resource Assignment"
          "%%14609": "Listen"
          "%%14610": "Receive/Accept"
          "%%14611": "Connect"
          "%%14612": "Flow Established"
          "%%14614": "Resource Release"
          "%%14615": "Endpoint Closure"
          "%%14616": "Connect Redirect"
          "%%14617": "Bind Redirect"
          "%%14624": "Stream Packet"
          "%%14640": "ICMP Echo-Request"
          "%%14641": "vSwitch Ingress"
          "%%14642": "vSwitch Egress"
          "%%14672": "<Binary>"
          "%%14673": "[NULL]"
          "%%14674": "Value Added"
          "%%14675": "Value Deleted"
          "%%14676": "Active Directory Domain Services"
          "%%14677": "Active Directory Lightweight Directory Services"
          "%%14678": "Yes"
          "%%14679": "No"
          "%%14680": "Value Added With Expiration Time"
          "%%14681": "Value Deleted With Expiration Time"
          "%%14688": "Value Auto Deleted With Expiration Time"
          "%%16384": "Add"
          "%%16385": "Delete"
          "%%16386": "Boot-time"
          "%%16387": "Persistent"
          "%%16388": "Not persistent"
          "%%16389": "Block"
          "%%16390": "Permit"
          "%%16391": "Callout"
          "%%16392": "MD5"
          "%%16393": "SHA-1"
          "%%16394": "SHA-256"
          "%%16395": "AES-GCM 128"
          "%%16396": "AES-GCM 192"
          "%%16397": "AES-GCM 256"
          "%%16398": "DES"
          "%%16399": "3DES"
          "%%16400": "AES-128"
          "%%16401": "AES-192"
          "%%16402": "AES-256"
          "%%16403": "Transport"
          "%%16404": "Tunnel"
          "%%16405": "Responder"
          "%%16406": "Initiator"
          "%%16407": "AES-GMAC 128"
          "%%16408": "AES-GMAC 192"
          "%%16409": "AES-GMAC 256"
          "%%16416": "AuthNoEncap Transport"
          "%%16896": "Enable WMI Account"
          "%%16897": "Execute Method"
          "%%16898": "Full Write"
          "%%16899": "Partial Write"
          "%%16900": "Provider Write"
          "%%16901": "Remote Access"
          "%%16902": "Subscribe"
          "%%16903": "Publish"
        mapping:
          json.event.winlog.event_data.FailureReason: winlog.logon.failure.reason
        filter: '{{json.event.winlog.event_data.get("FailureReason")!= None}}'

  powershell_fields:
    actions:
      - set:
          event.code: "{{json.event.winlog.event_id}}"
          event.module: "powershell"
          event.sequence: "{{json.event.winlog.event_data.SequenceNumber}}"
          file.path: "{{json.event.winlog.event_data.ScriptName}}"
          log.level: "{{json.event.winlog.level}}"
          powershell.command.name: "{{json.event.winlog.event_data.CommandName}}"
          powershell.command.path: "{{json.event.winlog.event_data.CommandPath}}"
          powershell.command.type: "{{json.event.winlog.event_data.CommandType}}"
          powershell.command.value: "{{json.event.winlog.event_data.CommandLine}}"
          powershell.engine.new_state: "{{json.event.winlog.event_data.NewEngineState}}"
          powershell.engine.previous_state: "{{json.event.winlog.event_data.PreviousEngineState}}"
          powershell.engine.version: "{{json.event.winlog.event_data.EngineVersion}}"
          powershell.file.script_block_id: "{{json.event.winlog.event_data.ScriptBlockId}}"
          powershell.file.script_block_text: "{{json.event.winlog.event_data.ScriptBlockText}}"
          powershell.id: "{{json.event.winlog.event_data.ShellID}}"
          powershell.pipeline_id: "{{json.event.winlog.event_data.PipelineId}}"
          powershell.process.executable_version: "{{json.event.winlog.event_data.HostVersion}}"
          powershell.provider.name: "{{json.event.winlog.event_data.ProviderName}}"
          powershell.provider.new_state: "{{json.event.winlog.event_data.NewProviderState}}"
          powershell.runspace_id: "{{json.event.winlog.event_data.RunspaceId}}"
          powershell.sequence: "{{json.event.winlog.event_data.DetailSequence or json.event.winlog.event_data.MessageNumber}}"
          powershell.total: "{{json.event.winlog.event_data.DetailTotal or json.event.winlog.event_data.MessageTotal}}"
          process.args: '{{json.event.process.command_line.split(" ")}}'
          process.args_count: '{{json.event.process.command_line.split(" ")|length}}'
          process.command_line: "{{json.event.winlog.event_data.HostApplication}}"
          process.entity_id: "{{json.event.winlog.event_data.HostId}}"
          process.title: "{{json.event.winlog.event_data.HostName}}"
          user.domain: '{{json.event.winlog.event_data.UserId.split("\\")|first}}'
          user.id: "{{json.event.winlog.user.identifier}}"
          user.name: '{{json.event.winlog.event_data.UserId.split("\\")|last}}'
      - set:
          event.type: "info"
        filter: '{{json.event.event.get("type") == None}}'
      - set:
          event.category: "process"
        filter: '{{json.event.event.get("category") == None}}'
      - set:
          user.domain: '{{json.event.winlog.event_data.User.split("\\")|first}}'
          user.name: '{{json.event.winlog.event_data.User.split("\\")|last}}'
        filter: '{{json.event.winlog.event_data.User.split("\\")|length == 2}}'
      - set:
          source.user.domain: '{{json.event.winlog.event_data.ConnectedUser.split("\\")|first}}'
          source.user.name: '{{json.event.winlog.event_data.ConnectedUser.split("\\")|last}}'
        filter: '{{json.event.winlog.event_data.ConnectedUser.split("\\")|length == 2}}'
      - set:
          powershell.command.invocation_details: >
            {%- set results = [] -%}
            {%- set param3 = json.event.winlog.event_data.param3.split("\n") -%}
            {%- for v in param3 -%}
            {%- set detailRegex = '^([^:(]+)\(([^)]+)\)\:\s*(.+)?$' -%}
            {%- set parameterBindingRegex = 'name\=(.+);\s*value\=(.+)$' -%}
            {%- if re.match(detailRegex, v) == None -%}
            {%- set results = results.append({"value":v}) -%}
            {%- else -%}
            {%- set matches = [] -%}
            {%- for i in re.search(detailRegex,v).groups() -%}
            {%- set matches = matches.append(i) -%}
            {%- endfor -%}
            {%- if len(matches) != 4 -%}
            {%- set results = results.append({"value":v}) -%}
            {%- elif matches[1] != "ParameterBinding" -%}
            {%- set results = results.append({"type": matches[1],"related_command": matches[2],"value": matches[3]}) -%}
            {%- elif re.match(parameterBindingRegex,matches[3]) == None -%}
            {%- set results = results.append({"value": matches[4]}) -%}
            {%- else -%}
            {%- set nameValMatches = [] -%}
            {%- for i in re.search(parameterBindingRegex,matches[3]).groups() -%}
            {%- set nameValMatches = nameValMatches.append(i) -%}
            {%- endfor -%}
            {%- if len(nameValMatches) != 3 -%}
            {%- set results = results.append({"value": matches[3]}) -%}
            {%- else -%}
            {%- set results = results.append({"type": matches[1],"related_command": matches[2],"name": nameValMatches[1],"value": nameValMatches[2]}) -%}
            {%- endif -%}
            {%- endif -%}
            {%- endif -%}
            {%- endfor -%}
            {{results}}
        filter: '{{json.event.event.get("code") == "800"}}'
      - set:
          powershell.command.invocation_details: >
            {%- set results = [] -%}
            {%- set payload = json.event.winlog.event_data.Payload.split("\n") -%}
            {%- for v in payload -%}
            {%- set detailRegex = '^([^:(]+)\(([^)]+)\)\:\s*(.+)?$' -%}
            {%- set parameterBindingRegex = 'name\=(.+);\s*value\=(.+)$' -%}
            {%- if re.match(detailRegex, v) == None -%}
            {%- set results = results.append({"value":v}) -%}
            {%- else -%}
            {%- set matches = [] -%}
            {%- for i in re.search(detailRegex,v).groups() -%}
            {%- set matches = matches.append(i) -%}
            {%- endfor -%}
            {%- if len(matches) != 4 -%}
            {%- set results = results.append({"value":v}) -%}
            {%- elif matches[1] != "ParameterBinding" -%}
            {%- set results = results.append({"type": matches[1],"related_command": matches[2],"value": matches[3]}) -%}
            {%- elif re.match(parameterBindingRegex,matches[3]) == None -%}
            {%- set results = results.append({"value": matches[4]}) -%}
            {%- else -%}
            {%- set nameValMatches = [] -%}
            {%- for i in re.search(parameterBindingRegex,matches[3]).groups() -%}
            {%- set nameValMatches = nameValMatches.append(i) -%}
            {%- endfor -%}
            {%- if len(nameValMatches) != 3 -%}
            {%- set results = results.append({"value": matches[3]}) -%}
            {%- else -%}
            {%- set results = results.append({"type": matches[1],"related_command": matches[2],"name": nameValMatches[1],"value": nameValMatches[2]}) -%}
            {%- endif -%}
            {%- endif -%}
            {%- endif -%}
            {%- endfor -%}
            {{results}}
        filter: '{{json.event.event.get("code") == "4103"}}'
      - set:
          file.name: '{{json.event..winlog.event_data.ScriptName.split("\\")|last}}'
          file.directory: '{{json.event.winlog.event_data.ScriptName.split("\\")[:-1]|join}}'
        filter: '{{json.event.winlog.event_data.ScriptName.split("\\")|length > 1}}'
      - set:
          file.extension: '{{json.event.winlog.event_data.ScriptName.split(".")|last}}'
        filter: '{{json.event.winlog.event_data.ScriptName.split(".")|length > 1}}'
