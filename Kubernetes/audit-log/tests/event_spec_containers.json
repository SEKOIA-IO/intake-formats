{
  "input": {
    "message": "{\"kind\": \"Event\", \"user\": {\"extra\": {\"authentication.kubernetes.io/credential-id\": [\"X509SHA256=9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\"]}, \"groups\": [\"system:masters\", \"system:authenticated\"], \"username\": \"minikube-user\"}, \"verb\": \"create\", \"level\": \"RequestResponse\", \"stage\": \"ResponseComplete\", \"auditID\": \"8cb523a6-0be6-4198-8886-ed4fa57bd375\", \"objectRef\": {\"name\": \"priv-shell\", \"resource\": \"pods\", \"namespace\": \"default\", \"apiVersion\": \"v1\"}, \"sourceIPs\": [\"1.2.3.4\"], \"userAgent\": \"kubectl/v1.32.5 (linux/amd64) kubernetes/9894294\", \"apiVersion\": \"audit.k8s.io/v1\", \"requestURI\": \"/api/v1/namespaces/default/pods?fieldManager=kubectl-run\", \"annotations\": {\"authorization.k8s.io/reason\": \"\", \"authorization.k8s.io/decision\": \"allow\", \"pod-security.kubernetes.io/enforce-policy\": \"privileged:latest\"}, \"requestObject\": {\"kind\": \"Pod\", \"spec\": {\"dnsPolicy\": \"ClusterFirst\", \"containers\": [{\"name\": \"shell\", \"image\": \"ubuntu:24.04\", \"command\": [\"bash\", \"-c\", \"sleep infinity\"], \"resources\": {}, \"imagePullPolicy\": \"IfNotPresent\", \"securityContext\": {\"privileged\": true}, \"terminationMessagePath\": \"/dev/termination-log\", \"terminationMessagePolicy\": \"File\"}], \"restartPolicy\": \"Never\", \"schedulerName\": \"default-scheduler\", \"securityContext\": {}, \"enableServiceLinks\": true, \"terminationGracePeriodSeconds\": 30}, \"status\": {}, \"metadata\": {\"name\": \"priv-shell\", \"labels\": {\"run\": \"priv-shell\"}, \"creationTimestamp\": null}, \"apiVersion\": \"v1\"}, \"responseObject\": {\"kind\": \"Pod\", \"spec\": {\"volumes\": [{\"name\": \"kube-api-access-cmszt\", \"projected\": {\"sources\": [{\"serviceAccountToken\": {\"path\": \"token\", \"expirationSeconds\": 3607}}, {\"configMap\": {\"name\": \"kube-root-ca.crt\", \"items\": [{\"key\": \"ca.crt\", \"path\": \"ca.crt\"}]}}, {\"downwardAPI\": {\"items\": [{\"path\": \"namespace\", \"fieldRef\": {\"fieldPath\": \"metadata.namespace\", \"apiVersion\": \"v1\"}}]}}], \"defaultMode\": 420}}], \"priority\": 0, \"dnsPolicy\": \"ClusterFirst\", \"containers\": [{\"name\": \"shell\", \"image\": \"ubuntu:24.04\", \"command\": [\"bash\", \"-c\", \"sleep infinity\"], \"resources\": {}, \"volumeMounts\": [{\"name\": \"kube-api-access-cmszt\", \"readOnly\": true, \"mountPath\": \"/var/run/secrets/kubernetes.io/serviceaccount\"}], \"imagePullPolicy\": \"IfNotPresent\", \"securityContext\": {\"privileged\": true}, \"terminationMessagePath\": \"/dev/termination-log\", \"terminationMessagePolicy\": \"File\"}], \"tolerations\": [{\"key\": \"node.kubernetes.io/not-ready\", \"effect\": \"NoExecute\", \"operator\": \"Exists\", \"tolerationSeconds\": 300}, {\"key\": \"node.kubernetes.io/unreachable\", \"effect\": \"NoExecute\", \"operator\": \"Exists\", \"tolerationSeconds\": 300}], \"restartPolicy\": \"Never\", \"schedulerName\": \"default-scheduler\", \"serviceAccount\": \"default\", \"securityContext\": {}, \"preemptionPolicy\": \"PreemptLowerPriority\", \"enableServiceLinks\": true, \"serviceAccountName\": \"default\", \"terminationGracePeriodSeconds\": 30}, \"status\": {\"phase\": \"Pending\", \"qosClass\": \"BestEffort\"}, \"metadata\": {\"uid\": \"b213474e-679f-43e4-8e26-6bfde524ba34\", \"name\": \"priv-shell\", \"labels\": {\"run\": \"priv-shell\"}, \"namespace\": \"default\", \"managedFields\": [{\"time\": \"2025-05-22T13:14:38Z\", \"manager\": \"kubectl-run\", \"fieldsV1\": {\"f:spec\": {\"f:dnsPolicy\": {}, \"f:containers\": {\"k:{\\\"name\\\":\\\"shell\\\"}\": {\".\": {}, \"f:name\": {}, \"f:image\": {}, \"f:command\": {}, \"f:resources\": {}, \"f:imagePullPolicy\": {}, \"f:securityContext\": {\".\": {}, \"f:privileged\": {}}, \"f:terminationMessagePath\": {}, \"f:terminationMessagePolicy\": {}}}, \"f:restartPolicy\": {}, \"f:schedulerName\": {}, \"f:securityContext\": {}, \"f:enableServiceLinks\": {}, \"f:terminationGracePeriodSeconds\": {}}, \"f:metadata\": {\"f:labels\": {\".\": {}, \"f:run\": {}}}}, \"operation\": \"Update\", \"apiVersion\": \"v1\", \"fieldsType\": \"FieldsV1\"}], \"resourceVersion\": \"12992\", \"creationTimestamp\": \"2025-05-22T13:14:38Z\"}, \"apiVersion\": \"v1\"}, \"responseStatus\": {\"code\": 201, \"metadata\": {}}, \"stageTimestamp\": \"2025-05-22T13:14:38.223786Z\", \"requestReceivedTimestamp\": \"2025-05-22T13:14:38.218223Z\"}"
  },
  "expected": {
    "message": "{\"kind\": \"Event\", \"user\": {\"extra\": {\"authentication.kubernetes.io/credential-id\": [\"X509SHA256=9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\"]}, \"groups\": [\"system:masters\", \"system:authenticated\"], \"username\": \"minikube-user\"}, \"verb\": \"create\", \"level\": \"RequestResponse\", \"stage\": \"ResponseComplete\", \"auditID\": \"8cb523a6-0be6-4198-8886-ed4fa57bd375\", \"objectRef\": {\"name\": \"priv-shell\", \"resource\": \"pods\", \"namespace\": \"default\", \"apiVersion\": \"v1\"}, \"sourceIPs\": [\"1.2.3.4\"], \"userAgent\": \"kubectl/v1.32.5 (linux/amd64) kubernetes/9894294\", \"apiVersion\": \"audit.k8s.io/v1\", \"requestURI\": \"/api/v1/namespaces/default/pods?fieldManager=kubectl-run\", \"annotations\": {\"authorization.k8s.io/reason\": \"\", \"authorization.k8s.io/decision\": \"allow\", \"pod-security.kubernetes.io/enforce-policy\": \"privileged:latest\"}, \"requestObject\": {\"kind\": \"Pod\", \"spec\": {\"dnsPolicy\": \"ClusterFirst\", \"containers\": [{\"name\": \"shell\", \"image\": \"ubuntu:24.04\", \"command\": [\"bash\", \"-c\", \"sleep infinity\"], \"resources\": {}, \"imagePullPolicy\": \"IfNotPresent\", \"securityContext\": {\"privileged\": true}, \"terminationMessagePath\": \"/dev/termination-log\", \"terminationMessagePolicy\": \"File\"}], \"restartPolicy\": \"Never\", \"schedulerName\": \"default-scheduler\", \"securityContext\": {}, \"enableServiceLinks\": true, \"terminationGracePeriodSeconds\": 30}, \"status\": {}, \"metadata\": {\"name\": \"priv-shell\", \"labels\": {\"run\": \"priv-shell\"}, \"creationTimestamp\": null}, \"apiVersion\": \"v1\"}, \"responseObject\": {\"kind\": \"Pod\", \"spec\": {\"volumes\": [{\"name\": \"kube-api-access-cmszt\", \"projected\": {\"sources\": [{\"serviceAccountToken\": {\"path\": \"token\", \"expirationSeconds\": 3607}}, {\"configMap\": {\"name\": \"kube-root-ca.crt\", \"items\": [{\"key\": \"ca.crt\", \"path\": \"ca.crt\"}]}}, {\"downwardAPI\": {\"items\": [{\"path\": \"namespace\", \"fieldRef\": {\"fieldPath\": \"metadata.namespace\", \"apiVersion\": \"v1\"}}]}}], \"defaultMode\": 420}}], \"priority\": 0, \"dnsPolicy\": \"ClusterFirst\", \"containers\": [{\"name\": \"shell\", \"image\": \"ubuntu:24.04\", \"command\": [\"bash\", \"-c\", \"sleep infinity\"], \"resources\": {}, \"volumeMounts\": [{\"name\": \"kube-api-access-cmszt\", \"readOnly\": true, \"mountPath\": \"/var/run/secrets/kubernetes.io/serviceaccount\"}], \"imagePullPolicy\": \"IfNotPresent\", \"securityContext\": {\"privileged\": true}, \"terminationMessagePath\": \"/dev/termination-log\", \"terminationMessagePolicy\": \"File\"}], \"tolerations\": [{\"key\": \"node.kubernetes.io/not-ready\", \"effect\": \"NoExecute\", \"operator\": \"Exists\", \"tolerationSeconds\": 300}, {\"key\": \"node.kubernetes.io/unreachable\", \"effect\": \"NoExecute\", \"operator\": \"Exists\", \"tolerationSeconds\": 300}], \"restartPolicy\": \"Never\", \"schedulerName\": \"default-scheduler\", \"serviceAccount\": \"default\", \"securityContext\": {}, \"preemptionPolicy\": \"PreemptLowerPriority\", \"enableServiceLinks\": true, \"serviceAccountName\": \"default\", \"terminationGracePeriodSeconds\": 30}, \"status\": {\"phase\": \"Pending\", \"qosClass\": \"BestEffort\"}, \"metadata\": {\"uid\": \"b213474e-679f-43e4-8e26-6bfde524ba34\", \"name\": \"priv-shell\", \"labels\": {\"run\": \"priv-shell\"}, \"namespace\": \"default\", \"managedFields\": [{\"time\": \"2025-05-22T13:14:38Z\", \"manager\": \"kubectl-run\", \"fieldsV1\": {\"f:spec\": {\"f:dnsPolicy\": {}, \"f:containers\": {\"k:{\\\"name\\\":\\\"shell\\\"}\": {\".\": {}, \"f:name\": {}, \"f:image\": {}, \"f:command\": {}, \"f:resources\": {}, \"f:imagePullPolicy\": {}, \"f:securityContext\": {\".\": {}, \"f:privileged\": {}}, \"f:terminationMessagePath\": {}, \"f:terminationMessagePolicy\": {}}}, \"f:restartPolicy\": {}, \"f:schedulerName\": {}, \"f:securityContext\": {}, \"f:enableServiceLinks\": {}, \"f:terminationGracePeriodSeconds\": {}}, \"f:metadata\": {\"f:labels\": {\".\": {}, \"f:run\": {}}}}, \"operation\": \"Update\", \"apiVersion\": \"v1\", \"fieldsType\": \"FieldsV1\"}], \"resourceVersion\": \"12992\", \"creationTimestamp\": \"2025-05-22T13:14:38Z\"}, \"apiVersion\": \"v1\"}, \"responseStatus\": {\"code\": 201, \"metadata\": {}}, \"stageTimestamp\": \"2025-05-22T13:14:38.223786Z\", \"requestReceivedTimestamp\": \"2025-05-22T13:14:38.218223Z\"}",
    "event": {
      "action": "create",
      "code": "8cb523a6-0be6-4198-8886-ed4fa57bd375",
      "outcome": "allow",
      "start": "2025-05-22T13:14:38.218223Z"
    },
    "action": {
      "outcome": "allow"
    },
    "http": {
      "response": {
        "status_code": 201
      }
    },
    "kubernetes": {
      "namespace": "default",
      "object": {
        "name": "priv-shell"
      },
      "resource": "pods",
      "spec": {
        "containers": [
          {
            "command": [
              "bash",
              "-c",
              "sleep infinity"
            ],
            "image": "ubuntu:24.04",
            "imagePullPolicy": "IfNotPresent",
            "name": "shell",
            "securityContext": {
              "privileged": true
            },
            "terminationMessagePath": "/dev/termination-log",
            "terminationMessagePolicy": "File"
          }
        ]
      }
    },
    "related": {
      "ip": [
        "1.2.3.4"
      ],
      "user": [
        "minikube-user"
      ]
    },
    "source": {
      "address": "1.2.3.4",
      "ip": "1.2.3.4"
    },
    "url": {
      "path": "/api/v1/namespaces/default/pods?fieldManager=kubectl-run"
    },
    "user": {
      "name": "minikube-user",
      "roles": [
        "system:authenticated",
        "system:masters"
      ]
    },
    "user_agent": {
      "device": {
        "name": "Other"
      },
      "name": "Other",
      "original": "kubectl/v1.32.5 (linux/amd64) kubernetes/9894294",
      "os": {
        "name": "Linux"
      }
    }
  }
}