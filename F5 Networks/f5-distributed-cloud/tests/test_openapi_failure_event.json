{
  "input": {
    "message": "{\"@timestamp\":\"2025-04-23T08:01:08.481975167Z\",\"_id\":\"5765504561525734669\",\"_visitor_id\":\"9b88292873332155956246853111\",\"action\":\"allow\",\"api_endpoint\":\"/api/locations\",\"app\":\"test_app\",\"app_type\":\"demo-app-sentence-api\",\"asn\":\"PRIVATE\",\"authority\":\"test.sentence.f5.com\",\"browser_type\":\"curl\",\"city\":\"PRIVATE\",\"cluster_name\":\"test_cluster_name\",\"country\":\"PRIVATE\",\"device_type\":\"Other\",\"domain\":\"test.f5demos.com\",\"dst\":\"S:sentence.test.com\",\"dst_instance\":\"2.7.2.5\",\"dst_ip\":\"2.7.2.5\",\"dst_port\":\"80\",\"dst_site\":\"test_dst_site\",\"host\":\"1.5.5.2\",\"hostname\":\"test_hostname\",\"http_version\":\"\",\"jwt_action\":\"\",\"jwt_missing_claim\":\"\",\"jwt_status\":\"\",\"kubernetes\":{\"container_name\":\"test_container_name\",\"host\":\"test_host\",\"labels\":{\"app\":\"test_app\"},\"namespace_name\":\"test_name_space\",\"pod_id\":\"5cc2748f-8999-4444-a777-352e9d555555\",\"pod_name\":\"test_pod_name\"},\"latitude\":\"PRIVATE\",\"longitude\":\"PRIVATE\",\"messageid\":\"308a7550-c6ed-1111-9999-0000ac000002\",\"method\":\"GET\",\"namespace\":\"test_namespace\",\"network\":\"PRIVATE\",\"no_active_detections\":false,\"oas_req_status\":\"OpenAPIViolation\",\"oas_rsp_status\":\"OpenAPIValidationSuccessful\",\"policy_hits\":{\"policy_hits\":[]},\"recommended_action\":\"\",\"region\":\"PRIVATE\",\"req_headers\":\"{\\\":authority\\\":\\\"test.f5se.com\\\",\\\":method\\\":\\\"GET\\\",\\\":path\\\":\\\"/api/locations\\\",\\\":scheme\\\":\\\"https\\\",\\\"accept\\\":\\\"*/*\\\",\\\"cookie\\\":\\\"_imp_apg_r_=bbd188330192000\\\",\\\"user-agent\\\":\\\"curl/7.68.0\\\",\\\"x-envoy-external-address\\\":\\\"5.1.8.1\\\",\\\"x-envoy-original-authority\\\":\\\"test.f5demos.com\\\",\\\"x-forwarded-for\\\":\\\"5.1.8.1\\\",\\\"x-forwarded-proto\\\":\\\"https\\\",\\\"x-request-id\\\":\\\"c3334487-ffff-4666-dddd-042222474747\\\",\\\"x-volterra-truncated-hdr\\\":\\\"false\\\",\\\"xff\\\":\\\"2.1.2.1\\\"}\",\"req_headers_size\":0,\"req_id\":\"c3338787-f444-6666-dddd-042222474747\",\"req_params\":\"\",\"req_path\":\"/api/locations\",\"req_size\":\"347\",\"rsp_code\":\"200\",\"rsp_code_class\":\"2xx\",\"rsp_size\":\"565656\",\"sec_event_name\":\"OpenAPI Validation Failure\",\"sec_event_type\":\"api_sec_event\",\"severity\":\"info\",\"signatures\":[],\"site\":\"test_site\",\"sni\":\"test_sni\",\"src\":\"N:public\",\"src_instance\":\"UNKNOWN\",\"src_ip\":\"2.1.2.1\",\"src_port\":\"0\",\"src_site\":\"test_src_site\",\"stream\":\"test_stream\",\"tag\":\"test_tag\",\"tenant\":\"test_tenant\",\"time\":\"2025-04-23T08:01:08.481Z\",\"tls_fingerprint\":\"f43339666f3333344444048863273338\",\"user\":\"Cookie-_imp_apg_r_-bbb11333009000ee\",\"user_agent\":\"curl/7.68.0\",\"vh_name\":\"vh-name-http-api\",\"vhost_id\":\"f6333233-3333-4333-8333-333342973524\",\"violations\":[{\"context\":\"Request\",\"description\":\"HTTP Authorization header not found\",\"field\":\"\",\"property\":\"Security Schema\",\"value\":\"\"}],\"x_forwarded_for\":\"5.1.8.1\"}",
    "sekoiaio": {
      "intake": {
        "dialect": "F5 Distributed Cloud",
        "dialect_uuid": "d1d24b7a-c6a7-482d-8334-affc0a11dedd"
      }
    }
  },
  "expected": {
    "message": "{\"@timestamp\":\"2025-04-23T08:01:08.481975167Z\",\"_id\":\"5765504561525734669\",\"_visitor_id\":\"9b88292873332155956246853111\",\"action\":\"allow\",\"api_endpoint\":\"/api/locations\",\"app\":\"test_app\",\"app_type\":\"demo-app-sentence-api\",\"asn\":\"PRIVATE\",\"authority\":\"test.sentence.f5.com\",\"browser_type\":\"curl\",\"city\":\"PRIVATE\",\"cluster_name\":\"test_cluster_name\",\"country\":\"PRIVATE\",\"device_type\":\"Other\",\"domain\":\"test.f5demos.com\",\"dst\":\"S:sentence.test.com\",\"dst_instance\":\"2.7.2.5\",\"dst_ip\":\"2.7.2.5\",\"dst_port\":\"80\",\"dst_site\":\"test_dst_site\",\"host\":\"1.5.5.2\",\"hostname\":\"test_hostname\",\"http_version\":\"\",\"jwt_action\":\"\",\"jwt_missing_claim\":\"\",\"jwt_status\":\"\",\"kubernetes\":{\"container_name\":\"test_container_name\",\"host\":\"test_host\",\"labels\":{\"app\":\"test_app\"},\"namespace_name\":\"test_name_space\",\"pod_id\":\"5cc2748f-8999-4444-a777-352e9d555555\",\"pod_name\":\"test_pod_name\"},\"latitude\":\"PRIVATE\",\"longitude\":\"PRIVATE\",\"messageid\":\"308a7550-c6ed-1111-9999-0000ac000002\",\"method\":\"GET\",\"namespace\":\"test_namespace\",\"network\":\"PRIVATE\",\"no_active_detections\":false,\"oas_req_status\":\"OpenAPIViolation\",\"oas_rsp_status\":\"OpenAPIValidationSuccessful\",\"policy_hits\":{\"policy_hits\":[]},\"recommended_action\":\"\",\"region\":\"PRIVATE\",\"req_headers\":\"{\\\":authority\\\":\\\"test.f5se.com\\\",\\\":method\\\":\\\"GET\\\",\\\":path\\\":\\\"/api/locations\\\",\\\":scheme\\\":\\\"https\\\",\\\"accept\\\":\\\"*/*\\\",\\\"cookie\\\":\\\"_imp_apg_r_=bbd188330192000\\\",\\\"user-agent\\\":\\\"curl/7.68.0\\\",\\\"x-envoy-external-address\\\":\\\"5.1.8.1\\\",\\\"x-envoy-original-authority\\\":\\\"test.f5demos.com\\\",\\\"x-forwarded-for\\\":\\\"5.1.8.1\\\",\\\"x-forwarded-proto\\\":\\\"https\\\",\\\"x-request-id\\\":\\\"c3334487-ffff-4666-dddd-042222474747\\\",\\\"x-volterra-truncated-hdr\\\":\\\"false\\\",\\\"xff\\\":\\\"2.1.2.1\\\"}\",\"req_headers_size\":0,\"req_id\":\"c3338787-f444-6666-dddd-042222474747\",\"req_params\":\"\",\"req_path\":\"/api/locations\",\"req_size\":\"347\",\"rsp_code\":\"200\",\"rsp_code_class\":\"2xx\",\"rsp_size\":\"565656\",\"sec_event_name\":\"OpenAPI Validation Failure\",\"sec_event_type\":\"api_sec_event\",\"severity\":\"info\",\"signatures\":[],\"site\":\"test_site\",\"sni\":\"test_sni\",\"src\":\"N:public\",\"src_instance\":\"UNKNOWN\",\"src_ip\":\"2.1.2.1\",\"src_port\":\"0\",\"src_site\":\"test_src_site\",\"stream\":\"test_stream\",\"tag\":\"test_tag\",\"tenant\":\"test_tenant\",\"time\":\"2025-04-23T08:01:08.481Z\",\"tls_fingerprint\":\"f43339666f3333344444048863273338\",\"user\":\"Cookie-_imp_apg_r_-bbb11333009000ee\",\"user_agent\":\"curl/7.68.0\",\"vh_name\":\"vh-name-http-api\",\"vhost_id\":\"f6333233-3333-4333-8333-333342973524\",\"violations\":[{\"context\":\"Request\",\"description\":\"HTTP Authorization header not found\",\"field\":\"\",\"property\":\"Security Schema\",\"value\":\"\"}],\"x_forwarded_for\":\"5.1.8.1\"}",
    "event": {
      "action": "allow",
      "dataset": "api_sec_event",
      "module": "f5.xc.waf"
    },
    "@timestamp": "2025-04-23T08:01:08.481000Z",
    "client": {
      "user": {
        "id": "Cookie-_imp_apg_r_-bbb11333009000ee"
      }
    },
    "destination": {
      "address": "2.7.2.5",
      "ip": "2.7.2.5",
      "port": 80
    },
    "f5": {
      "xc": {
        "api_endpoint": "/api/locations",
        "http_lb": "test.sentence.f5.com",
        "namespace": "test_namespace",
        "sec_event_name": "OpenAPI Validation Failure",
        "signatures": [],
        "tenant": "test_tenant",
        "tls_fingerprint": "f43339666f3333344444048863273338",
        "violations": [
          {
            "context": "Request",
            "description": "HTTP Authorization header not found",
            "field": "",
            "property": "Security Schema",
            "value": ""
          }
        ]
      }
    },
    "http": {
      "request": {
        "bytes": 347,
        "id": "c3338787-f444-6666-dddd-042222474747",
        "method": "GET"
      },
      "response": {
        "bytes": 565656,
        "status_code": 200
      }
    },
    "observer": {
      "type": "F5 Distributed Cloud",
      "vendor": "F5"
    },
    "related": {
      "hosts": [
        "test.f5demos.com"
      ],
      "ip": [
        "2.1.2.1",
        "2.7.2.5"
      ]
    },
    "source": {
      "address": "2.1.2.1",
      "geo": {
        "city_name": "PRIVATE",
        "country_iso_code": "PRIVATE",
        "region_iso_code": "PRIVATE"
      },
      "ip": "2.1.2.1",
      "port": 0
    },
    "url": {
      "domain": "test.f5demos.com",
      "path": "/api/locations",
      "registered_domain": "f5demos.com",
      "subdomain": "test",
      "top_level_domain": "com"
    },
    "user_agent": {
      "device": {
        "name": "Other"
      },
      "name": "curl",
      "original": "curl/7.68.0",
      "os": {
        "name": "Other"
      },
      "version": "7.68.0"
    }
  }
}