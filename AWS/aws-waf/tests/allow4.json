{
  "input": {
    "message": "{\"timestamp\": 1751109958160, \"formatVersion\": 1, \"webaclId\": \"arn:aws:wafv2:us-east-1:111111111:global/webacl/ACME-apiGlobalBasic-1720017236085/f778905e-55c3-40c4-8e10-7a857ec8a8ea\", \"terminatingRuleId\": \"Default_Action\", \"terminatingRuleType\": \"REGULAR\", \"action\": \"ALLOW\", \"terminatingRuleMatchDetails\": [], \"httpSourceName\": \"CF\", \"httpSourceId\": \"E3110XBJP6HY3F\", \"ruleGroupList\": [{\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:22222222:global/rulegroup/Global-Allow-RuleGroup/871efe3d-d8e7-44e7-962b-5260b7a6c8e3\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:22222222:global/rulegroup/Global-Block-RuleGroup/c9ccce1f-57ca-4c55-9ede-6c63c7c3e774\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:153427709519:global/rulegroup/ShieldMitigationRuleGroup_111111111_f778905e-55c3-40c4-8e10-7a857ec8a8ea_59012c9a-1a58-4d79-8da7-5e3a5c4b3eaa/26ef9209-22b1-42d1-ac47-59473883e918\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:22222222:global/rulegroup/apiGloba-RateBased/f844b1c9-b7a7-439d-880d-9905a05a4844\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesAmazonIpReputationList\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesAnonymousIpList\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesKnownBadInputsRuleSet\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesCommonRuleSet\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}], \"rateBasedRuleList\": [], \"nonTerminatingMatchingRules\": [], \"requestHeadersInserted\": null, \"responseCodeSent\": null, \"httpRequest\": {\"clientIp\": \"1.2.3.4\", \"country\": \"FR\", \"headers\": [{\"name\": \"Accept\", \"value\": \"application/json\"}, {\"name\": \"ContentType\", \"value\": \"application/json\"}, {\"name\": \"x-api-key\", \"value\": \"EXAMPLE_API_KEY\"}, {\"name\": \"Content-Type\", \"value\": \"application/json; charset=UTF-8\"}, {\"name\": \"Content-Length\", \"value\": \"99\"}, {\"name\": \"Host\", \"value\": \"example.com\"}, {\"name\": \"Connection\", \"value\": \"Keep-Alive\"}, {\"name\": \"Accept-Encoding\", \"value\": \"gzip\"}, {\"name\": \"User-Agent\", \"value\": \"okhttp/4.9.1\"}], \"uri\": \"/auth\", \"args\": \"\", \"httpVersion\": \"HTTP/1.1\", \"httpMethod\": \"POST\", \"requestId\": \"123\", \"fragment\": \"\", \"scheme\": \"https\", \"host\": \"example.com\"}, \"labels\": [{\"name\": \"awswaf:clientip:geo:region:FR-GES\"}, {\"name\": \"awswaf:clientip:geo:country:FR\"}], \"requestBodySize\": 99, \"requestBodySizeInspectedByWAF\": 99, \"ja3Fingerprint\": \"123456789\", \"ja4Fingerprint\": \"111_222_333\"}"
  },
  "expected": {
    "message": "{\"timestamp\": 1751109958160, \"formatVersion\": 1, \"webaclId\": \"arn:aws:wafv2:us-east-1:111111111:global/webacl/ACME-apiGlobalBasic-1720017236085/f778905e-55c3-40c4-8e10-7a857ec8a8ea\", \"terminatingRuleId\": \"Default_Action\", \"terminatingRuleType\": \"REGULAR\", \"action\": \"ALLOW\", \"terminatingRuleMatchDetails\": [], \"httpSourceName\": \"CF\", \"httpSourceId\": \"E3110XBJP6HY3F\", \"ruleGroupList\": [{\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:22222222:global/rulegroup/Global-Allow-RuleGroup/871efe3d-d8e7-44e7-962b-5260b7a6c8e3\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:22222222:global/rulegroup/Global-Block-RuleGroup/c9ccce1f-57ca-4c55-9ede-6c63c7c3e774\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:153427709519:global/rulegroup/ShieldMitigationRuleGroup_111111111_f778905e-55c3-40c4-8e10-7a857ec8a8ea_59012c9a-1a58-4d79-8da7-5e3a5c4b3eaa/26ef9209-22b1-42d1-ac47-59473883e918\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"arn:aws:wafv2:us-east-1:22222222:global/rulegroup/apiGloba-RateBased/f844b1c9-b7a7-439d-880d-9905a05a4844\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesAmazonIpReputationList\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesAnonymousIpList\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesKnownBadInputsRuleSet\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}, {\"ruleGroupId\": \"AWS#AWSManagedRulesCommonRuleSet\", \"terminatingRule\": null, \"nonTerminatingMatchingRules\": [], \"excludedRules\": null, \"customerConfig\": null}], \"rateBasedRuleList\": [], \"nonTerminatingMatchingRules\": [], \"requestHeadersInserted\": null, \"responseCodeSent\": null, \"httpRequest\": {\"clientIp\": \"1.2.3.4\", \"country\": \"FR\", \"headers\": [{\"name\": \"Accept\", \"value\": \"application/json\"}, {\"name\": \"ContentType\", \"value\": \"application/json\"}, {\"name\": \"x-api-key\", \"value\": \"EXAMPLE_API_KEY\"}, {\"name\": \"Content-Type\", \"value\": \"application/json; charset=UTF-8\"}, {\"name\": \"Content-Length\", \"value\": \"99\"}, {\"name\": \"Host\", \"value\": \"example.com\"}, {\"name\": \"Connection\", \"value\": \"Keep-Alive\"}, {\"name\": \"Accept-Encoding\", \"value\": \"gzip\"}, {\"name\": \"User-Agent\", \"value\": \"okhttp/4.9.1\"}], \"uri\": \"/auth\", \"args\": \"\", \"httpVersion\": \"HTTP/1.1\", \"httpMethod\": \"POST\", \"requestId\": \"123\", \"fragment\": \"\", \"scheme\": \"https\", \"host\": \"example.com\"}, \"labels\": [{\"name\": \"awswaf:clientip:geo:region:FR-GES\"}, {\"name\": \"awswaf:clientip:geo:country:FR\"}], \"requestBodySize\": 99, \"requestBodySizeInspectedByWAF\": 99, \"ja3Fingerprint\": \"123456789\", \"ja4Fingerprint\": \"111_222_333\"}",
    "event": {
      "action": "ALLOW",
      "category": [
        "network"
      ],
      "module": "aws.waf",
      "type": [
        "access"
      ]
    },
    "@timestamp": "2025-06-28T11:25:58.160000Z",
    "action": {
      "target": "network-traffic"
    },
    "aws": {
      "waf": {
        "client": {
          "ja4": "111_222_333"
        },
        "rule": {
          "arn": "arn:aws:wafv2:us-east-1:111111111:global/webacl/ACME-apiGlobalBasic-1720017236085/f778905e-55c3-40c4-8e10-7a857ec8a8ea"
        }
      }
    },
    "cloud": {
      "provider": "aws",
      "region": "us-east-1",
      "service": {
        "name": "waf"
      }
    },
    "destination": {
      "address": "example.com",
      "domain": "example.com",
      "registered_domain": "example.com",
      "top_level_domain": "com"
    },
    "http": {
      "request": {
        "body": {
          "bytes": 99
        },
        "id": "123",
        "method": "POST",
        "mime_type": "application/json; charset=UTF-8"
      },
      "version": "HTTP/1.1"
    },
    "observer": {
      "type": "waf"
    },
    "related": {
      "hosts": [
        "example.com"
      ],
      "ip": [
        "1.2.3.4"
      ]
    },
    "rule": {
      "category": "REGULAR",
      "name": "Default_Action"
    },
    "source": {
      "address": "1.2.3.4",
      "ip": "1.2.3.4"
    },
    "tls": {
      "client": {
        "ja3": "123456789"
      }
    },
    "url": {
      "original": "/auth",
      "path": "/auth"
    },
    "user_agent": {
      "device": {
        "name": "Other"
      },
      "name": "okhttp",
      "original": "okhttp/4.9.1",
      "os": {
        "name": "Other"
      },
      "version": "4.9.1"
    }
  }
}