{
  "input": {
    "message": "{\"timestamp\":1724172306949,\"formatVersion\":1,\"webaclId\":\"arn:aws:wafv2:eu-west-3:736484235634:regional/webacl/ACME/1dbb6fab-3713-4b94-be2b-a53d4c914b3d\",\"terminatingRuleId\":\"Default_Action\",\"terminatingRuleType\":\"REGULAR\",\"action\":\"ALLOW\",\"terminatingRuleMatchDetails\":[],\"httpSourceName\":\"ALB\",\"httpSourceId\":\"736484235634-app/acme-ALB/a7d22dfa27083e64\",\"ruleGroupList\":[{\"ruleGroupId\":\"arn:aws:wafv2:eu-west-3:736484235634:regional/rulegroup/rule/75c436b4-0143-4bfa-8045-d333529e78f0\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":[{\"exclusionType\":\"EXCLUDED_AS_COUNT\",\"ruleId\":\"root-url\",\"ruleMatchDetails\":null}],\"customerConfig\":null},{\"ruleGroupId\":\"arn:aws:wafv2:eu-west-3:736484235634:regional/rulegroup/urls/9d38afd6-5664-46ca-96d1-491f3ee6de6a\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"arn:aws:wafv2:eu-west-3:411563154075:regional/rulegroup/RuleGroup_736484235634_1dbb6fab-3713-4b94-be2b-a53d4c914b3d_3a330c86-7311-4ba0-81cc-eec955280694/cb3c287e-5fe1-4c63-8c6a-f4a7f1f0f905\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesAmazonIpReputationList\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesAnonymousIpList\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[{\"ruleId\":\"HostingProviderIPList\",\"action\":\"COUNT\",\"overriddenAction\":\"BLOCK\",\"ruleMatchDetails\":[]}],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesKnownBadInputsRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesSQLiRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesUnixRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesLinuxRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null}],\"rateBasedRuleList\":[],\"nonTerminatingMatchingRules\":[],\"requestHeadersInserted\":null,\"responseCodeSent\":null,\"httpRequest\":{\"clientIp\":\"1.2.3.4\",\"country\":\"FR\",\"headers\":[{\"name\":\"Host\",\"value\":\"host\"},{\"name\":\"User-Agent\",\"value\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:98.0) Gecko/20100101 Firefox/98.0\"},{\"name\":\"Connection\",\"value\":\"close\"},{\"name\":\"Content-Length\",\"value\":\"70\"},{\"name\":\"Content-Type\",\"value\":\"application/x-www-form-urlencoded\"},{\"name\":\"X-From-Automation\",\"value\":\"something\"},{\"name\":\"Accept-Encoding\",\"value\":\"gzip\"}],\"uri\":\"/geoserver/TestPost\",\"args\":\"\",\"httpVersion\":\"HTTP/1.1\",\"httpMethod\":\"POST\",\"requestId\":\"1-66c4c812-09a4093421d49fca0ec8565f\"},\"ja3Fingerprint\":\"d4e5b18d6b55c71272893221c96ba240\",\"labels\":[{\"name\":\"awswaf:managed:aws:anonymous-ip-list:HostingProviderIPList\"}],\"requestBodySize\":70,\"requestBodySizeInspectedByWAF\":70}"
  },
  "expected": {
    "message": "{\"timestamp\":1724172306949,\"formatVersion\":1,\"webaclId\":\"arn:aws:wafv2:eu-west-3:736484235634:regional/webacl/ACME/1dbb6fab-3713-4b94-be2b-a53d4c914b3d\",\"terminatingRuleId\":\"Default_Action\",\"terminatingRuleType\":\"REGULAR\",\"action\":\"ALLOW\",\"terminatingRuleMatchDetails\":[],\"httpSourceName\":\"ALB\",\"httpSourceId\":\"736484235634-app/acme-ALB/a7d22dfa27083e64\",\"ruleGroupList\":[{\"ruleGroupId\":\"arn:aws:wafv2:eu-west-3:736484235634:regional/rulegroup/rule/75c436b4-0143-4bfa-8045-d333529e78f0\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":[{\"exclusionType\":\"EXCLUDED_AS_COUNT\",\"ruleId\":\"root-url\",\"ruleMatchDetails\":null}],\"customerConfig\":null},{\"ruleGroupId\":\"arn:aws:wafv2:eu-west-3:736484235634:regional/rulegroup/urls/9d38afd6-5664-46ca-96d1-491f3ee6de6a\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"arn:aws:wafv2:eu-west-3:411563154075:regional/rulegroup/RuleGroup_736484235634_1dbb6fab-3713-4b94-be2b-a53d4c914b3d_3a330c86-7311-4ba0-81cc-eec955280694/cb3c287e-5fe1-4c63-8c6a-f4a7f1f0f905\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesAmazonIpReputationList\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesAnonymousIpList\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[{\"ruleId\":\"HostingProviderIPList\",\"action\":\"COUNT\",\"overriddenAction\":\"BLOCK\",\"ruleMatchDetails\":[]}],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesKnownBadInputsRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesSQLiRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesUnixRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null},{\"ruleGroupId\":\"AWS#AWSManagedRulesLinuxRuleSet\",\"terminatingRule\":null,\"nonTerminatingMatchingRules\":[],\"excludedRules\":null,\"customerConfig\":null}],\"rateBasedRuleList\":[],\"nonTerminatingMatchingRules\":[],\"requestHeadersInserted\":null,\"responseCodeSent\":null,\"httpRequest\":{\"clientIp\":\"1.2.3.4\",\"country\":\"FR\",\"headers\":[{\"name\":\"Host\",\"value\":\"host\"},{\"name\":\"User-Agent\",\"value\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:98.0) Gecko/20100101 Firefox/98.0\"},{\"name\":\"Connection\",\"value\":\"close\"},{\"name\":\"Content-Length\",\"value\":\"70\"},{\"name\":\"Content-Type\",\"value\":\"application/x-www-form-urlencoded\"},{\"name\":\"X-From-Automation\",\"value\":\"something\"},{\"name\":\"Accept-Encoding\",\"value\":\"gzip\"}],\"uri\":\"/geoserver/TestPost\",\"args\":\"\",\"httpVersion\":\"HTTP/1.1\",\"httpMethod\":\"POST\",\"requestId\":\"1-66c4c812-09a4093421d49fca0ec8565f\"},\"ja3Fingerprint\":\"d4e5b18d6b55c71272893221c96ba240\",\"labels\":[{\"name\":\"awswaf:managed:aws:anonymous-ip-list:HostingProviderIPList\"}],\"requestBodySize\":70,\"requestBodySizeInspectedByWAF\":70}",
    "event": {
      "action": "ALLOW",
      "category": [
        "network"
      ],
      "module": "aws.waf",
      "type": [
        "access"
      ]
    },
    "@timestamp": "2024-08-20T16:45:06.949000Z",
    "action": {
      "target": "network-traffic"
    },
    "aws": {
      "waf": {
        "rule": {
          "arn": "arn:aws:wafv2:eu-west-3:736484235634:regional/webacl/ACME/1dbb6fab-3713-4b94-be2b-a53d4c914b3d"
        }
      }
    },
    "cloud": {
      "provider": "aws",
      "region": "eu-west-3",
      "service": {
        "name": "waf"
      }
    },
    "destination": {
      "address": "host",
      "domain": "host",
      "top_level_domain": "host"
    },
    "http": {
      "request": {
        "body": {
          "bytes": 70
        },
        "id": "1-66c4c812-09a4093421d49fca0ec8565f",
        "method": "POST",
        "mime_type": "application/x-www-form-urlencoded"
      },
      "version": "HTTP/1.1"
    },
    "observer": {
      "type": "waf"
    },
    "related": {
      "hosts": [
        "host"
      ],
      "ip": [
        "1.2.3.4"
      ]
    },
    "rule": {
      "category": "REGULAR",
      "name": "Default_Action"
    },
    "source": {
      "address": "1.2.3.4",
      "ip": "1.2.3.4"
    },
    "tls": {
      "client": {
        "ja3": "d4e5b18d6b55c71272893221c96ba240"
      }
    },
    "url": {
      "original": "/geoserver/TestPost",
      "path": "/geoserver/TestPost"
    },
    "user_agent": {
      "device": {
        "name": "Mac"
      },
      "name": "Firefox",
      "original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:98.0) Gecko/20100101 Firefox/98.0",
      "os": {
        "name": "Mac OS X",
        "version": "10.15"
      },
      "version": "98.0"
    }
  }
}