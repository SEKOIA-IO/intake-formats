{
  "input": {
    "sekoiaio": {
      "intake": {
        "dialect": "AWS CloudTrail",
        "dialect_uuid": "d3a813ac-f9b5-451c-a602-a5994544d9ed"
      }
    },
    "message": "{\n    \"eventVersion\": \"1.08\",\n    \"userIdentity\": {\n        \"type\": \"IAMUser\",\n        \"principalId\": \"demo\",\n        \"arn\": \"arn:aws:iam::0:user/demo\",\n        \"accountId\": \"00000\",\n        \"accessKeyId\": \"AAAAAAAAA\",\n        \"userName\": \"AAAAAAAAAAAA\"\n    },\n    \"eventTime\": \"2023-09-29T15:06:45Z\",\n    \"eventSource\": \"ecs.amazonaws.com\",\n    \"eventName\": \"PutClusterCapacityProviders\",\n    \"awsRegion\": \"eu-west-1\",\n    \"sourceIPAddress\": \"00.000.000.00\",\n    \"userAgent\": \"APN/1.0 HashiCorp/1.0 Terraform/1.4.7 (+https://www.terraform.io) terraform-provider-aws/4.59.0 (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.44.221 (go1.19.6; linux; amd64)\",\n    \"requestParameters\": {\n        \"cluster\": \"cluster_name\",\n        \"capacityProviders\": [\n            \"DEMO\"\n        ],\n        \"defaultCapacityProviderStrategy\": [\n            {\n                \"capacityProvider\": \"DEMO\",\n                \"weight\": 0,\n                \"base\": 0\n            }\n        ]\n    },\n    \"responseElements\": {\n        \"cluster\": {\n            \"clusterArn\": \"arn:aws:ecs:eu-west-1:00000000:cluster/cluster_name\",\n            \"clusterName\": \"cluster_name\",\n            \"configuration\": {\n                \"executeCommandConfiguration\": {\n                    \"logging\": \"OVERRIDE\",\n                    \"logConfiguration\": {\n                        \"cloudWatchLogGroupName\": \"/ecs/cluster/cluster_name\",\n                        \"cloudWatchEncryptionEnabled\": true,\n                        \"s3EncryptionEnabled\": false\n                    }\n                }\n            },\n            \"status\": \"ACTIVE\",\n            \"registeredContainerInstancesCount\": 0,\n            \"runningTasksCount\": 0,\n            \"pendingTasksCount\": 0,\n            \"activeServicesCount\": 0,\n            \"statistics\": [],\n            \"tags\": [],\n            \"settings\": [\n                {\n                    \"name\": \"containerInsights\",\n                    \"value\": \"enabled\"\n                }\n            ],\n            \"capacityProviders\": [\n                \"DEMO\"\n            ],\n            \"defaultCapacityProviderStrategy\": [\n                {\n                    \"capacityProvider\": \"DEMO\",\n                    \"weight\": 0,\n                    \"base\": 0\n                }\n            ],\n            \"attachments\": [],\n            \"attachmentsStatus\": \"UPDATE_IN_PROGRESS\"\n        }\n    },\n    \"readOnly\": false,\n    \"eventType\": \"AwsApiCall\",\n    \"managementEvent\": true,\n    \"recipientAccountId\": \"007\",\n    \"eventCategory\": \"Management\",\n    \"tlsDetails\": {\n        \"tlsVersion\": \"TLSv1.3\",\n        \"cipherSuite\": \"TLS_AES_128_GCM_SHA256\",\n        \"clientProvidedHostHeader\": \"sekoia.eu-west-1.amazonaws.com\"\n    }\n}"
  },
  "expected": {
    "message": "{\n    \"eventVersion\": \"1.08\",\n    \"userIdentity\": {\n        \"type\": \"IAMUser\",\n        \"principalId\": \"demo\",\n        \"arn\": \"arn:aws:iam::0:user/demo\",\n        \"accountId\": \"00000\",\n        \"accessKeyId\": \"AAAAAAAAA\",\n        \"userName\": \"AAAAAAAAAAAA\"\n    },\n    \"eventTime\": \"2023-09-29T15:06:45Z\",\n    \"eventSource\": \"ecs.amazonaws.com\",\n    \"eventName\": \"PutClusterCapacityProviders\",\n    \"awsRegion\": \"eu-west-1\",\n    \"sourceIPAddress\": \"00.000.000.00\",\n    \"userAgent\": \"APN/1.0 HashiCorp/1.0 Terraform/1.4.7 (+https://www.terraform.io) terraform-provider-aws/4.59.0 (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.44.221 (go1.19.6; linux; amd64)\",\n    \"requestParameters\": {\n        \"cluster\": \"cluster_name\",\n        \"capacityProviders\": [\n            \"DEMO\"\n        ],\n        \"defaultCapacityProviderStrategy\": [\n            {\n                \"capacityProvider\": \"DEMO\",\n                \"weight\": 0,\n                \"base\": 0\n            }\n        ]\n    },\n    \"responseElements\": {\n        \"cluster\": {\n            \"clusterArn\": \"arn:aws:ecs:eu-west-1:00000000:cluster/cluster_name\",\n            \"clusterName\": \"cluster_name\",\n            \"configuration\": {\n                \"executeCommandConfiguration\": {\n                    \"logging\": \"OVERRIDE\",\n                    \"logConfiguration\": {\n                        \"cloudWatchLogGroupName\": \"/ecs/cluster/cluster_name\",\n                        \"cloudWatchEncryptionEnabled\": true,\n                        \"s3EncryptionEnabled\": false\n                    }\n                }\n            },\n            \"status\": \"ACTIVE\",\n            \"registeredContainerInstancesCount\": 0,\n            \"runningTasksCount\": 0,\n            \"pendingTasksCount\": 0,\n            \"activeServicesCount\": 0,\n            \"statistics\": [],\n            \"tags\": [],\n            \"settings\": [\n                {\n                    \"name\": \"containerInsights\",\n                    \"value\": \"enabled\"\n                }\n            ],\n            \"capacityProviders\": [\n                \"DEMO\"\n            ],\n            \"defaultCapacityProviderStrategy\": [\n                {\n                    \"capacityProvider\": \"DEMO\",\n                    \"weight\": 0,\n                    \"base\": 0\n                }\n            ],\n            \"attachments\": [],\n            \"attachmentsStatus\": \"UPDATE_IN_PROGRESS\"\n        }\n    },\n    \"readOnly\": false,\n    \"eventType\": \"AwsApiCall\",\n    \"managementEvent\": true,\n    \"recipientAccountId\": \"007\",\n    \"eventCategory\": \"Management\",\n    \"tlsDetails\": {\n        \"tlsVersion\": \"TLSv1.3\",\n        \"cipherSuite\": \"TLS_AES_128_GCM_SHA256\",\n        \"clientProvidedHostHeader\": \"sekoia.eu-west-1.amazonaws.com\"\n    }\n}",
    "event": {
      "action": "PutClusterCapacityProviders",
      "category": [
        "network"
      ],
      "dataset": "cloudtrail",
      "kind": "event",
      "outcome": "success",
      "provider": "ecs.amazonaws.com",
      "type": [
        "access"
      ]
    },
    "@timestamp": "2023-09-29T15:06:45Z",
    "action": {
      "name": "PutClusterCapacityProviders",
      "outcome": "success",
      "properties": {
        "recipientAccountId": "007",
        "userIdentity": {
          "accessKeyId": "AAAAAAAAA",
          "accountId": "00000",
          "arn": "arn:aws:iam::0:user/demo",
          "principalId": "demo",
          "type": "IAMUser",
          "userName": "AAAAAAAAAAAA"
        }
      },
      "target": "network-traffic",
      "type": "AwsApiCall"
    },
    "aws": {
      "cloudtrail": {
        "cluster_name": "cluster_name",
        "event_version": "1.08",
        "flattened": {
          "request_parameters": "{\"capacityProviders\": [\"DEMO\"], \"cluster\": \"cluster_name\", \"defaultCapacityProviderStrategy\": [{\"base\": 0, \"capacityProvider\": \"DEMO\", \"weight\": 0}]}",
          "response_elements": "{\"cluster\": {\"activeServicesCount\": 0, \"attachments\": [], \"attachmentsStatus\": \"UPDATE_IN_PROGRESS\", \"capacityProviders\": [\"DEMO\"], \"clusterArn\": \"arn:aws:ecs:eu-west-1:00000000:cluster/cluster_name\", \"clusterName\": \"cluster_name\", \"configuration\": {\"executeCommandConfiguration\": {\"logConfiguration\": {\"cloudWatchEncryptionEnabled\": true, \"cloudWatchLogGroupName\": \"/ecs/cluster/cluster_name\", \"s3EncryptionEnabled\": false}, \"logging\": \"OVERRIDE\"}}, \"defaultCapacityProviderStrategy\": [{\"base\": 0, \"capacityProvider\": \"DEMO\", \"weight\": 0}], \"pendingTasksCount\": 0, \"registeredContainerInstancesCount\": 0, \"runningTasksCount\": 0, \"settings\": [{\"name\": \"containerInsights\", \"value\": \"enabled\"}], \"statistics\": [], \"status\": \"ACTIVE\", \"tags\": []}}"
        },
        "recipient_account_id": "007",
        "user_identity": {
          "accessKeyId": "AAAAAAAAA",
          "accountId": "00000",
          "arn": "arn:aws:iam::0:user/demo",
          "principalId": "demo",
          "type": "IAMUser"
        }
      }
    },
    "cloud": {
      "account": {
        "id": "00000"
      },
      "provider": "aws",
      "region": "eu-west-1",
      "service": {
        "name": "cloudtrail"
      }
    },
    "tls": {
      "cipher": "TLS_AES_128_GCM_SHA256",
      "version": "TLSv1.3"
    },
    "user": {
      "id": "00000"
    },
    "user_agent": {
      "device": {
        "name": "Other"
      },
      "name": "aws-sdk-go",
      "original": "APN/1.0 HashiCorp/1.0 Terraform/1.4.7 (+https://www.terraform.io) terraform-provider-aws/4.59.0 (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.44.221 (go1.19.6; linux; amd64)",
      "os": {
        "name": "Linux"
      },
      "version": "1.44.221"
    }
  }
}