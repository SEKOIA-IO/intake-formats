[
  {
    "value": "{aws.cloudtrail.user_identity.arn} called {event.action} method from {event.provider} ",
    "conditions": [
      {
          "field": "action.type",
          "value": "AwsApiCall"
      },
      {
        "field": "aws.cloudtrail.user_identity.arn"
      },
      {
        "field": "event.action"
      },
      {
        "field": "event.provider"
      }
    ],
    "relationships": [
      {
        "source": "aws.cloudtrail.user_identity.arn",
        "target": "event.provider",
        "type": "requested"
      }
    ]
  },
  {
    "value": "{source.address} called {event.action} method from {event.provider} ",
    "conditions": [
      {
          "field": "action.type",
          "value": "AwsApiCall"
      },
      {
        "field": "source.address"
      },
      {
        "field": "event.action"
      },
      {
        "field": "event.provider"
      }
    ],
    "relationships": [
      {
        "source": "source.address",
        "target": "event.provider",
        "type": "requested"
      }
    ]
  },
  {
    "value": "{aws.cloudtrail.user_identity.arn} called {event.action} method from {event.provider} ",
    "conditions": [
      {
          "field": "action.type",
          "value": "AwsConsoleAction"
      },
      {
        "field": "aws.cloudtrail.user_identity.arn"
      },
      {
        "field": "event.action"
      },
      {
        "field": "event.provider"
      }
    ],
    "relationships": [
      {
        "source": "aws.cloudtrail.user_identity.arn",
        "target": "event.provider",
        "type": "requested"
      }
    ]
  },
  {
    "value": "{aws.cloudtrail.user_identity.arn} called {event.action} method from {event.provider} ",
    "conditions": [
      {
          "field": "action.type",
          "value": "AwsServiceEvent"
      },
      {
        "field": "aws.cloudtrail.user_identity.arn"
      },
      {
        "field": "event.action"
      },
      {
        "field": "event.provider"
      }
    ],
    "relationships": [
      {
        "source": "aws.cloudtrail.user_identity.arn",
        "target": "event.provider",
        "type": "requested"
      }
    ]
  },
  {
    "value": "{source.address} successfully signed in to account {aws.cloudtrail.recipient_account_id}",
    "conditions": [
      {
          "field": "action.type",
          "value": "AwsConsoleSignIn"
      },
      {
          "field": "event.type",
          "value": "allowed"
      },
      {
        "field": "source.address"
      },
      {
        "field": "aws.cloudtrail.recipient_account_id"
      }
    ],
    "relationships": [
      {
        "source": "source.address",
        "target": "aws.cloudtrail.recipient_account_id",
        "type": "signed in to"
      }
    ]
  },
  {
    "value": "{source.address} failed to sign in to account {aws.cloudtrail.recipient_account_id}",
    "conditions": [
      {
          "field": "action.type",
          "value": "AwsConsoleSignIn"
      },
      {
          "field": "event.type",
          "value": "denied"
      },
      {
        "field": "source.address"
      },
      {
        "field": "aws.cloudtrail.recipient_account_id"
      }
    ],
    "relationships": [
      {
        "source": "source.address",
        "target": "aws.cloudtrail.recipient_account_id",
        "type": "failed to sign in"
      }
    ]
  },
  {
    "value": "Insight {aws.cloudtrail.insight_details.type} {aws.cloudtrail.insight_details.state} from {event.provider} for action {event.action}: {event.code}",
    "conditions": [
      {
          "field": "action.type",
          "value": "AwsCloudTrailInsight"
      },
      {
          "field": "event.provider"
      },
      {
        "field": "event.code"
      },
      {
        "field": "aws.cloudtrail.insight_details.type"
      },
      {
        "field": "aws.cloudtrail.insight_details.state"
      }
    ],
    "relationships": [
      {
        "source": "event.provider",
        "target": "event.code",
        "type": "raised"
      }
    ]
  }
]
