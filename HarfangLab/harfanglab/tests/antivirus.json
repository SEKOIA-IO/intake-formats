{
  "input": {
    "message": "{\"log_type\": \"alert\", \"maturity\": \"stable\", \"alert_unique_id\": \"16e26085-d8ef-4b3a-a6f7-5065144b8a22\", \"alert_time\": \"2025-09-26T15:13:32.242+00:00\", \"@timestamp\": \"2025-09-26T15:13:32.381130+00:00\", \"ingestion_date\": \"2025-09-26T15:13:32.242+00:00\", \"@event_create_date\": \"2025-09-26T15:13:32.194Z\", \"detection_date\": \"2025-09-26T15:13:32.194+00:00\", \"rule_name\": \"HarfangLab Antivirus Scan: Trojan.JS.Spy\", \"msg\": \"File flagged as malicious by HarfangLab Antivirus scan\", \"type\": \"rtlogs\", \"alert_subtype\": \"antivirus\", \"alert_type\": \"hurukaiav\", \"status\": \"new\", \"level\": \"high\", \"level_int\": 40, \"execution\": 0, \"quarantine\": 4, \"detection\": {\"file_path\": \"C:\\\\Users\\\\johndoe.EXAMPLE\\\\AppData\\\\Local\\\\Mozilla\\\\Firefox\\\\Profiles\\\\PROFILE.default\\\\cache2\\\\entries\\\\AC61350006C184CB17DF3321F95D0249DBDB53F3\", \"file_hashes\": {\"md5\": \"3f2ad37247e7b5c227908df0faf082bb\", \"sha1\": \"5929f57743ee1029e3f4d6d2b2721d8fb76c25df\", \"sha256\": \"d8bd228fb6d718be222069a7f128682f5d76f40b9689bbf068a57c1545dff636\"}}, \"job_id\": \"49218f2f-3981-4f0a-ad1d-bfa38cceef06\", \"agent\": {\"agentid\": \"125aacfd-cafd-4d0c-8497-9a3119795a47\", \"hostname\": \"OP066M05\", \"ostype\": \"windows\", \"osproducttype\": \"Windows 11 Pro\", \"osversion\": \"10.0.22000\", \"domainname\": \"EXAMPLE\", \"dnsdomainname\": \"example.local\", \"version\": \"4.13.24\", \"additional_info\": {}}, \"detection_origin\": \"agent\", \"status_history\": [{\"timestamp\": \"2025-09-26T15:13:32.243+00:00\", \"action\": \"created\"}], \"av_detection_details\": {\"signature_name\": \"Trojan.JS.Spy\", \"signature_id\": 3853211, \"kind\": \"scan\", \"path\": \"C:\\\\Users\\\\johndoe.EXAMPLE\\\\AppData\\\\Local\\\\Mozilla\\\\Firefox\\\\Profiles\\\\PROFILE.default\\\\cache2\\\\entries\\\\AC61350006C184CB17DF3321F95D0249DBDB53F3\", \"hashes\": {\"md5\": \"3f2ad37247e7b5c227908df0faf082bb\", \"sha1\": \"5929f57743ee1029e3f4d6d2b2721d8fb76c25df\", \"sha256\": \"d8bd228fb6d718be222069a7f128682f5d76f40b9689bbf068a57c1545dff636\"}, \"file_type\": \"unknown\", \"file_size\": 399151}, \"threat_type\": \"agent_rule\", \"threat_values\": [\"125aacfd-cafd-4d0c-8497-9a3119795a47\", \"HarfangLab Antivirus Scan: Trojan.JS.Spy\"], \"threat_key\": \"efb493dd-5087-4e41-8ddb-670fe3f98de8\", \"rule_id\": \"HarfangLab Antivirus Scan: Trojan.JS.Spy\", \"groups\": [{\"id\": \"7248a5c0-096d-4680-b552-75abdbf063a9\", \"name\": \"GRP_PC_ADM_DSI\"}], \"tenant\": \"TENANT\"}"
  },
  "expected": {
    "message": "{\"log_type\": \"alert\", \"maturity\": \"stable\", \"alert_unique_id\": \"16e26085-d8ef-4b3a-a6f7-5065144b8a22\", \"alert_time\": \"2025-09-26T15:13:32.242+00:00\", \"@timestamp\": \"2025-09-26T15:13:32.381130+00:00\", \"ingestion_date\": \"2025-09-26T15:13:32.242+00:00\", \"@event_create_date\": \"2025-09-26T15:13:32.194Z\", \"detection_date\": \"2025-09-26T15:13:32.194+00:00\", \"rule_name\": \"HarfangLab Antivirus Scan: Trojan.JS.Spy\", \"msg\": \"File flagged as malicious by HarfangLab Antivirus scan\", \"type\": \"rtlogs\", \"alert_subtype\": \"antivirus\", \"alert_type\": \"hurukaiav\", \"status\": \"new\", \"level\": \"high\", \"level_int\": 40, \"execution\": 0, \"quarantine\": 4, \"detection\": {\"file_path\": \"C:\\\\Users\\\\johndoe.EXAMPLE\\\\AppData\\\\Local\\\\Mozilla\\\\Firefox\\\\Profiles\\\\PROFILE.default\\\\cache2\\\\entries\\\\AC61350006C184CB17DF3321F95D0249DBDB53F3\", \"file_hashes\": {\"md5\": \"3f2ad37247e7b5c227908df0faf082bb\", \"sha1\": \"5929f57743ee1029e3f4d6d2b2721d8fb76c25df\", \"sha256\": \"d8bd228fb6d718be222069a7f128682f5d76f40b9689bbf068a57c1545dff636\"}}, \"job_id\": \"49218f2f-3981-4f0a-ad1d-bfa38cceef06\", \"agent\": {\"agentid\": \"125aacfd-cafd-4d0c-8497-9a3119795a47\", \"hostname\": \"OP066M05\", \"ostype\": \"windows\", \"osproducttype\": \"Windows 11 Pro\", \"osversion\": \"10.0.22000\", \"domainname\": \"EXAMPLE\", \"dnsdomainname\": \"example.local\", \"version\": \"4.13.24\", \"additional_info\": {}}, \"detection_origin\": \"agent\", \"status_history\": [{\"timestamp\": \"2025-09-26T15:13:32.243+00:00\", \"action\": \"created\"}], \"av_detection_details\": {\"signature_name\": \"Trojan.JS.Spy\", \"signature_id\": 3853211, \"kind\": \"scan\", \"path\": \"C:\\\\Users\\\\johndoe.EXAMPLE\\\\AppData\\\\Local\\\\Mozilla\\\\Firefox\\\\Profiles\\\\PROFILE.default\\\\cache2\\\\entries\\\\AC61350006C184CB17DF3321F95D0249DBDB53F3\", \"hashes\": {\"md5\": \"3f2ad37247e7b5c227908df0faf082bb\", \"sha1\": \"5929f57743ee1029e3f4d6d2b2721d8fb76c25df\", \"sha256\": \"d8bd228fb6d718be222069a7f128682f5d76f40b9689bbf068a57c1545dff636\"}, \"file_type\": \"unknown\", \"file_size\": 399151}, \"threat_type\": \"agent_rule\", \"threat_values\": [\"125aacfd-cafd-4d0c-8497-9a3119795a47\", \"HarfangLab Antivirus Scan: Trojan.JS.Spy\"], \"threat_key\": \"efb493dd-5087-4e41-8ddb-670fe3f98de8\", \"rule_id\": \"HarfangLab Antivirus Scan: Trojan.JS.Spy\", \"groups\": [{\"id\": \"7248a5c0-096d-4680-b552-75abdbf063a9\", \"name\": \"GRP_PC_ADM_DSI\"}], \"tenant\": \"TENANT\"}",
    "event": {
      "category": [
        "malware"
      ],
      "dataset": "alert",
      "kind": "alert",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-09-26T15:13:32.194000Z",
    "agent": {
      "id": "125aacfd-cafd-4d0c-8497-9a3119795a47",
      "name": "harfanglab"
    },
    "file": {
      "directory": "C:\\Users\\johndoe.EXAMPLE\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\PROFILE.default\\cache2\\entries",
      "hash": {
        "md5": "3f2ad37247e7b5c227908df0faf082bb",
        "sha1": "5929f57743ee1029e3f4d6d2b2721d8fb76c25df",
        "sha256": "d8bd228fb6d718be222069a7f128682f5d76f40b9689bbf068a57c1545dff636"
      },
      "name": "AC61350006C184CB17DF3321F95D0249DBDB53F3",
      "path": "C:\\Users\\johndoe.EXAMPLE\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\PROFILE.default\\cache2\\entries\\AC61350006C184CB17DF3321F95D0249DBDB53F3",
      "size": 399151
    },
    "harfanglab": {
      "alert_subtype": "antivirus",
      "alert_time": "2025-09-26T15:13:32.242+00:00",
      "alert_unique_id": "16e26085-d8ef-4b3a-a6f7-5065144b8a22",
      "av": {
        "detection": {
          "file_type": "unknown",
          "kind": "scan",
          "signature_id": "3853211",
          "signature_name": "Trojan.JS.Spy"
        }
      },
      "execution": 0,
      "groups": [
        "{\"id\":\"7248a5c0-096d-4680-b552-75abdbf063a9\",\"name\":\"GRP_PC_ADM_DSI\"}"
      ],
      "level": "high",
      "status": "new",
      "threat_key": "efb493dd-5087-4e41-8ddb-670fe3f98de8"
    },
    "host": {
      "domain": "EXAMPLE",
      "hostname": "OP066M05",
      "name": "OP066M05",
      "os": {
        "full": "Windows 11 Pro",
        "type": "windows",
        "version": "10.0.22000"
      }
    },
    "log": {
      "hostname": "OP066M05"
    },
    "organization": {
      "id": "TENANT"
    },
    "related": {
      "hash": [
        "3f2ad37247e7b5c227908df0faf082bb",
        "5929f57743ee1029e3f4d6d2b2721d8fb76c25df",
        "d8bd228fb6d718be222069a7f128682f5d76f40b9689bbf068a57c1545dff636"
      ],
      "hosts": [
        "OP066M05"
      ]
    },
    "rule": {
      "category": "hurukaiav",
      "description": "File flagged as malicious by HarfangLab Antivirus scan",
      "id": "HarfangLab Antivirus Scan: Trojan.JS.Spy",
      "name": "HarfangLab Antivirus Scan: Trojan.JS.Spy"
    },
    "user": {
      "roles": "GRP_PC_ADM_DSI"
    }
  }
}