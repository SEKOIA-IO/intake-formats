{
  "input": {
    "message": "{\"event_data\":{\"SubjectLogonId\":\"0x3e7\",\"SubjectDomainName\":\"EXAMPLE\",\"ClientProcessId\":\"9380\",\"SubjectUserName\":\"JDOE$\",\"ParentProcessId\":\"4432\",\"SubjectUserSid\":\"S-1-5-18\",\"RpcCallClientLocality\":\"0\",\"FQDN\":\"jdoe.example.local\",\"ClientProcessStartKey\":\"11111111111111111\",\"TaskContent\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-16\\\"?>\\r\\n<Task version=\\\"1.3\\\" xmlns=\\\"http://schemas.microsoft.com/windows/2004/02/mit/task\\\">\\r\\n  <RegistrationInfo>\\r\\n    <Date>2017-01-01T00:00:00</Date>\\r\\n    <Author>Microsoft Office</Author>\\r\\n    <Version>16.0.0</Version>\\r\\n    <Description>This task ensures that your Microsoft Office installation can check for feature updates.</Description>\\r\\n    <URI>\\\\Microsoft\\\\Office\\\\Office Feature Updates</URI>\\r\\n  </RegistrationInfo>\\r\\n  <Triggers>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T02:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T06:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T10:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T14:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T18:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T22:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n  </Triggers>\\r\\n  <Principals>\\r\\n    <Principal id=\\\"Author\\\">\\r\\n      <GroupId>S-1-5-22-111</GroupId>\\r\\n      <RunLevel>LeastPrivilege</RunLevel>\\r\\n    </Principal>\\r\\n  </Principals>\\r\\n  <Settings>\\r\\n    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\\r\\n    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>\\r\\n    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\\r\\n    <AllowHardTerminate>true</AllowHardTerminate>\\r\\n    <StartWhenAvailable>false</StartWhenAvailable>\\r\\n    <RunOnlyIfNetworkAvailable>true</RunOnlyIfNetworkAvailable>\\r\\n    <IdleSettings>\\r\\n      <StopOnIdleEnd>false</StopOnIdleEnd>\\r\\n      <RestartOnIdle>false</RestartOnIdle>\\r\\n    </IdleSettings>\\r\\n    <AllowStartOnDemand>true</AllowStartOnDemand>\\r\\n    <Enabled>true</Enabled>\\r\\n    <Hidden>false</Hidden>\\r\\n    <RunOnlyIfIdle>false</RunOnlyIfIdle>\\r\\n    <DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession>\\r\\n    <UseUnifiedSchedulingEngine>true</UseUnifiedSchedulingEngine>\\r\\n    <WakeToRun>false</WakeToRun>\\r\\n    <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n    <Priority>7</Priority>\\r\\n  </Setting\",\"TaskName\":\"\\\\Microsoft\\\\Office\\\\Office Feature Updates\"},\"groups\":[],\"type\":\"wineventlog\",\"computer_name\":\"jdoe.example.local\",\"destination\":\"syslog\",\"record_number\":2096523,\"@version\":\"1\",\"log_name\":\"Security\",\"@event_create_date\":\"2024-11-05T10:45:10.653Z\",\"level\":\"log_always\",\"@timestamp\":\"2024-11-05T10:44:50.472453021Z\",\"process_id\":784,\"user_data\":{},\"log_type\":\"eventlog\",\"keywords\":[\"AuditSuccess\",\"ReservedKeyword63\"],\"user\":{\"domain\":\"\",\"identifier\":\"\",\"name\":\"\",\"type\":\"unknown\"},\"tenant\":\"1111111111111111\",\"thread_id\":1892,\"agent\":{\"dnsdomainname\":\"example.local\",\"osproducttype\":\"Windows 10 Pro\",\"domain\":null,\"osversion\":\"10.0.19045\",\"ostype\":\"windows\",\"distroid\":null,\"domainname\":\"EXAMPLE\",\"additional_info\":{},\"version\":\"4.1.6\",\"hostname\":\"JDOE\",\"agentid\":\"00000000-0000-0000-0000-000000000000\"},\"event_id\":4698,\"provider_guid\":\"54849625-5478-4994-a5ba-3e3b0328c30d\",\"source_name\":\"Microsoft-Windows-Security-Auditing\"}\n",
    "sekoiaio": {
      "intake": {
        "dialect": "HarfangLab EDR",
        "dialect_uuid": "3c7057d3-4689-4fae-8033-6f1f887a70f2"
      }
    }
  },
  "expected": {
    "message": "{\"event_data\":{\"SubjectLogonId\":\"0x3e7\",\"SubjectDomainName\":\"EXAMPLE\",\"ClientProcessId\":\"9380\",\"SubjectUserName\":\"JDOE$\",\"ParentProcessId\":\"4432\",\"SubjectUserSid\":\"S-1-5-18\",\"RpcCallClientLocality\":\"0\",\"FQDN\":\"jdoe.example.local\",\"ClientProcessStartKey\":\"11111111111111111\",\"TaskContent\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-16\\\"?>\\r\\n<Task version=\\\"1.3\\\" xmlns=\\\"http://schemas.microsoft.com/windows/2004/02/mit/task\\\">\\r\\n  <RegistrationInfo>\\r\\n    <Date>2017-01-01T00:00:00</Date>\\r\\n    <Author>Microsoft Office</Author>\\r\\n    <Version>16.0.0</Version>\\r\\n    <Description>This task ensures that your Microsoft Office installation can check for feature updates.</Description>\\r\\n    <URI>\\\\Microsoft\\\\Office\\\\Office Feature Updates</URI>\\r\\n  </RegistrationInfo>\\r\\n  <Triggers>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T02:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T06:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T10:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T14:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T18:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n    <CalendarTrigger>\\r\\n      <StartBoundary>2017-01-01T22:10:00</StartBoundary>\\r\\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n      <Enabled>true</Enabled>\\r\\n      <RandomDelay>PT4H</RandomDelay>\\r\\n      <ScheduleByDay>\\r\\n        <DaysInterval>1</DaysInterval>\\r\\n      </ScheduleByDay>\\r\\n    </CalendarTrigger>\\r\\n  </Triggers>\\r\\n  <Principals>\\r\\n    <Principal id=\\\"Author\\\">\\r\\n      <GroupId>S-1-5-22-111</GroupId>\\r\\n      <RunLevel>LeastPrivilege</RunLevel>\\r\\n    </Principal>\\r\\n  </Principals>\\r\\n  <Settings>\\r\\n    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\\r\\n    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>\\r\\n    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\\r\\n    <AllowHardTerminate>true</AllowHardTerminate>\\r\\n    <StartWhenAvailable>false</StartWhenAvailable>\\r\\n    <RunOnlyIfNetworkAvailable>true</RunOnlyIfNetworkAvailable>\\r\\n    <IdleSettings>\\r\\n      <StopOnIdleEnd>false</StopOnIdleEnd>\\r\\n      <RestartOnIdle>false</RestartOnIdle>\\r\\n    </IdleSettings>\\r\\n    <AllowStartOnDemand>true</AllowStartOnDemand>\\r\\n    <Enabled>true</Enabled>\\r\\n    <Hidden>false</Hidden>\\r\\n    <RunOnlyIfIdle>false</RunOnlyIfIdle>\\r\\n    <DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession>\\r\\n    <UseUnifiedSchedulingEngine>true</UseUnifiedSchedulingEngine>\\r\\n    <WakeToRun>false</WakeToRun>\\r\\n    <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\\r\\n    <Priority>7</Priority>\\r\\n  </Setting\",\"TaskName\":\"\\\\Microsoft\\\\Office\\\\Office Feature Updates\"},\"groups\":[],\"type\":\"wineventlog\",\"computer_name\":\"jdoe.example.local\",\"destination\":\"syslog\",\"record_number\":2096523,\"@version\":\"1\",\"log_name\":\"Security\",\"@event_create_date\":\"2024-11-05T10:45:10.653Z\",\"level\":\"log_always\",\"@timestamp\":\"2024-11-05T10:44:50.472453021Z\",\"process_id\":784,\"user_data\":{},\"log_type\":\"eventlog\",\"keywords\":[\"AuditSuccess\",\"ReservedKeyword63\"],\"user\":{\"domain\":\"\",\"identifier\":\"\",\"name\":\"\",\"type\":\"unknown\"},\"tenant\":\"1111111111111111\",\"thread_id\":1892,\"agent\":{\"dnsdomainname\":\"example.local\",\"osproducttype\":\"Windows 10 Pro\",\"domain\":null,\"osversion\":\"10.0.19045\",\"ostype\":\"windows\",\"distroid\":null,\"domainname\":\"EXAMPLE\",\"additional_info\":{},\"version\":\"4.1.6\",\"hostname\":\"JDOE\",\"agentid\":\"00000000-0000-0000-0000-000000000000\"},\"event_id\":4698,\"provider_guid\":\"54849625-5478-4994-a5ba-3e3b0328c30d\",\"source_name\":\"Microsoft-Windows-Security-Auditing\"}\n",
    "event": {
      "code": "4698",
      "dataset": "eventlog",
      "provider": "Microsoft-Windows-Security-Auditing",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2024-11-05T10:45:10.653000Z",
    "action": {
      "id": 4698,
      "properties": {
        "ClientProcessId": "9380",
        "ClientProcessStartKey": "11111111111111111",
        "FQDN": "jdoe.example.local",
        "ParentProcessId": "4432",
        "RpcCallClientLocality": "0",
        "SubjectDomainName": "EXAMPLE",
        "SubjectLogonId": "0x3e7",
        "SubjectUserName": "JDOE$",
        "SubjectUserSid": "S-1-5-18",
        "TaskContent": "<?xml version=\"1.0\" encoding=\"UTF-16\"?>\r\n<Task version=\"1.3\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\r\n  <RegistrationInfo>\r\n    <Date>2017-01-01T00:00:00</Date>\r\n    <Author>Microsoft Office</Author>\r\n    <Version>16.0.0</Version>\r\n    <Description>This task ensures that your Microsoft Office installation can check for feature updates.</Description>\r\n    <URI>\\Microsoft\\Office\\Office Feature Updates</URI>\r\n  </RegistrationInfo>\r\n  <Triggers>\r\n    <CalendarTrigger>\r\n      <StartBoundary>2017-01-01T02:10:00</StartBoundary>\r\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\r\n      <Enabled>true</Enabled>\r\n      <RandomDelay>PT4H</RandomDelay>\r\n      <ScheduleByDay>\r\n        <DaysInterval>1</DaysInterval>\r\n      </ScheduleByDay>\r\n    </CalendarTrigger>\r\n    <CalendarTrigger>\r\n      <StartBoundary>2017-01-01T06:10:00</StartBoundary>\r\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\r\n      <Enabled>true</Enabled>\r\n      <RandomDelay>PT4H</RandomDelay>\r\n      <ScheduleByDay>\r\n        <DaysInterval>1</DaysInterval>\r\n      </ScheduleByDay>\r\n    </CalendarTrigger>\r\n    <CalendarTrigger>\r\n      <StartBoundary>2017-01-01T10:10:00</StartBoundary>\r\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\r\n      <Enabled>true</Enabled>\r\n      <RandomDelay>PT4H</RandomDelay>\r\n      <ScheduleByDay>\r\n        <DaysInterval>1</DaysInterval>\r\n      </ScheduleByDay>\r\n    </CalendarTrigger>\r\n    <CalendarTrigger>\r\n      <StartBoundary>2017-01-01T14:10:00</StartBoundary>\r\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\r\n      <Enabled>true</Enabled>\r\n      <RandomDelay>PT4H</RandomDelay>\r\n      <ScheduleByDay>\r\n        <DaysInterval>1</DaysInterval>\r\n      </ScheduleByDay>\r\n    </CalendarTrigger>\r\n    <CalendarTrigger>\r\n      <StartBoundary>2017-01-01T18:10:00</StartBoundary>\r\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\r\n      <Enabled>true</Enabled>\r\n      <RandomDelay>PT4H</RandomDelay>\r\n      <ScheduleByDay>\r\n        <DaysInterval>1</DaysInterval>\r\n      </ScheduleByDay>\r\n    </CalendarTrigger>\r\n    <CalendarTrigger>\r\n      <StartBoundary>2017-01-01T22:10:00</StartBoundary>\r\n      <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\r\n      <Enabled>true</Enabled>\r\n      <RandomDelay>PT4H</RandomDelay>\r\n      <ScheduleByDay>\r\n        <DaysInterval>1</DaysInterval>\r\n      </ScheduleByDay>\r\n    </CalendarTrigger>\r\n  </Triggers>\r\n  <Principals>\r\n    <Principal id=\"Author\">\r\n      <GroupId>S-1-5-22-111</GroupId>\r\n      <RunLevel>LeastPrivilege</RunLevel>\r\n    </Principal>\r\n  </Principals>\r\n  <Settings>\r\n    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\r\n    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>\r\n    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\r\n    <AllowHardTerminate>true</AllowHardTerminate>\r\n    <StartWhenAvailable>false</StartWhenAvailable>\r\n    <RunOnlyIfNetworkAvailable>true</RunOnlyIfNetworkAvailable>\r\n    <IdleSettings>\r\n      <StopOnIdleEnd>false</StopOnIdleEnd>\r\n      <RestartOnIdle>false</RestartOnIdle>\r\n    </IdleSettings>\r\n    <AllowStartOnDemand>true</AllowStartOnDemand>\r\n    <Enabled>true</Enabled>\r\n    <Hidden>false</Hidden>\r\n    <RunOnlyIfIdle>false</RunOnlyIfIdle>\r\n    <DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession>\r\n    <UseUnifiedSchedulingEngine>true</UseUnifiedSchedulingEngine>\r\n    <WakeToRun>false</WakeToRun>\r\n    <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\r\n    <Priority>7</Priority>\r\n  </Setting",
        "TaskName": "\\Microsoft\\Office\\Office Feature Updates"
      }
    },
    "agent": {
      "id": "00000000-0000-0000-0000-000000000000",
      "name": "harfanglab"
    },
    "harfanglab": {
      "groups": []
    },
    "host": {
      "domain": "EXAMPLE",
      "hostname": "JDOE",
      "name": "JDOE",
      "os": {
        "full": "Windows 10 Pro",
        "version": "10.0.19045"
      }
    },
    "log": {
      "hostname": "JDOE"
    },
    "organization": {
      "id": "1111111111111111"
    },
    "related": {
      "hosts": [
        "JDOE"
      ],
      "user": [
        "JDOE$"
      ]
    },
    "user": {
      "domain": "EXAMPLE",
      "name": "JDOE$"
    }
  }
}