{
  "input": {
    "message": "{\"@event_create_date\": \"2026-01-13T09:07:10.405241Z\", \"@timestamp\": \"2026-01-13T09:07:10.535034+00:00\", \"agent\": {\"additional_info\": {}, \"agentid\": \"22222222-2222-2222-2222-222222222222\", \"dnsdomainname\": \"example.local\", \"domainname\": \"EXAMPLE\", \"hostname\": \"HOSTNAME\", \"ipaddress\": \"1.1.1.1\", \"osproducttype\": \"Windows 11 Pro\", \"ostype\": \"windows\", \"osversion\": \"10.0.26100\", \"producttype\": \"workstation\", \"version\": \"5.2.24\"}, \"alert_subtype\": \"firewall_self_protection\", \"alert_time\": \"2026-01-13T09:07:10.405241Z\", \"alert_type\": \"selfprotection\", \"alert_unique_id\": \"33333333-3333-3333-3333-333333333333\", \"detection\": {}, \"detection_date\": \"2026-01-13T09:07:08.741140Z\", \"detection_origin\": \"agent\", \"detection_timestamp\": \"2026-01-13T09:07:08.741140Z\", \"execution\": 4, \"firewall_self_protection\": {\"eventtime_datetime\": \"2026-01-13T09:07:08.736526Z\", \"filter_description\": \"This is the default outbound filter which blocks or permits traffic based on user configured default settings\", \"filter_id\": 271734, \"filter_name\": \"Default Outbound\", \"provider_description\": \"Fournisseur de pare-feu Windows pour Microsoft Windows WFP int\\u00e9gr\\u00e9.\", \"provider_name\": \"Microsoft Corporation\", \"provider_service_name\": \"mpssvc\"}, \"ingestion_date\": \"2026-01-13T09:07:10.405241Z\", \"level\": \"critical\", \"level_int\": 50, \"log_type\": \"alert\", \"maturity\": \"stable\", \"mitre_cells\": [\"defense-evasion__t1562.006\"], \"msg\": \"This security event is triggered when a firewall rule that disrupts the agent's communication with the backend is detected and removed.\\n        Alerts, telemetry and rules cannot be reported or updated if the agent is unable to communicate with the backend, making communication a critical component of the EDR.\\n        Attackers may attempt to deny these by creating a Windows firewall rule that prevents the Hurukai process from initiating a connection to the backend.\", \"quarantine\": 4, \"rule_id\": \"11111111-1111-1111-1111-111111111111\", \"rule_name\": \"Firewall Rule Blocking Agent Communication Detected and Removed\", \"status\": \"new\", \"status_history\": [{\"action\": \"created\", \"timestamp\": \"2026-01-13T09:07:10.405701Z\"}], \"tags\": [\"attack.defense_evasion\", \"attack.t1562.006\"], \"aggregation_key\": \"123456\", \"threat_type\": \"new\", \"threat_values\": [], \"threat_key\": \"44444444-4444-4444-4444-444444444444\", \"groups\": [{\"id\": \"55555555-5555-5555-5555-555555555555\", \"name\": \"EXAMPLE\"}], \"tenant\": \"REDACTED\"}"
  },
  "expected": {
    "message": "{\"@event_create_date\": \"2026-01-13T09:07:10.405241Z\", \"@timestamp\": \"2026-01-13T09:07:10.535034+00:00\", \"agent\": {\"additional_info\": {}, \"agentid\": \"22222222-2222-2222-2222-222222222222\", \"dnsdomainname\": \"example.local\", \"domainname\": \"EXAMPLE\", \"hostname\": \"HOSTNAME\", \"ipaddress\": \"1.1.1.1\", \"osproducttype\": \"Windows 11 Pro\", \"ostype\": \"windows\", \"osversion\": \"10.0.26100\", \"producttype\": \"workstation\", \"version\": \"5.2.24\"}, \"alert_subtype\": \"firewall_self_protection\", \"alert_time\": \"2026-01-13T09:07:10.405241Z\", \"alert_type\": \"selfprotection\", \"alert_unique_id\": \"33333333-3333-3333-3333-333333333333\", \"detection\": {}, \"detection_date\": \"2026-01-13T09:07:08.741140Z\", \"detection_origin\": \"agent\", \"detection_timestamp\": \"2026-01-13T09:07:08.741140Z\", \"execution\": 4, \"firewall_self_protection\": {\"eventtime_datetime\": \"2026-01-13T09:07:08.736526Z\", \"filter_description\": \"This is the default outbound filter which blocks or permits traffic based on user configured default settings\", \"filter_id\": 271734, \"filter_name\": \"Default Outbound\", \"provider_description\": \"Fournisseur de pare-feu Windows pour Microsoft Windows WFP int\\u00e9gr\\u00e9.\", \"provider_name\": \"Microsoft Corporation\", \"provider_service_name\": \"mpssvc\"}, \"ingestion_date\": \"2026-01-13T09:07:10.405241Z\", \"level\": \"critical\", \"level_int\": 50, \"log_type\": \"alert\", \"maturity\": \"stable\", \"mitre_cells\": [\"defense-evasion__t1562.006\"], \"msg\": \"This security event is triggered when a firewall rule that disrupts the agent's communication with the backend is detected and removed.\\n        Alerts, telemetry and rules cannot be reported or updated if the agent is unable to communicate with the backend, making communication a critical component of the EDR.\\n        Attackers may attempt to deny these by creating a Windows firewall rule that prevents the Hurukai process from initiating a connection to the backend.\", \"quarantine\": 4, \"rule_id\": \"11111111-1111-1111-1111-111111111111\", \"rule_name\": \"Firewall Rule Blocking Agent Communication Detected and Removed\", \"status\": \"new\", \"status_history\": [{\"action\": \"created\", \"timestamp\": \"2026-01-13T09:07:10.405701Z\"}], \"tags\": [\"attack.defense_evasion\", \"attack.t1562.006\"], \"aggregation_key\": \"123456\", \"threat_type\": \"new\", \"threat_values\": [], \"threat_key\": \"44444444-4444-4444-4444-444444444444\", \"groups\": [{\"id\": \"55555555-5555-5555-5555-555555555555\", \"name\": \"EXAMPLE\"}], \"tenant\": \"REDACTED\"}",
    "event": {
      "dataset": "alert",
      "kind": "alert"
    },
    "@timestamp": "2026-01-13T09:07:10.405241Z",
    "agent": {
      "id": "22222222-2222-2222-2222-222222222222",
      "name": "harfanglab"
    },
    "harfanglab": {
      "aggregation_key": "123456",
      "alert_subtype": "firewall_self_protection",
      "alert_time": "2026-01-13T09:07:10.405241Z",
      "alert_unique_id": "33333333-3333-3333-3333-333333333333",
      "execution": 4,
      "firewall_self_protection": {
        "filter_description": "This is the default outbound filter which blocks or permits traffic based on user configured default settings",
        "filter_id": "271734",
        "filter_name": "Default Outbound",
        "provider_description": "Fournisseur de pare-feu Windows pour Microsoft Windows WFP int\u00e9gr\u00e9.",
        "provider_name": "Microsoft Corporation",
        "provider_service_name": "mpssvc"
      },
      "groups": [
        "{\"id\":\"55555555-5555-5555-5555-555555555555\",\"name\":\"EXAMPLE\"}"
      ],
      "level": "critical",
      "quarantine_label": "NO_ACTION",
      "status": "new",
      "threat_key": "44444444-4444-4444-4444-444444444444"
    },
    "host": {
      "domain": "EXAMPLE",
      "hostname": "HOSTNAME",
      "ip": [
        "1.1.1.1"
      ],
      "name": "HOSTNAME",
      "os": {
        "full": "Windows 11 Pro",
        "type": "windows",
        "version": "10.0.26100"
      }
    },
    "log": {
      "hostname": "HOSTNAME"
    },
    "organization": {
      "id": "REDACTED"
    },
    "related": {
      "hosts": [
        "HOSTNAME"
      ],
      "ip": [
        "1.1.1.1"
      ]
    },
    "rule": {
      "category": "selfprotection",
      "description": "This security event is triggered when a firewall rule that disrupts the agent's communication with the backend is detected and removed.\n        Alerts, telemetry and rules cannot be reported or updated if the agent is unable to communicate with the backend, making communication a critical component of the EDR.\n        Attackers may attempt to deny these by creating a Windows firewall rule that prevents the Hurukai process from initiating a connection to the backend.",
      "id": "11111111-1111-1111-1111-111111111111",
      "name": "Firewall Rule Blocking Agent Communication Detected and Removed"
    },
    "user": {
      "roles": "EXAMPLE"
    }
  }
}