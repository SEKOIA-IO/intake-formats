{
  "input": {
    "message": "{\"grandparent_integrity_level\":\"System\",\"session\":0,\"fake_parent_commandline\":\"\",\"pe_timestamp\":\"2045-04-24T02:29:30.000Z\",\"groups\":[{\"name\":\"test_group\",\"id\":\"ba55eacf-12b7-4529-abcb-fd750e344aaa\"}],\"integrity_level\":\"System\",\"signature_info\":{\"signed_authenticode\":false,\"signer_info\":{\"issuer_name\":\"Microsoft Windows ISSUER\",\"thumbprint\":\"15555555555155555555155555\",\"display_name\":\"Microsoft Windows\",\"thumbprint_sha256\":\"1888888881888888881888888888\",\"serial_number\":\"33000004158295a1a3d\"},\"root_info\":{\"issuer_name\":\"Microsoft_issuer_name\",\"thumbprint\":\"3b1efd3a66ea28b166973947\",\"display_name\":\"Microsoft_display_name\",\"thumbprint_sha256\":\"df545bf919a2439c36983b54cdfc\",\"serial_number\":\"28cc3a25bfba44ac\"},\"signed_catalog\":true},\"size\":94208,\"pe_imphash\":\"803254E010814E6\",\"tenant\":\"6685e1111111\",\"fake_ppid\":0,\"@timestamp\":\"2023-12-19T17:18:14.056604Z\",\"pe_info\":{\"internal_name\":\"test.exe\",\"pe_timestamp\":\"2045-04-24T02:29:30.000Z\",\"product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"company_name\":\"Microsoft Corporation\",\"legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"product_version\":\"10.0.22000.1\",\"file_version\":\"10.0.22000.1\",\"original_filename\":\"test_filename.exe\",\"file_description\":\"Test description\"},\"log_platform_flag\":0,\"@event_create_date\":\"2023-12-19T17:17:47.639Z\",\"process_unique_id\":\"4e8318da-daab-428a-600dc\",\"grandparent_image\":\"C:\\\\Windows\\\\grandparent_image.exe\",\"hashes\":{\"sha1\":\"7d4736b3906e6b991f1070b07\",\"md5\":\"7654e408563f6a4150171dd38\",\"sha256\":\"8a5410d1a08fcc5cf03b9ce98e62e0049e\"},\"image_name\":\"C:\\\\Windows\\\\test.exe\",\"parent_unique_id\":\"4e8318da-daab-428a-d020-00f15\",\"process_name\":\"test_process.exe\",\"username\":\"TST USER\\\\SYSTEM\",\"usersid\":\"0-0-1-1\",\"signed\":true,\"parent_image\":\"C:\\\\Windows\\\\test1.exe\",\"pid\":3434,\"ppid\":8888,\"ancestors\":\"C:\\\\Windows\\\\test.exe|C:\\\\Windows\\\\test1.exe|C:\\\\Windows\\\\test2.exe|C:\\\\Windows\\\\test3.exe\",\"commandline\":\"test1 query type= service\",\"parent_integrity_level\":\"System\",\"fake_parent_image\":\"\",\"pe_timestamp_int\":2376613770,\"current_directory\":\"C:\\\\Windows\",\"@version\":\"1\",\"grandparent_commandline\":\"C:\\\\Windows\\\\grandparent_commandline.exe -sLTService\",\"log_type\":\"process\",\"logonid\":999,\"parent_commandline\":\"test.exe -p -e test_script.py | find test\",\"agent\":{\"agentid\":\"d7e1cf40-daab\",\"hostname\":\"jdoe\",\"osversion\":\"1.1.1\",\"distroid\":null,\"dnsdomainname\":\"TST.test\",\"ostype\":\"windows\",\"osproducttype\":\"Windows 11 Pro\",\"version\":\"3.2.5\",\"domain\":null,\"additional_info\":null,\"domainname\":\"TST\"}}"
  },
  "expected": {
    "message": "{\"grandparent_integrity_level\":\"System\",\"session\":0,\"fake_parent_commandline\":\"\",\"pe_timestamp\":\"2045-04-24T02:29:30.000Z\",\"groups\":[{\"name\":\"test_group\",\"id\":\"ba55eacf-12b7-4529-abcb-fd750e344aaa\"}],\"integrity_level\":\"System\",\"signature_info\":{\"signed_authenticode\":false,\"signer_info\":{\"issuer_name\":\"Microsoft Windows ISSUER\",\"thumbprint\":\"15555555555155555555155555\",\"display_name\":\"Microsoft Windows\",\"thumbprint_sha256\":\"1888888881888888881888888888\",\"serial_number\":\"33000004158295a1a3d\"},\"root_info\":{\"issuer_name\":\"Microsoft_issuer_name\",\"thumbprint\":\"3b1efd3a66ea28b166973947\",\"display_name\":\"Microsoft_display_name\",\"thumbprint_sha256\":\"df545bf919a2439c36983b54cdfc\",\"serial_number\":\"28cc3a25bfba44ac\"},\"signed_catalog\":true},\"size\":94208,\"pe_imphash\":\"803254E010814E6\",\"tenant\":\"6685e1111111\",\"fake_ppid\":0,\"@timestamp\":\"2023-12-19T17:18:14.056604Z\",\"pe_info\":{\"internal_name\":\"test.exe\",\"pe_timestamp\":\"2045-04-24T02:29:30.000Z\",\"product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"company_name\":\"Microsoft Corporation\",\"legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"product_version\":\"10.0.22000.1\",\"file_version\":\"10.0.22000.1\",\"original_filename\":\"test_filename.exe\",\"file_description\":\"Test description\"},\"log_platform_flag\":0,\"@event_create_date\":\"2023-12-19T17:17:47.639Z\",\"process_unique_id\":\"4e8318da-daab-428a-600dc\",\"grandparent_image\":\"C:\\\\Windows\\\\grandparent_image.exe\",\"hashes\":{\"sha1\":\"7d4736b3906e6b991f1070b07\",\"md5\":\"7654e408563f6a4150171dd38\",\"sha256\":\"8a5410d1a08fcc5cf03b9ce98e62e0049e\"},\"image_name\":\"C:\\\\Windows\\\\test.exe\",\"parent_unique_id\":\"4e8318da-daab-428a-d020-00f15\",\"process_name\":\"test_process.exe\",\"username\":\"TST USER\\\\SYSTEM\",\"usersid\":\"0-0-1-1\",\"signed\":true,\"parent_image\":\"C:\\\\Windows\\\\test1.exe\",\"pid\":3434,\"ppid\":8888,\"ancestors\":\"C:\\\\Windows\\\\test.exe|C:\\\\Windows\\\\test1.exe|C:\\\\Windows\\\\test2.exe|C:\\\\Windows\\\\test3.exe\",\"commandline\":\"test1 query type= service\",\"parent_integrity_level\":\"System\",\"fake_parent_image\":\"\",\"pe_timestamp_int\":2376613770,\"current_directory\":\"C:\\\\Windows\",\"@version\":\"1\",\"grandparent_commandline\":\"C:\\\\Windows\\\\grandparent_commandline.exe -sLTService\",\"log_type\":\"process\",\"logonid\":999,\"parent_commandline\":\"test.exe -p -e test_script.py | find test\",\"agent\":{\"agentid\":\"d7e1cf40-daab\",\"hostname\":\"jdoe\",\"osversion\":\"1.1.1\",\"distroid\":null,\"dnsdomainname\":\"TST.test\",\"ostype\":\"windows\",\"osproducttype\":\"Windows 11 Pro\",\"version\":\"3.2.5\",\"domain\":null,\"additional_info\":null,\"domainname\":\"TST\"}}",
    "event": {
      "category": [
        "process"
      ],
      "dataset": "process",
      "type": [
        "start"
      ]
    },
    "@timestamp": "2023-12-19T17:17:47.639000Z",
    "agent": {
      "id": "d7e1cf40-daab",
      "name": "harfanglab"
    },
    "file": {
      "hash": {
        "md5": "7654e408563f6a4150171dd38",
        "sha1": "7d4736b3906e6b991f1070b07",
        "sha256": "8a5410d1a08fcc5cf03b9ce98e62e0049e"
      },
      "name": "test_filename.exe"
    },
    "harfanglab": {
      "grandparent": {
        "process": {
          "ancestors": [
            "C:\\Windows\\test.exe",
            "C:\\Windows\\test1.exe",
            "C:\\Windows\\test2.exe",
            "C:\\Windows\\test3.exe"
          ],
          "command_line": "C:\\Windows\\grandparent_commandline.exe -sLTService",
          "executable": "C:\\Windows\\grandparent_image.exe"
        }
      },
      "groups": [
        "{\"id\":\"ba55eacf-12b7-4529-abcb-fd750e344aaa\",\"name\":\"test_group\"}"
      ]
    },
    "host": {
      "domain": "TST",
      "hostname": "jdoe",
      "name": "jdoe",
      "os": {
        "full": "Windows 11 Pro",
        "type": "windows",
        "version": "1.1.1"
      }
    },
    "log": {
      "hostname": "jdoe"
    },
    "organization": {
      "id": "6685e1111111"
    },
    "process": {
      "command_line": "test1 query type= service",
      "executable": "C:\\Windows\\test.exe",
      "name": "test_process.exe",
      "parent": {
        "command_line": "test.exe -p -e test_script.py | find test",
        "executable": "C:\\Windows\\test1.exe",
        "name": "test1.exe"
      },
      "pe": {
        "company": "Microsoft Corporation",
        "description": "Test description",
        "file_version": "10.0.22000.1",
        "imphash": "803254E010814E6",
        "original_file_name": "test_filename.exe",
        "product": "Microsoft\u00ae Windows\u00ae Operating System"
      },
      "pid": 3434,
      "working_directory": "C:\\Windows"
    },
    "related": {
      "hash": [
        "7654e408563f6a4150171dd38",
        "7d4736b3906e6b991f1070b07",
        "8a5410d1a08fcc5cf03b9ce98e62e0049e"
      ],
      "hosts": [
        "jdoe"
      ],
      "user": [
        "SYSTEM"
      ]
    },
    "user": {
      "domain": "TST USER",
      "name": "SYSTEM",
      "roles": "test_group"
    }
  }
}