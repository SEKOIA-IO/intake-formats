{
  "input": {
    "message": "{\"log_type\": \"alert\", \"maturity\": \"stable\", \"alert_unique_id\": \"4a89a09d-e689-4e19-b531-ef8239718f93\", \"alert_time\": \"2025-07-11T09:41:35.946+00:00\", \"@timestamp\": \"2025-07-11T09:41:36.010245+00:00\", \"ingestion_date\": \"2025-07-11T09:41:35.946+00:00\", \"@event_create_date\": \"2025-07-11T09:41:35.946+00:00\", \"detection_date\": null, \"rule_name\": \"Windows Application Logs Cleared\", \"rule_id\": \"a755c365-396a-4e7b-bbbe-d5c86d6e6ca9\", \"msg\": \"Detects when one of the Windows application logs is cleared.\\nWindows Event Logs are a record of a computer's alerts and notifications.\\nAdversaries may clear Windows Event Logs to hide the activity of an intrusion.\\nIt is recommended to investigate the process responsible for this action as well as to look for suspicious activities on the host preceding the clearing of the logs.\\n\", \"type\": \"rtlogs\", \"alert_subtype\": \"eventlog\", \"alert_type\": \"sigma\", \"status\": \"new\", \"level\": \"medium\", \"level_int\": 30, \"confidence\": \"weak\", \"confidence_int\": 100, \"execution\": 0, \"tags\": [\"attack.defense_evasion\", \"attack.t1070.001\", \"classification.windows.behavior.defenseevasion\", \"classification.windows.source.eventlog\"], \"mitre_cells\": [\"defense-evasion__t1070.001\"], \"agent\": {\"agentid\": \"63c5e4b1-93e8-48f4-8867-28cac80dc1de\", \"hostname\": \"HOSTNAME\", \"ostype\": \"windows\", \"osproducttype\": \"Windows 11 Pro\", \"osversion\": \"10.0.26100\", \"domainname\": \"DOMAIN\", \"dnsdomainname\": \"DOMAIN.example\", \"version\": \"4.9.42\", \"additional_info\": {}}, \"process\": {\"agent\": {\"agentid\": \"63c5e4b1-93e8-48f4-8867-28cac80dc1de\", \"hostname\": \"HOSTNAME\", \"domainname\": \"DOMAIN\", \"dnsdomainname\": \"DOMAIN.example\", \"ostype\": \"windows\", \"osversion\": \"10.0.26100\", \"osproducttype\": \"Windows 11 Pro\", \"version\": \"4.9.42\", \"additional_info\": {}, \"ipaddress\": \"1.2.3.4\", \"producttype\": \"workstation\"}, \"commandline\": \"C:\\\\WINDOWS\\\\system32\\\\mmc.exe C:\\\\WINDOWS\\\\system32\\\\eventvwr.msc /s\", \"@event_create_date\": \"2025-07-11T09:33:14.858Z\", \"create_time\": \"2025-07-11T09:33:14.858Z\", \"current_directory\": \"C:\\\\WINDOWS\\\\system32\\\\\", \"hashes\": {\"md5\": \"ee0838bcacf8612929fa8df155bcd566\", \"sha1\": \"fe6438fb27c8b4e3d23a3dd53907a245e79432b8\", \"sha256\": \"a2b5685e80f52320cc9d9f9c900256d9dee5e34a7774366a79454fe07d3de7d6\"}, \"image_name\": \"C:\\\\Windows\\\\System32\\\\mmc.exe\", \"log_type\": \"process\", \"parent_commandline\": \"C:\\\\WINDOWS\\\\explorer.exe /factory,{FBB92F10-E8F6-484D-8592-959AE518099E} -Embedding\", \"parent_image\": \"C:\\\\Windows\\\\explorer.exe\", \"parent_unique_id\": \"19b536c8-136f-48d1-bfba-15f1cb041fa3\", \"pid\": 12345, \"ppid\": 23224, \"process_name\": \"mmc.exe\", \"process_unique_id\": \"4303d6a5-c61e-459a-8b36-fd29da6f2205\", \"size\": 1888256, \"username\": \"DOMAIN\\\\example.pc\", \"grandparent_image\": \"C:\\\\Windows\\\\System32\\\\svchost.exe\", \"grandparent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\svchost.exe -k DcomLaunch -p\", \"grandparent_unique_id\": \"33178801-3ff6-431b-a2dc-e63d7aa6586f\", \"stacktrace\": \"\", \"stacktrace_minimal\": \"\", \"ancestors\": \"C:\\\\Windows\\\\explorer.exe|C:\\\\Windows\\\\System32\\\\svchost.exe|C:\\\\Windows\\\\System32\\\\services.exe|C:\\\\Windows\\\\System32\\\\wininit.exe\", \"usersid\": \"S-1-5-21-1111111111-2222222222-3333333333-44444\", \"integrity_level\": \"High\", \"session\": 1, \"logonid\": 1895598, \"parent_integrity_level\": \"Medium\", \"grandparent_integrity_level\": \"System\", \"fake_ppid\": 0, \"fake_parent_image\": \"\", \"fake_parent_commandline\": \"\", \"pe_info\": {\"company_name\": \"Microsoft Corporation\", \"file_description\": \"Microsoft Management Console\", \"file_version\": \"10.0.26100.4484 (WinBuild.160101.0800)\", \"internal_name\": \"mmc.exe\", \"legal_copyright\": \"\\u00a9 Microsoft Corporation. All rights reserved.\", \"original_filename\": \"mmc.exe\", \"pe_timestamp\": \"1980-01-05T04:16:12.000Z\", \"product_name\": \"Microsoft\\u00ae Windows\\u00ae Operating System\", \"product_version\": \"10.0.26100.4484\"}, \"signed\": true, \"signature_info\": {\"signer_info\": {\"serial_number\": \"33000004a882e6b8ac1c5d5ff00000000004a8\", \"thumbprint\": \"1128fd420e0ff7db46e49aacc2bbadfbf2682f11\", \"thumbprint_sha256\": \"ed1d43b97ab28b293b8970aaade6485c9c63f755cfc76cfcd396babf19dfe90c\", \"issuer_name\": \"Microsoft Windows Production PCA 2011\", \"display_name\": \"Microsoft Windows\"}, \"root_info\": {\"serial_number\": \"e9e2241b375cf2b00c88a71017f8ef59\", \"thumbprint\": \"4ec244017d04f3d536eb7984e536cd6dfcd9c257\", \"thumbprint_sha256\": \"96cf3454dd761137d54a834815a07b453e76044b2d6aa1e63492d3b06b0adc55\", \"issuer_name\": \"Microsoft Root Certificate Authority 2010\", \"display_name\": \"Microsoft Root Certificate Authority 2010\"}, \"signed_authenticode\": false, \"signed_catalog\": true}, \"pe_timestamp_int\": 315893772, \"pe_timestamp\": \"1980-01-05T04:16:12.000Z\", \"pe_imphash\": \"FBC54873445C23626874A833A2D17B32\"}, \"process_session\": {\"event_time\": \"2025-07-11T09:29:33.114121Z\", \"logon_id\": 1895598, \"source_hostname\": \"HOSTNAME\", \"source_ip\": \"127.0.0.1\", \"source_port\": 0, \"target_username\": \"example.pc\", \"target_domain\": \"DOMAIN\", \"target_sid\": \"S-1-5-21-1111111111-2222222222-3333333333-44444\", \"logon_type\": 11, \"authentication_package\": \"Negotiate\"}, \"eventlog\": {\"user\": {\"sid\": \"S-1-5-21-1111111111-2222222222-3333333333-44444\", \"name\": \"example.pc\", \"domain\": \"DOMAIN\", \"type\": 1}, \"keywords\": [\"ReservedKeyword63\"], \"event_data\": {}, \"user_data\": {\"ClientProcessStartKey\": \"1234567890\", \"ClientProcessId\": \"12345\", \"Channel\": \"Setup\", \"BackupPath\": \"\", \"xml_name\": \"LogFileCleared\", \"SubjectUserName\": \"example.pc\", \"SubjectDomainName\": \"DOMAIN\"}, \"event_id\": 104, \"record_number\": 8242, \"log_name\": \"System\", \"level\": 4, \"event_date\": \"2025-07-11T09:41:35.509323Z\", \"computer_name\": \"HOSTNAME.DOMAIN.example\", \"source_name\": \"Microsoft-Windows-Eventlog\", \"provider_guid\": {\"data\": \"PROVIDE_GUID\"}, \"process_id\": 4276, \"thread_id\": 17448, \"related_process_id\": 12345, \"related_process_unique_id\": {\"data\": \"UNIQUE_DATA\"}, \"related_process_image_path\": \"C:\\\\Windows\\\\System32\\\\mmc.exe\", \"agent\": null, \"groups\": null, \"log_type\": \"eventlog\", \"pid\": null, \"process_image_path\": null, \"process_unique_id\": null, \"type\": \"wineventlog\", \"sigma_rule_content\": \"title: Windows Application Logs Cleared\\nid: a755c365-396a-4e7b-bbbe-d5c86d6e6ca9\\ndescription: |\\n    Detects when one of the Windows application logs is cleared.\\n    Windows Event Logs are a record of a computer's alerts and notifications.\\n    Adversaries may clear Windows Event Logs to hide the activity of an intrusion.\\n    It is recommended to investigate the process responsible for this action as well as to look for suspicious activities on the host preceding the clearing of the logs.\\nreferences:\\n    - https://attack.mitre.org/techniques/T1070/001/\\ndate: 2021/04/27\\nmodified: 2025/05/09\\nauthor: HarfangLab\\ntags:\\n    - attack.defense_evasion\\n    - attack.t1070.001\\n    - classification.Windows.Source.EventLog\\n    - classification.Windows.Behavior.DefenseEvasion\\nlogsource:\\n    product: windows\\n    service: system\\ndetection:\\n    selection:\\n        EventID: 104\\n        Source: Microsoft-Windows-Eventlog\\n\\n    exclusion_channel:\\n        Channel:\\n            - 'ModemAuthenticatorLog'\\n            - 'Microsoft-Exchange-ManagedAvailability/ThrottlingConfig'\\n\\n    exclusion_ccleaner:\\n        - ProcessImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n        - ProcessParentImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n\\n    exclusion_atera:\\n        ProcessGrandparentImage: '?:\\\\Program Files\\\\ATERA Networks\\\\AteraAgent\\\\Packages\\\\AgentPackageSystemTools\\\\AgentPackageSystemTools.exe'\\n\\n    exclusion_citrix:\\n        ProcessParentImage: '?:\\\\Program Files (x86)\\\\Citrix\\\\Workspace Environment Management Agent\\\\Citrix.Wem.Agent.Service.exe'\\n\\n    exclusion_minint:\\n        ProcessGrandparentImage: '?:\\\\MININT\\\\Tools\\\\X64\\\\TsManager.exe'\\n\\n    exclusion_lenovo:\\n        ProcessGrandparentImage: '?:\\\\Program Files (x86)\\\\Lenovo\\\\LenovoWelcome\\\\x86\\\\LenovoWelcomeTask.exe'\\n\\n    condition: selection and not 1 of exclusion_*\\nlevel: medium\\nconfidence: weak\"}, \"detection_origin\": \"agent\", \"image_name\": \"C:\\\\Windows\\\\System32\\\\mmc.exe\", \"rule_content\": \"title: Windows Application Logs Cleared\\nid: a755c365-396a-4e7b-bbbe-d5c86d6e6ca9\\ndescription: |\\n    Detects when one of the Windows application logs is cleared.\\n    Windows Event Logs are a record of a computer's alerts and notifications.\\n    Adversaries may clear Windows Event Logs to hide the activity of an intrusion.\\n    It is recommended to investigate the process responsible for this action as well as to look for suspicious activities on the host preceding the clearing of the logs.\\nreferences:\\n    - https://attack.mitre.org/techniques/T1070/001/\\ndate: 2021/04/27\\nmodified: 2025/05/09\\nauthor: HarfangLab\\ntags:\\n    - attack.defense_evasion\\n    - attack.t1070.001\\n    - classification.Windows.Source.EventLog\\n    - classification.Windows.Behavior.DefenseEvasion\\nlogsource:\\n    product: windows\\n    service: system\\ndetection:\\n    selection:\\n        EventID: 104\\n        Source: Microsoft-Windows-Eventlog\\n\\n    exclusion_channel:\\n        Channel:\\n            - 'ModemAuthenticatorLog'\\n            - 'Microsoft-Exchange-ManagedAvailability/ThrottlingConfig'\\n\\n    exclusion_ccleaner:\\n        - ProcessImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n        - ProcessParentImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n\\n    exclusion_atera:\\n        ProcessGrandparentImage: '?:\\\\Program Files\\\\ATERA Networks\\\\AteraAgent\\\\Packages\\\\AgentPackageSystemTools\\\\AgentPackageSystemTools.exe'\\n\\n    exclusion_citrix:\\n        ProcessParentImage: '?:\\\\Program Files (x86)\\\\Citrix\\\\Workspace Environment Management Agent\\\\Citrix.Wem.Agent.Service.exe'\\n\\n    exclusion_minint:\\n        ProcessGrandparentImage: '?:\\\\MININT\\\\Tools\\\\X64\\\\TsManager.exe'\\n\\n    exclusion_lenovo:\\n        ProcessGrandparentImage: '?:\\\\Program Files (x86)\\\\Lenovo\\\\LenovoWelcome\\\\x86\\\\LenovoWelcomeTask.exe'\\n\\n    condition: selection and not 1 of exclusion_*\\nlevel: medium\\nconfidence: weak\", \"aggregation_key\": \"3c95f845193113e2ab23bbeb4118f1656113fade32536a43cee07384525ca5b0\", \"threat_type\": \"commandline\", \"threat_values\": [\"<drive>:\\\\windows\\\\system32\\\\mmc.exe <drive>:\\\\windows\\\\system32\\\\eventvwr.msc /s\"], \"threat_key\": \"91b4e881-6d4b-4bf4-b7d2-cbdf8731d26e\", \"groups\": [], \"tenant\": \"TENANT\"}"
  },
  "expected": {
    "message": "{\"log_type\": \"alert\", \"maturity\": \"stable\", \"alert_unique_id\": \"4a89a09d-e689-4e19-b531-ef8239718f93\", \"alert_time\": \"2025-07-11T09:41:35.946+00:00\", \"@timestamp\": \"2025-07-11T09:41:36.010245+00:00\", \"ingestion_date\": \"2025-07-11T09:41:35.946+00:00\", \"@event_create_date\": \"2025-07-11T09:41:35.946+00:00\", \"detection_date\": null, \"rule_name\": \"Windows Application Logs Cleared\", \"rule_id\": \"a755c365-396a-4e7b-bbbe-d5c86d6e6ca9\", \"msg\": \"Detects when one of the Windows application logs is cleared.\\nWindows Event Logs are a record of a computer's alerts and notifications.\\nAdversaries may clear Windows Event Logs to hide the activity of an intrusion.\\nIt is recommended to investigate the process responsible for this action as well as to look for suspicious activities on the host preceding the clearing of the logs.\\n\", \"type\": \"rtlogs\", \"alert_subtype\": \"eventlog\", \"alert_type\": \"sigma\", \"status\": \"new\", \"level\": \"medium\", \"level_int\": 30, \"confidence\": \"weak\", \"confidence_int\": 100, \"execution\": 0, \"tags\": [\"attack.defense_evasion\", \"attack.t1070.001\", \"classification.windows.behavior.defenseevasion\", \"classification.windows.source.eventlog\"], \"mitre_cells\": [\"defense-evasion__t1070.001\"], \"agent\": {\"agentid\": \"63c5e4b1-93e8-48f4-8867-28cac80dc1de\", \"hostname\": \"HOSTNAME\", \"ostype\": \"windows\", \"osproducttype\": \"Windows 11 Pro\", \"osversion\": \"10.0.26100\", \"domainname\": \"DOMAIN\", \"dnsdomainname\": \"DOMAIN.example\", \"version\": \"4.9.42\", \"additional_info\": {}}, \"process\": {\"agent\": {\"agentid\": \"63c5e4b1-93e8-48f4-8867-28cac80dc1de\", \"hostname\": \"HOSTNAME\", \"domainname\": \"DOMAIN\", \"dnsdomainname\": \"DOMAIN.example\", \"ostype\": \"windows\", \"osversion\": \"10.0.26100\", \"osproducttype\": \"Windows 11 Pro\", \"version\": \"4.9.42\", \"additional_info\": {}, \"ipaddress\": \"1.2.3.4\", \"producttype\": \"workstation\"}, \"commandline\": \"C:\\\\WINDOWS\\\\system32\\\\mmc.exe C:\\\\WINDOWS\\\\system32\\\\eventvwr.msc /s\", \"@event_create_date\": \"2025-07-11T09:33:14.858Z\", \"create_time\": \"2025-07-11T09:33:14.858Z\", \"current_directory\": \"C:\\\\WINDOWS\\\\system32\\\\\", \"hashes\": {\"md5\": \"ee0838bcacf8612929fa8df155bcd566\", \"sha1\": \"fe6438fb27c8b4e3d23a3dd53907a245e79432b8\", \"sha256\": \"a2b5685e80f52320cc9d9f9c900256d9dee5e34a7774366a79454fe07d3de7d6\"}, \"image_name\": \"C:\\\\Windows\\\\System32\\\\mmc.exe\", \"log_type\": \"process\", \"parent_commandline\": \"C:\\\\WINDOWS\\\\explorer.exe /factory,{FBB92F10-E8F6-484D-8592-959AE518099E} -Embedding\", \"parent_image\": \"C:\\\\Windows\\\\explorer.exe\", \"parent_unique_id\": \"19b536c8-136f-48d1-bfba-15f1cb041fa3\", \"pid\": 12345, \"ppid\": 23224, \"process_name\": \"mmc.exe\", \"process_unique_id\": \"4303d6a5-c61e-459a-8b36-fd29da6f2205\", \"size\": 1888256, \"username\": \"DOMAIN\\\\example.pc\", \"grandparent_image\": \"C:\\\\Windows\\\\System32\\\\svchost.exe\", \"grandparent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\svchost.exe -k DcomLaunch -p\", \"grandparent_unique_id\": \"33178801-3ff6-431b-a2dc-e63d7aa6586f\", \"stacktrace\": \"\", \"stacktrace_minimal\": \"\", \"ancestors\": \"C:\\\\Windows\\\\explorer.exe|C:\\\\Windows\\\\System32\\\\svchost.exe|C:\\\\Windows\\\\System32\\\\services.exe|C:\\\\Windows\\\\System32\\\\wininit.exe\", \"usersid\": \"S-1-5-21-1111111111-2222222222-3333333333-44444\", \"integrity_level\": \"High\", \"session\": 1, \"logonid\": 1895598, \"parent_integrity_level\": \"Medium\", \"grandparent_integrity_level\": \"System\", \"fake_ppid\": 0, \"fake_parent_image\": \"\", \"fake_parent_commandline\": \"\", \"pe_info\": {\"company_name\": \"Microsoft Corporation\", \"file_description\": \"Microsoft Management Console\", \"file_version\": \"10.0.26100.4484 (WinBuild.160101.0800)\", \"internal_name\": \"mmc.exe\", \"legal_copyright\": \"\\u00a9 Microsoft Corporation. All rights reserved.\", \"original_filename\": \"mmc.exe\", \"pe_timestamp\": \"1980-01-05T04:16:12.000Z\", \"product_name\": \"Microsoft\\u00ae Windows\\u00ae Operating System\", \"product_version\": \"10.0.26100.4484\"}, \"signed\": true, \"signature_info\": {\"signer_info\": {\"serial_number\": \"33000004a882e6b8ac1c5d5ff00000000004a8\", \"thumbprint\": \"1128fd420e0ff7db46e49aacc2bbadfbf2682f11\", \"thumbprint_sha256\": \"ed1d43b97ab28b293b8970aaade6485c9c63f755cfc76cfcd396babf19dfe90c\", \"issuer_name\": \"Microsoft Windows Production PCA 2011\", \"display_name\": \"Microsoft Windows\"}, \"root_info\": {\"serial_number\": \"e9e2241b375cf2b00c88a71017f8ef59\", \"thumbprint\": \"4ec244017d04f3d536eb7984e536cd6dfcd9c257\", \"thumbprint_sha256\": \"96cf3454dd761137d54a834815a07b453e76044b2d6aa1e63492d3b06b0adc55\", \"issuer_name\": \"Microsoft Root Certificate Authority 2010\", \"display_name\": \"Microsoft Root Certificate Authority 2010\"}, \"signed_authenticode\": false, \"signed_catalog\": true}, \"pe_timestamp_int\": 315893772, \"pe_timestamp\": \"1980-01-05T04:16:12.000Z\", \"pe_imphash\": \"FBC54873445C23626874A833A2D17B32\"}, \"process_session\": {\"event_time\": \"2025-07-11T09:29:33.114121Z\", \"logon_id\": 1895598, \"source_hostname\": \"HOSTNAME\", \"source_ip\": \"127.0.0.1\", \"source_port\": 0, \"target_username\": \"example.pc\", \"target_domain\": \"DOMAIN\", \"target_sid\": \"S-1-5-21-1111111111-2222222222-3333333333-44444\", \"logon_type\": 11, \"authentication_package\": \"Negotiate\"}, \"eventlog\": {\"user\": {\"sid\": \"S-1-5-21-1111111111-2222222222-3333333333-44444\", \"name\": \"example.pc\", \"domain\": \"DOMAIN\", \"type\": 1}, \"keywords\": [\"ReservedKeyword63\"], \"event_data\": {}, \"user_data\": {\"ClientProcessStartKey\": \"1234567890\", \"ClientProcessId\": \"12345\", \"Channel\": \"Setup\", \"BackupPath\": \"\", \"xml_name\": \"LogFileCleared\", \"SubjectUserName\": \"example.pc\", \"SubjectDomainName\": \"DOMAIN\"}, \"event_id\": 104, \"record_number\": 8242, \"log_name\": \"System\", \"level\": 4, \"event_date\": \"2025-07-11T09:41:35.509323Z\", \"computer_name\": \"HOSTNAME.DOMAIN.example\", \"source_name\": \"Microsoft-Windows-Eventlog\", \"provider_guid\": {\"data\": \"PROVIDE_GUID\"}, \"process_id\": 4276, \"thread_id\": 17448, \"related_process_id\": 12345, \"related_process_unique_id\": {\"data\": \"UNIQUE_DATA\"}, \"related_process_image_path\": \"C:\\\\Windows\\\\System32\\\\mmc.exe\", \"agent\": null, \"groups\": null, \"log_type\": \"eventlog\", \"pid\": null, \"process_image_path\": null, \"process_unique_id\": null, \"type\": \"wineventlog\", \"sigma_rule_content\": \"title: Windows Application Logs Cleared\\nid: a755c365-396a-4e7b-bbbe-d5c86d6e6ca9\\ndescription: |\\n    Detects when one of the Windows application logs is cleared.\\n    Windows Event Logs are a record of a computer's alerts and notifications.\\n    Adversaries may clear Windows Event Logs to hide the activity of an intrusion.\\n    It is recommended to investigate the process responsible for this action as well as to look for suspicious activities on the host preceding the clearing of the logs.\\nreferences:\\n    - https://attack.mitre.org/techniques/T1070/001/\\ndate: 2021/04/27\\nmodified: 2025/05/09\\nauthor: HarfangLab\\ntags:\\n    - attack.defense_evasion\\n    - attack.t1070.001\\n    - classification.Windows.Source.EventLog\\n    - classification.Windows.Behavior.DefenseEvasion\\nlogsource:\\n    product: windows\\n    service: system\\ndetection:\\n    selection:\\n        EventID: 104\\n        Source: Microsoft-Windows-Eventlog\\n\\n    exclusion_channel:\\n        Channel:\\n            - 'ModemAuthenticatorLog'\\n            - 'Microsoft-Exchange-ManagedAvailability/ThrottlingConfig'\\n\\n    exclusion_ccleaner:\\n        - ProcessImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n        - ProcessParentImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n\\n    exclusion_atera:\\n        ProcessGrandparentImage: '?:\\\\Program Files\\\\ATERA Networks\\\\AteraAgent\\\\Packages\\\\AgentPackageSystemTools\\\\AgentPackageSystemTools.exe'\\n\\n    exclusion_citrix:\\n        ProcessParentImage: '?:\\\\Program Files (x86)\\\\Citrix\\\\Workspace Environment Management Agent\\\\Citrix.Wem.Agent.Service.exe'\\n\\n    exclusion_minint:\\n        ProcessGrandparentImage: '?:\\\\MININT\\\\Tools\\\\X64\\\\TsManager.exe'\\n\\n    exclusion_lenovo:\\n        ProcessGrandparentImage: '?:\\\\Program Files (x86)\\\\Lenovo\\\\LenovoWelcome\\\\x86\\\\LenovoWelcomeTask.exe'\\n\\n    condition: selection and not 1 of exclusion_*\\nlevel: medium\\nconfidence: weak\"}, \"detection_origin\": \"agent\", \"image_name\": \"C:\\\\Windows\\\\System32\\\\mmc.exe\", \"rule_content\": \"title: Windows Application Logs Cleared\\nid: a755c365-396a-4e7b-bbbe-d5c86d6e6ca9\\ndescription: |\\n    Detects when one of the Windows application logs is cleared.\\n    Windows Event Logs are a record of a computer's alerts and notifications.\\n    Adversaries may clear Windows Event Logs to hide the activity of an intrusion.\\n    It is recommended to investigate the process responsible for this action as well as to look for suspicious activities on the host preceding the clearing of the logs.\\nreferences:\\n    - https://attack.mitre.org/techniques/T1070/001/\\ndate: 2021/04/27\\nmodified: 2025/05/09\\nauthor: HarfangLab\\ntags:\\n    - attack.defense_evasion\\n    - attack.t1070.001\\n    - classification.Windows.Source.EventLog\\n    - classification.Windows.Behavior.DefenseEvasion\\nlogsource:\\n    product: windows\\n    service: system\\ndetection:\\n    selection:\\n        EventID: 104\\n        Source: Microsoft-Windows-Eventlog\\n\\n    exclusion_channel:\\n        Channel:\\n            - 'ModemAuthenticatorLog'\\n            - 'Microsoft-Exchange-ManagedAvailability/ThrottlingConfig'\\n\\n    exclusion_ccleaner:\\n        - ProcessImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n        - ProcessParentImage: '?:\\\\Program Files\\\\CCleaner\\\\CCleaner64.exe'\\n\\n    exclusion_atera:\\n        ProcessGrandparentImage: '?:\\\\Program Files\\\\ATERA Networks\\\\AteraAgent\\\\Packages\\\\AgentPackageSystemTools\\\\AgentPackageSystemTools.exe'\\n\\n    exclusion_citrix:\\n        ProcessParentImage: '?:\\\\Program Files (x86)\\\\Citrix\\\\Workspace Environment Management Agent\\\\Citrix.Wem.Agent.Service.exe'\\n\\n    exclusion_minint:\\n        ProcessGrandparentImage: '?:\\\\MININT\\\\Tools\\\\X64\\\\TsManager.exe'\\n\\n    exclusion_lenovo:\\n        ProcessGrandparentImage: '?:\\\\Program Files (x86)\\\\Lenovo\\\\LenovoWelcome\\\\x86\\\\LenovoWelcomeTask.exe'\\n\\n    condition: selection and not 1 of exclusion_*\\nlevel: medium\\nconfidence: weak\", \"aggregation_key\": \"3c95f845193113e2ab23bbeb4118f1656113fade32536a43cee07384525ca5b0\", \"threat_type\": \"commandline\", \"threat_values\": [\"<drive>:\\\\windows\\\\system32\\\\mmc.exe <drive>:\\\\windows\\\\system32\\\\eventvwr.msc /s\"], \"threat_key\": \"91b4e881-6d4b-4bf4-b7d2-cbdf8731d26e\", \"groups\": [], \"tenant\": \"TENANT\"}",
    "event": {
      "category": [
        "process"
      ],
      "dataset": "alert",
      "kind": "alert",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-07-11T09:41:35.946000Z",
    "agent": {
      "id": "63c5e4b1-93e8-48f4-8867-28cac80dc1de",
      "name": "harfanglab"
    },
    "file": {
      "hash": {
        "md5": "ee0838bcacf8612929fa8df155bcd566",
        "sha1": "fe6438fb27c8b4e3d23a3dd53907a245e79432b8",
        "sha256": "a2b5685e80f52320cc9d9f9c900256d9dee5e34a7774366a79454fe07d3de7d6"
      }
    },
    "harfanglab": {
      "aggregation_key": "3c95f845193113e2ab23bbeb4118f1656113fade32536a43cee07384525ca5b0",
      "alert_subtype": "eventlog",
      "alert_time": "2025-07-11T09:41:35.946+00:00",
      "alert_unique_id": "4a89a09d-e689-4e19-b531-ef8239718f93",
      "execution": 0,
      "grandparent": {
        "process": {
          "command_line": "C:\\WINDOWS\\system32\\svchost.exe -k DcomLaunch -p",
          "executable": "C:\\Windows\\System32\\svchost.exe"
        }
      },
      "groups": [],
      "level": "medium",
      "status": "new",
      "threat_key": "91b4e881-6d4b-4bf4-b7d2-cbdf8731d26e"
    },
    "host": {
      "domain": "DOMAIN",
      "hostname": "HOSTNAME",
      "name": "HOSTNAME",
      "os": {
        "full": "Windows 11 Pro",
        "type": "windows",
        "version": "10.0.26100"
      }
    },
    "log": {
      "hostname": "HOSTNAME"
    },
    "organization": {
      "id": "TENANT"
    },
    "process": {
      "command_line": "C:\\WINDOWS\\system32\\mmc.exe C:\\WINDOWS\\system32\\eventvwr.msc /s",
      "executable": "C:\\Windows\\System32\\mmc.exe",
      "name": "mmc.exe",
      "parent": {
        "command_line": "C:\\WINDOWS\\explorer.exe /factory,{FBB92F10-E8F6-484D-8592-959AE518099E} -Embedding",
        "executable": "C:\\Windows\\explorer.exe",
        "name": "explorer.exe"
      },
      "pe": {
        "company": "Microsoft Corporation",
        "description": "Microsoft Management Console",
        "file_version": "10.0.26100.4484 (WinBuild.160101.0800)",
        "imphash": "FBC54873445C23626874A833A2D17B32",
        "original_file_name": "mmc.exe",
        "product": "Microsoft\u00ae Windows\u00ae Operating System"
      },
      "pid": 12345,
      "working_directory": "C:\\WINDOWS\\system32\\"
    },
    "related": {
      "hash": [
        "a2b5685e80f52320cc9d9f9c900256d9dee5e34a7774366a79454fe07d3de7d6",
        "ee0838bcacf8612929fa8df155bcd566",
        "fe6438fb27c8b4e3d23a3dd53907a245e79432b8"
      ],
      "hosts": [
        "HOSTNAME"
      ],
      "user": [
        "example.pc"
      ]
    },
    "rule": {
      "category": "sigma",
      "description": "Detects when one of the Windows application logs is cleared.\nWindows Event Logs are a record of a computer's alerts and notifications.\nAdversaries may clear Windows Event Logs to hide the activity of an intrusion.\nIt is recommended to investigate the process responsible for this action as well as to look for suspicious activities on the host preceding the clearing of the logs.\n",
      "id": "a755c365-396a-4e7b-bbbe-d5c86d6e6ca9",
      "name": "Windows Application Logs Cleared"
    },
    "user": {
      "domain": "DOMAIN",
      "name": "example.pc"
    }
  }
}