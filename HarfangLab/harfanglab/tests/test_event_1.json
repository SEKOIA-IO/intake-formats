{
  "input": {
    "message": "{  \"user\": {    \"sid\": null,    \"name\": null,    \"domain\": null,    \"type\": null  },  \"keywords\": [    \"AuditSuccess\",    \"ReservedKeyword63\"  ],  \"event_data\": {    \"ParentProcessId\": \"1111\",    \"TaskContentNew\": \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-16\\\"?><Task version=\\\"1.2\\\" xmlns=\\\"http://schemas.microsoft.com/windows/2004/02/mit/task\\\">  <RegistrationInfo>   <Date>2025-10-02T10:49:26.0677463</Date>    <Author>ACME\\\\john.doe@test</Author>    <URI>\\\\task</URI>  </RegistrationInfo>  <Triggers>    <CalendarTrigger>     <StartBoundary>2025-10-02T12:00:00</StartBoundary>      <Enabled>true</Enabled>      <ScheduleByWeek>        <DaysOfWeek>          <Monday />          <Tuesday />          <Wednesday />          <Thursday />          <Friday />        </DaysOfWeek>       <WeeksInterval>1</WeeksInterval>      </ScheduleByWeek>    </CalendarTrigger>  </Triggers>  <Principals>    <Principal id=\\\"Author\\\">     <RunLevel>LeastPrivilege</RunLevel>      <UserId>john.doe@test</UserId>     <LogonType>InteractiveToken</LogonType>    </Principal>  </Principals>  <Settings>   <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>   <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>   <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>   <AllowHardTerminate>true</AllowHardTerminate>   <StartWhenAvailable>false</StartWhenAvailable>   <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>   <IdleSettings>     <StopOnIdleEnd>true</StopOnIdleEnd>     <RestartOnIdle>false</RestartOnIdle>   </IdleSettings>   <AllowStartOnDemand>true</AllowStartOnDemand>   <Enabled>true</Enabled>   <Hidden>false</Hidden>   <RunOnlyIfIdle>false</RunOnlyIfIdle>   <WakeToRun>false</WakeToRun>   <ExecutionTimeLimit>P3D</ExecutionTimeLimit>   <Priority>7</Priority>  </Settings>  <Actions Context=\\\"Author\\\">    <Exec>      <Command>\\\"C:\\\\Users\\\\john.doe\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\update_script.bat\\\"</Command>    </Exec>  </Actions></Task>\",    \"ClientProcessId\": \"2222\",    \"SubjectUserSid\": \"S-1-5-21-0000000000-0000000000-0000000000-00000\",    \"ClientProcessStartKey\": \"0000000000000000\",    \"SubjectLogonId\": \"0x00000\",    \"RpcCallClientLocality\": \"0\",    \"TaskName\": \"\\\\task (file://task)\",    \"SubjectUserName\": \"john.doe@test\",    \"FQDN\": \"host01.example.local\",    \"SubjectDomainName\": \"ACME\"  },  \"user_data\": {},  \"event_id\": 4702,  \"record_number\": 100001,  \"log_name\": \"Security\",  \"level\": 0,  \"event_date\": \"2025-10-02T08:56:08.500067Z\",  \"computer_name\": \"host01.example.local\",  \"source_name\": \"Microsoft-Windows-Security-Auditing\",  \"provider_guid\": {    \"data\": \"AAAAAAAAAAAAAAAAAAAAAA==\"  },  \"process_id\": 1234,  \"thread_id\": 5678,  \"related_process_id\": 2222,  \"related_process_unique_id\": {    \"data\": \"AAAAAAAAAAAAAAAAAAAAAA==\"  },  \"related_process_image_path\": \"C:\\\\Windows\\\\System32\\\\system.exe\",  \"groups\": [    {      \"id\": \"00000000-0000-0000-0000-000000000000\",      \"name\": \"DEFAULT\"    }  ],  \"log_type\": \"eventlog\",  \"pid\": 2222,  \"process_image_path\": \"C:\\\\Windows\\\\System32\\\\system.exe\",  \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\",  \"type\": \"wineventlog\",  \"@timestamp\": \"2025-10-02T08:56:29.912196+00:00\",  \"tenant\": \"\",  \"agent\": {    \"agentid\": \"00000000-0000-0000-0000-000000000000\",    \"hostname\": \"host01\",    \"domain\": null,    \"domainname\": \"ACME\",    \"dnsdomainname\": \"example.local\",    \"ostype\": \"windows\",    \"osversion\": \"10.0.26100\",    \"distroid\": null,    \"osproducttype\": \"Windows 11 Enterprise\",    \"version\": \"4.8.56\",    \"additional_info\": {},    \"ipaddress\": \"1.2.3.4\",    \"producttype\": null  }}",
    "sekoiaio": {
      "intake": {
        "dialect": "HarfangLab EDR",
        "dialect_uuid": "3c7057d3-4689-4fae-8033-6f1f887a70f2"
      }
    }
  },
  "expected": {
    "message": "{  \"user\": {    \"sid\": null,    \"name\": null,    \"domain\": null,    \"type\": null  },  \"keywords\": [    \"AuditSuccess\",    \"ReservedKeyword63\"  ],  \"event_data\": {    \"ParentProcessId\": \"1111\",    \"TaskContentNew\": \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-16\\\"?><Task version=\\\"1.2\\\" xmlns=\\\"http://schemas.microsoft.com/windows/2004/02/mit/task\\\">  <RegistrationInfo>   <Date>2025-10-02T10:49:26.0677463</Date>    <Author>ACME\\\\john.doe@test</Author>    <URI>\\\\task</URI>  </RegistrationInfo>  <Triggers>    <CalendarTrigger>     <StartBoundary>2025-10-02T12:00:00</StartBoundary>      <Enabled>true</Enabled>      <ScheduleByWeek>        <DaysOfWeek>          <Monday />          <Tuesday />          <Wednesday />          <Thursday />          <Friday />        </DaysOfWeek>       <WeeksInterval>1</WeeksInterval>      </ScheduleByWeek>    </CalendarTrigger>  </Triggers>  <Principals>    <Principal id=\\\"Author\\\">     <RunLevel>LeastPrivilege</RunLevel>      <UserId>john.doe@test</UserId>     <LogonType>InteractiveToken</LogonType>    </Principal>  </Principals>  <Settings>   <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>   <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>   <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>   <AllowHardTerminate>true</AllowHardTerminate>   <StartWhenAvailable>false</StartWhenAvailable>   <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>   <IdleSettings>     <StopOnIdleEnd>true</StopOnIdleEnd>     <RestartOnIdle>false</RestartOnIdle>   </IdleSettings>   <AllowStartOnDemand>true</AllowStartOnDemand>   <Enabled>true</Enabled>   <Hidden>false</Hidden>   <RunOnlyIfIdle>false</RunOnlyIfIdle>   <WakeToRun>false</WakeToRun>   <ExecutionTimeLimit>P3D</ExecutionTimeLimit>   <Priority>7</Priority>  </Settings>  <Actions Context=\\\"Author\\\">    <Exec>      <Command>\\\"C:\\\\Users\\\\john.doe\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\update_script.bat\\\"</Command>    </Exec>  </Actions></Task>\",    \"ClientProcessId\": \"2222\",    \"SubjectUserSid\": \"S-1-5-21-0000000000-0000000000-0000000000-00000\",    \"ClientProcessStartKey\": \"0000000000000000\",    \"SubjectLogonId\": \"0x00000\",    \"RpcCallClientLocality\": \"0\",    \"TaskName\": \"\\\\task (file://task)\",    \"SubjectUserName\": \"john.doe@test\",    \"FQDN\": \"host01.example.local\",    \"SubjectDomainName\": \"ACME\"  },  \"user_data\": {},  \"event_id\": 4702,  \"record_number\": 100001,  \"log_name\": \"Security\",  \"level\": 0,  \"event_date\": \"2025-10-02T08:56:08.500067Z\",  \"computer_name\": \"host01.example.local\",  \"source_name\": \"Microsoft-Windows-Security-Auditing\",  \"provider_guid\": {    \"data\": \"AAAAAAAAAAAAAAAAAAAAAA==\"  },  \"process_id\": 1234,  \"thread_id\": 5678,  \"related_process_id\": 2222,  \"related_process_unique_id\": {    \"data\": \"AAAAAAAAAAAAAAAAAAAAAA==\"  },  \"related_process_image_path\": \"C:\\\\Windows\\\\System32\\\\system.exe\",  \"groups\": [    {      \"id\": \"00000000-0000-0000-0000-000000000000\",      \"name\": \"DEFAULT\"    }  ],  \"log_type\": \"eventlog\",  \"pid\": 2222,  \"process_image_path\": \"C:\\\\Windows\\\\System32\\\\system.exe\",  \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\",  \"type\": \"wineventlog\",  \"@timestamp\": \"2025-10-02T08:56:29.912196+00:00\",  \"tenant\": \"\",  \"agent\": {    \"agentid\": \"00000000-0000-0000-0000-000000000000\",    \"hostname\": \"host01\",    \"domain\": null,    \"domainname\": \"ACME\",    \"dnsdomainname\": \"example.local\",    \"ostype\": \"windows\",    \"osversion\": \"10.0.26100\",    \"distroid\": null,    \"osproducttype\": \"Windows 11 Enterprise\",    \"version\": \"4.8.56\",    \"additional_info\": {},    \"ipaddress\": \"1.2.3.4\",    \"producttype\": null  }}",
    "event": {
      "code": "4702",
      "dataset": "eventlog",
      "provider": "Microsoft-Windows-Security-Auditing",
      "type": [
        "info"
      ]
    },
    "action": {
      "id": 4702,
      "properties": {
        "ClientProcessId": "2222",
        "ClientProcessStartKey": "0000000000000000",
        "FQDN": "host01.example.local",
        "ParentProcessId": "1111",
        "RpcCallClientLocality": "0",
        "SubjectDomainName": "ACME",
        "SubjectLogonId": "0x00000",
        "SubjectUserName": "john.doe@test",
        "SubjectUserSid": "S-1-5-21-0000000000-0000000000-0000000000-00000",
        "TaskContent": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">  <RegistrationInfo>   <Date>2025-10-02T10:49:26.0677463</Date>    <Author>ACME\\john.doe@test</Author>    <URI>\\task</URI>  </RegistrationInfo>  <Triggers>    <CalendarTrigger>     <StartBoundary>2025-10-02T12:00:00</StartBoundary>      <Enabled>true</Enabled>      <ScheduleByWeek>        <DaysOfWeek>          <Monday />          <Tuesday />          <Wednesday />          <Thursday />          <Friday />        </DaysOfWeek>       <WeeksInterval>1</WeeksInterval>      </ScheduleByWeek>    </CalendarTrigger>  </Triggers>  <Principals>    <Principal id=\"Author\">     <RunLevel>LeastPrivilege</RunLevel>      <UserId>john.doe@test</UserId>     <LogonType>InteractiveToken</LogonType>    </Principal>  </Principals>  <Settings>   <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>   <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>   <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>   <AllowHardTerminate>true</AllowHardTerminate>   <StartWhenAvailable>false</StartWhenAvailable>   <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>   <IdleSettings>     <StopOnIdleEnd>true</StopOnIdleEnd>     <RestartOnIdle>false</RestartOnIdle>   </IdleSettings>   <AllowStartOnDemand>true</AllowStartOnDemand>   <Enabled>true</Enabled>   <Hidden>false</Hidden>   <RunOnlyIfIdle>false</RunOnlyIfIdle>   <WakeToRun>false</WakeToRun>   <ExecutionTimeLimit>P3D</ExecutionTimeLimit>   <Priority>7</Priority>  </Settings>  <Actions Context=\"Author\">    <Exec>      <Command>\"C:\\Users\\john.doe\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\update_script.bat\"</Command>    </Exec>  </Actions></Task>",
        "TaskContentNew_Command": "\"C:\\Users\\john.doe\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\update_script.bat\"",
        "TaskName": "\\task (file://task)"
      }
    },
    "agent": {
      "id": "00000000-0000-0000-0000-000000000000",
      "name": "harfanglab"
    },
    "harfanglab": {
      "groups": [
        "{\"id\":\"00000000-0000-0000-0000-000000000000\",\"name\":\"DEFAULT\"}"
      ]
    },
    "host": {
      "domain": "ACME",
      "hostname": "host01",
      "ip": [
        "1.2.3.4"
      ],
      "name": "host01",
      "os": {
        "full": "Windows 11 Enterprise",
        "type": "windows",
        "version": "10.0.26100"
      }
    },
    "log": {
      "hostname": "host01"
    },
    "process": {
      "executable": "C:\\Windows\\System32\\system.exe",
      "pid": 2222
    },
    "related": {
      "hosts": [
        "host01"
      ],
      "ip": [
        "1.2.3.4"
      ],
      "user": [
        "john.doe@test"
      ]
    },
    "user": {
      "domain": "ACME",
      "name": "john.doe@test",
      "roles": "DEFAULT"
    }
  }
}