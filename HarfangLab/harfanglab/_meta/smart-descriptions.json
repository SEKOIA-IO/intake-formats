[
  {
    "value": "Hostname: {host.hostname} - Source: {event.provider} - EventID: {event.code}",
    "conditions": [
      {
        "field": "event.provider"
      }
    ]
  },
  {
    "value": "{user.target.name} failed to log on {host.hostname} (LogonType {action.properties.LogonType})",
    "conditions": [
      {
        "field": "event.provider"
      },
      {
        "field": "event.code",
        "value": "4625"
      }
    ],
    "relationships": [
      {
        "source": "user.target.name",
        "target": "host.hostname",
        "type": "failed to log on to"
      }
    ]
  },
  {
    "value": "{user.target.name} failed to log on {host.hostname} (LogonType {action.properties.LogonType})",
    "conditions": [
      {
        "field": "host.hostname"
      },
      {
        "field": "user.target.name"
      },
      {
        "field": "action.properties.LogonType"
      },
      {
        "field": "event.code",
        "value": "4625"
      }
    ],
    "relationships": [
      {
        "source": "user.target.name",
        "target": "host.hostname",
        "type": "failed to log on to"
      }
    ]
  },
  {
    "value": "{process.executable} ({process.pe.company}) executed by {user.name} is running on {host.hostname}",
    "conditions": [
      {
        "field": "event.category",
        "value": "process"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "log.hostname",
        "type": "executed on"
      },
      {
        "source": "user.name",
        "target": "process.parent.executable",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.executable",
        "target": "process.executable",
        "type": "started"
      }
    ]
  },
  {
    "value": "{process.executable} on {host.hostname} handles network traffic from {source.ip}:{source.port} to {destination.ip}:{destination.port}",
    "conditions": [
      {
        "field": "event.executable",
        "value": "network"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      }
    ]
  },
  {
    "value": "User {user.name} of computer {host.domain}\\{host.hostname} handles network traffic from {source.ip}:{source.port} to {destination.ip}:{destination.port}",
    "conditions": [
      {
        "field": "event.category",
        "value": "network"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      }
    ]
  },
  {
    "value": "User {user.name} (ip: {source.ip}) requested resource {url.path}",
    "conditions": [
      {
        "field": "event.category",
        "value": "web"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "url.path"
      }
    ]
  },
  {
    "value": "User {user.name} (ip: {source.ip}) log in to {user.target.name}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "authentication"
      },
      {
        "field": "event.type",
        "value": "start"
      },
      {
        "field": "action.outcome",
        "value": "success"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "user.target.name"
      }
    ]
  },
  {
    "value": "User {user.name} (ip: {source.ip}) failed to log in to {user.target.name}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "authentication"
      },
      {
        "field": "event.type",
        "value": "start"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "user.target.name"
      }
    ]
  },
  {
    "value": "User {user.target.name} log in to {host.name}",
    "conditions": [
      {
        "field": "event.category",
        "value": "authentication"
      },
      {
        "field": "action.outcome",
        "value": "success"
      },
      {
        "field": "user.target.name"
      },
      {
        "field": "host.name"
      }
    ]
  },
  {
    "value": "User {user.target.name} failed to log in to {host.name}",
    "conditions": [
      {
        "field": "event.category",
        "value": "authentication"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      },
      {
        "field": "user.target.name"
      },
      {
        "field": "host.name"
      }
    ]
  },
  {
    "value": "User {user.name} (ip: {source.ip}) logged out from {user.target.name}: {event.reason}",
    "conditions": [
      {
        "field": "event.category",
        "value": "authentication"
      },
      {
        "field": "event.action",
        "value": "logout"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "user.target.name"
      },
      {
        "field": "event.reason"
      }
    ]
  },
  {
    "value": "User {user.target.name} logged out from {host.name}: {event.reason}",
    "conditions": [
      {
        "field": "event.category",
        "value": "authentication"
      },
      {
        "field": "event.action",
        "value": "logout"
      },
      {
        "field": "user.target.name"
      },
      {
        "field": "event.reason"
      }
    ]
  },
  {
    "value": "Program {process.executable} requested domain name {dns.question.name}",
    "conditions": [
      {
        "field": "event.category",
        "value": "network"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "dns.question.name"
      }
    ]
  },
  {
    "value": "Analysis done on {file.name}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "investigation"
      },
      {
        "field": "file.name"
      }
    ]
  },
  {
    "value": "A {harfanglab.status} alert '{rule.name}' was raised on host {host.hostname}",
    "conditions": [
      {
        "field": "event.category",
        "value": "alert"
      },
      {
        "field":"host.hostname"
      }
    ]
  } 
]
