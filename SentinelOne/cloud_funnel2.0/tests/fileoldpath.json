{
  "input": {
    "message": "{\"src.process.parent.isStorylineRoot\":false,\"event.category\":\"file\",\"src.process.parent.image.sha1\":\"0000000\",\"site.id\":\"00000000\",\"tgt.file.location\":\"Local\",\"src.process.parent.displayName\":\"pparent\",\"src.process.parent.subsystem\":\"SUBSYSTEM_UNKNOWN\",\"src.process.indicatorRansomwareCount\":0,\"src.process.crossProcessDupRemoteProcessHandleCount\":0,\"src.process.tgtFileCreationCount\":1,\"src.process.indicatorInjectionCount\":0,\"src.process.moduleCount\":0,\"i.version\":\"preprocess-lib-1.0\",\"src.process.parent.name\":\"pname\",\"src.process.storyline.id\":\"00000-0000-0000-0000000\",\"src.process.indicatorReconnaissanceCount\":0,\"src.process.childProcCount\":0,\"aaaa.url\":\"redacted.sentinelone.net\",\"src.process.parent.eUserName\":\"aaaaaaaa\",\"src.process.crossProcessOpenProcessCount\":0,\"src.process.eUserName\":\"aaaaaaaa\",\"src.process.subsystem\":\"SUBSYSTEM_UNKNOWN\",\"meta.event.name\":\"FILERENAME\",\"src.process.parent.integrityLevel\":\"INTEGRITY_LEVEL_UNKNOWN\",\"src.process.indicatorExploitationCount\":0,\"src.process.parent.storyline.id\":\"0000000-0000-0000-00000000\",\"tgt.file.creationTime\":1722852662250,\"src.process.integrityLevel\":\"INTEGRITY_LEVEL_UNKNOWN\",\"i.scheme\":\"edr\",\"site.name\":\"sitename\",\"src.process.netConnInCount\":0,\"event.time\":1722853381979,\"timestamp\":\"2024-08-05T10:23:01.979Z\",\"account.id\":\"00000000000\",\"dataSource.name\":\"SentinelOne\",\"endpoint.name\":\"aaaaaaaaa\",\"src.process.image.sha1\":\"aaaaaaaaaaaaaa\",\"tgt.file.size\":750,\"src.process.isStorylineRoot\":false,\"src.process.parent.image.path\":\"\\/bin\\/pparent\",\"src.process.lUserName\":\"aaaaaaaa\",\"dataSource.vendor\":\"SentinelOne\",\"src.process.pid\":31304,\"tgt.file.isSigned\":\"unsigned\",\"src.process.cmdline\":\" \\/usr\\/cmd -\",\"dataSource.category\":\"security\",\"src.process.crossProcessThreadCreateCount\":0,\"src.process.parent.isNative64Bit\":false,\"src.process.parent.isRedirectCmdProcessor\":false,\"src.process.parent.rUserUid\":1111,\"src.process.crossProcessCount\":0,\"src.process.signedStatus\":\"unsigned\",\"event.id\":\"01J4H129Q4744MK0FX0CNXASK1_414\",\"src.process.image.path\":\"\\/usr\\/path\",\"src.process.tgtFileModificationCount\":2,\"src.process.indicatorEvasionCount\":0,\"src.process.netConnOutCount\":0,\"tgt.file.path\":\"\\/new\\/new\\/file\\/path\\/path\",\"src.process.eUserUid\":1111,\"src.process.lUserUid\":1111,\"src.process.crossProcessDupThreadHandleCount\":0,\"endpoint.os\":\"linux\",\"src.process.tgtFileDeletionCount\":0,\"src.process.startTime\":1722853381100,\"mgmt.id\":\"00000\",\"os.name\":\"Linux\",\"tgt.file.type\":\"UNKNOWN\",\"src.process.displayName\":\"aaaaaaaaa\",\"src.process.isNative64Bit\":false,\"src.process.parent.sessionId\":0,\"src.process.rUserUid\":1111,\"src.process.uid\":\"000000000-0000-0000-00000000000\",\"src.process.indicatorBootConfigurationUpdateCount\":0,\"src.process.indicatorInfostealerCount\":0,\"process.unique.key\":\"000000000-0000-0000-000000000\",\"src.process.parent.eUserUid\":112,\"agent.version\":\"1\",\"src.process.parent.uid\":\"000000000-0000-0000-0000000000000000\",\"src.process.parent.rUserName\":\"aaaaaaaaa\",\"src.process.sessionId\":0,\"src.process.netConnCount\":0,\"mgmt.osRevision\":\"Debian\",\"group.id\":\"000000000-0000-0000-00000000\",\"src.process.isRedirectCmdProcessor\":false,\"src.process.parent.startTime\":1722853381090,\"src.process.dnsCount\":0,\"endpoint.type\":\"server\",\"tgt.file.oldPath\":\"\\/old\\/path\\/name\\/tmp.aaaa\",\"trace.id\":\"00000000000\",\"src.process.rUserName\":\"aaaaaaaaa\",\"src.process.name\":\"aaaaa\",\"agent.uuid\":\"00000-0000-0000-000000\",\"src.process.parent.lUserName\":\"aaaaaaaa\",\"src.process.indicatorGeneralCount\":0,\"src.process.parent.lUserUid\":1111,\"src.process.crossProcessOutOfStorylineCount\":0,\"packet.id\":\"000000-0000-0000-000000000000\",\"src.process.registryChangeCount\":0,\"src.process.indicatorPersistenceCount\":3,\"src.process.parent.signedStatus\":\"unsigned\",\"tgt.file.id\":\"00000-0000-0000-0000000000\",\"account.name\":\"account_name\",\"event.type\":\"File Rename\",\"task.path\":\"\\/var\\/aaa\\/aaa\\/aaaa\\/aaaa\",\"src.process.indicatorPostExploitationCount\":0,\"src.process.parent.pid\":111111}",
    "sekoiaio": {
      "intake": {
        "dialect": "SentinelOne Cloud Funnel 2.0",
        "dialect_uuid": "40deb162-6bb1-4635-9c99-5c2de7e1d340"
      }
    }
  },
  "expected": {
    "message": "{\"src.process.parent.isStorylineRoot\":false,\"event.category\":\"file\",\"src.process.parent.image.sha1\":\"0000000\",\"site.id\":\"00000000\",\"tgt.file.location\":\"Local\",\"src.process.parent.displayName\":\"pparent\",\"src.process.parent.subsystem\":\"SUBSYSTEM_UNKNOWN\",\"src.process.indicatorRansomwareCount\":0,\"src.process.crossProcessDupRemoteProcessHandleCount\":0,\"src.process.tgtFileCreationCount\":1,\"src.process.indicatorInjectionCount\":0,\"src.process.moduleCount\":0,\"i.version\":\"preprocess-lib-1.0\",\"src.process.parent.name\":\"pname\",\"src.process.storyline.id\":\"00000-0000-0000-0000000\",\"src.process.indicatorReconnaissanceCount\":0,\"src.process.childProcCount\":0,\"aaaa.url\":\"redacted.sentinelone.net\",\"src.process.parent.eUserName\":\"aaaaaaaa\",\"src.process.crossProcessOpenProcessCount\":0,\"src.process.eUserName\":\"aaaaaaaa\",\"src.process.subsystem\":\"SUBSYSTEM_UNKNOWN\",\"meta.event.name\":\"FILERENAME\",\"src.process.parent.integrityLevel\":\"INTEGRITY_LEVEL_UNKNOWN\",\"src.process.indicatorExploitationCount\":0,\"src.process.parent.storyline.id\":\"0000000-0000-0000-00000000\",\"tgt.file.creationTime\":1722852662250,\"src.process.integrityLevel\":\"INTEGRITY_LEVEL_UNKNOWN\",\"i.scheme\":\"edr\",\"site.name\":\"sitename\",\"src.process.netConnInCount\":0,\"event.time\":1722853381979,\"timestamp\":\"2024-08-05T10:23:01.979Z\",\"account.id\":\"00000000000\",\"dataSource.name\":\"SentinelOne\",\"endpoint.name\":\"aaaaaaaaa\",\"src.process.image.sha1\":\"aaaaaaaaaaaaaa\",\"tgt.file.size\":750,\"src.process.isStorylineRoot\":false,\"src.process.parent.image.path\":\"\\/bin\\/pparent\",\"src.process.lUserName\":\"aaaaaaaa\",\"dataSource.vendor\":\"SentinelOne\",\"src.process.pid\":31304,\"tgt.file.isSigned\":\"unsigned\",\"src.process.cmdline\":\" \\/usr\\/cmd -\",\"dataSource.category\":\"security\",\"src.process.crossProcessThreadCreateCount\":0,\"src.process.parent.isNative64Bit\":false,\"src.process.parent.isRedirectCmdProcessor\":false,\"src.process.parent.rUserUid\":1111,\"src.process.crossProcessCount\":0,\"src.process.signedStatus\":\"unsigned\",\"event.id\":\"01J4H129Q4744MK0FX0CNXASK1_414\",\"src.process.image.path\":\"\\/usr\\/path\",\"src.process.tgtFileModificationCount\":2,\"src.process.indicatorEvasionCount\":0,\"src.process.netConnOutCount\":0,\"tgt.file.path\":\"\\/new\\/new\\/file\\/path\\/path\",\"src.process.eUserUid\":1111,\"src.process.lUserUid\":1111,\"src.process.crossProcessDupThreadHandleCount\":0,\"endpoint.os\":\"linux\",\"src.process.tgtFileDeletionCount\":0,\"src.process.startTime\":1722853381100,\"mgmt.id\":\"00000\",\"os.name\":\"Linux\",\"tgt.file.type\":\"UNKNOWN\",\"src.process.displayName\":\"aaaaaaaaa\",\"src.process.isNative64Bit\":false,\"src.process.parent.sessionId\":0,\"src.process.rUserUid\":1111,\"src.process.uid\":\"000000000-0000-0000-00000000000\",\"src.process.indicatorBootConfigurationUpdateCount\":0,\"src.process.indicatorInfostealerCount\":0,\"process.unique.key\":\"000000000-0000-0000-000000000\",\"src.process.parent.eUserUid\":112,\"agent.version\":\"1\",\"src.process.parent.uid\":\"000000000-0000-0000-0000000000000000\",\"src.process.parent.rUserName\":\"aaaaaaaaa\",\"src.process.sessionId\":0,\"src.process.netConnCount\":0,\"mgmt.osRevision\":\"Debian\",\"group.id\":\"000000000-0000-0000-00000000\",\"src.process.isRedirectCmdProcessor\":false,\"src.process.parent.startTime\":1722853381090,\"src.process.dnsCount\":0,\"endpoint.type\":\"server\",\"tgt.file.oldPath\":\"\\/old\\/path\\/name\\/tmp.aaaa\",\"trace.id\":\"00000000000\",\"src.process.rUserName\":\"aaaaaaaaa\",\"src.process.name\":\"aaaaa\",\"agent.uuid\":\"00000-0000-0000-000000\",\"src.process.parent.lUserName\":\"aaaaaaaa\",\"src.process.indicatorGeneralCount\":0,\"src.process.parent.lUserUid\":1111,\"src.process.crossProcessOutOfStorylineCount\":0,\"packet.id\":\"000000-0000-0000-000000000000\",\"src.process.registryChangeCount\":0,\"src.process.indicatorPersistenceCount\":3,\"src.process.parent.signedStatus\":\"unsigned\",\"tgt.file.id\":\"00000-0000-0000-0000000000\",\"account.name\":\"account_name\",\"event.type\":\"File Rename\",\"task.path\":\"\\/var\\/aaa\\/aaa\\/aaaa\\/aaaa\",\"src.process.indicatorPostExploitationCount\":0,\"src.process.parent.pid\":111111}",
    "event": {
      "action": "File Rename",
      "category": [
        "file"
      ],
      "dataset": "cloud-funnel-2.0",
      "type": [
        "change"
      ]
    },
    "@timestamp": "2024-08-05T10:23:01.979000Z",
    "agent": {
      "version": "1"
    },
    "deepvisibility": {
      "agent": {
        "trace_id": "00000000000",
        "uuid": "00000-0000-0000-000000"
      },
      "event": {
        "category": "file",
        "type": "File Rename"
      },
      "file": {
        "old_path": "/old/path/name/tmp.aaaa"
      },
      "host": {
        "os": {
          "revision": "Debian"
        }
      },
      "process": {
        "parent": {
          "storyline_id": "0000000-0000-0000-00000000"
        },
        "storyline_id": "00000-0000-0000-0000000"
      }
    },
    "file": {
      "code_signature": {
        "exists": false
      },
      "created": "2024-08-05T10:11:02.250000Z",
      "directory": "/new/new/file/path",
      "name": "path",
      "path": "/new/new/file/path/path",
      "size": 750
    },
    "host": {
      "name": "aaaaaaaaa",
      "os": {
        "family": "linux",
        "name": "Linux"
      },
      "type": "server"
    },
    "observer": {
      "vendor": "SentinelOne"
    },
    "process": {
      "code_signature": {
        "exists": false
      },
      "command_line": " /usr/cmd -",
      "executable": "/usr/path",
      "hash": {
        "sha1": "aaaaaaaaaaaaaa"
      },
      "name": "aaaaa",
      "parent": {
        "code_signature": {
          "exists": false
        },
        "executable": "/bin/pparent",
        "hash": {
          "sha1": "0000000"
        },
        "name": "pname",
        "pid": 111111,
        "real_user": {
          "id": "1111",
          "name": "aaaaaaaaa"
        },
        "start": "2024-08-05T10:23:01.090000Z",
        "title": "pparent",
        "user": {
          "id": "112",
          "name": "aaaaaaaa"
        },
        "working_directory": "/bin"
      },
      "pid": 31304,
      "real_user": {
        "id": "1111",
        "name": "aaaaaaaaa"
      },
      "start": "2024-08-05T10:23:01.100000Z",
      "title": "aaaaaaaaa",
      "user": {
        "id": "1111",
        "name": "aaaaaaaa"
      },
      "working_directory": "/usr"
    },
    "related": {
      "hash": [
        "0000000",
        "aaaaaaaaaaaaaa"
      ],
      "user": [
        "aaaaaaaa"
      ]
    },
    "user": {
      "name": "aaaaaaaa"
    }
  }
}