{
  "input": {
    "message": "{\"accountId\": \"333333333333333333\", \"activityType\": 3608, \"agentId\": \"1183145065000215213\", \"agentUpdatedVersion\": null, \"applications\": null, \"comments\": null, \"createdAt\": \"2021-11-16T15:29:38.431997Z\", \"data\": {\"accountName\": \"example.com\", \"alertId\": 1290568698312097725, \"alertid\": 1290568698312097725, \"detectedat\": 1637076565467, \"dveventid\": \"\", \"dveventtype\": \"BEHAVIORALINDICATORS\", \"fullScopeDetails\": \"Group LAPTOP in Site DEFAULT of Account example.com\", \"groupName\": \"LAPTOP\", \"k8sclustername\": \"\", \"k8scontainerid\": \"\", \"k8scontainerimage\": \"\", \"k8scontainerlabels\": \"\", \"k8scontainername\": \"\", \"k8scontrollerkind\": \"\", \"k8scontrollerlabels\": \"\", \"k8scontrollername\": \"\", \"k8snamespace\": \"\", \"k8snamespacelabels\": \"\", \"k8snode\": \"\", \"k8spod\": \"\", \"k8spodlabels\": \"\", \"origagentmachinetype\": \"laptop\", \"origagentname\": \"host08.example.com\", \"origagentosfamily\": \"windows\", \"origagentosname\": \"Windows 10 Pro\", \"origagentosrevision\": \"19042\", \"origagentsiteid\": \"901144152460815495\", \"origagentuuid\": \"058fd4868adb4b87be24a4c5e9f89220\", \"origagentversion\": \"4.6.14.304\", \"ruleId\": 1259119070812474070, \"ruledescription\": \"Rule migrated from Watchlist\", \"ruleid\": 1259119070812474070, \"rulename\": \"PowershellExecutionPolicyChanged Indicator Monito\", \"rulescopeid\": 901144152460815495, \"rulescopelevel\": \"E_SITE\", \"scopeId\": 901144152460815495, \"scopeLevel\": \"Group\", \"scopeName\": \"LAPTOP\", \"severity\": \"E_MEDIUM\", \"siteName\": \"DEFAULT\", \"sourcename\": \"STAR\", \"sourceparentprocesscommandline\": \"C:\\\\WINDOWS\\\\Explorer.EXE\", \"sourceparentprocessintegritylevel\": \"medium\", \"sourceparentprocesskey\": \"811577BA383803B5\", \"sourceparentprocessmd5\": \"77777777777777777777777777777777\", \"sourceparentprocessname\": \"explorer.exe\", \"sourceparentprocesspath\": \"C:\\\\WINDOWS\\\\explorer.exe\", \"sourceparentprocesspid\": 11196, \"sourceparentprocesssha1\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", \"sourceparentprocesssha256\": \"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\", \"sourceparentprocesssigneridentity\": \"MICROSOFT WINDOWS\", \"sourceparentprocessstarttime\": 1636964894046, \"sourceparentprocessstoryline\": \"E1798FE5683F14CF\", \"sourceparentprocesssubsystem\": \"win32\", \"sourceparentprocessusername\": \"example.com\\\\testuser\", \"sourceprocesscommandline\": \"\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" \\\"-Command\\\" \\\"if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\\\\testusers\\\\testuser\\\\Documents\\\\git\\\\DSP2\\\\API HUB\\\\Documentation\\\\Generate.ps1'\\\"\", \"sourceprocessfilepath\": \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\", \"sourceprocessfilesingeridentity\": \"MICROSOFT WINDOWS\", \"sourceprocessintegritylevel\": \"medium\", \"sourceprocesskey\": \"8C3CD6D2478943E5\", \"sourceprocessmd5\": \"88888888888888888888888888888888\", \"sourceprocessname\": \"powershell.exe\", \"sourceprocesspid\": 6676, \"sourceprocesssha1\": \"9999999999999999999999999999999999999999\", \"sourceprocesssha256\": \"cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc\", \"sourceprocessstarttime\": 1637076505627, \"sourceprocessstoryline\": \"5D1F81C984CFD44D\", \"sourceprocesssubsystem\": \"win32\", \"sourceprocessusername\": \"example.com\\\\testuser\", \"systemUser\": 0, \"userId\": 111111111111111111, \"username\": \"sentinelone\"}, \"description\": null, \"groupId\": \"924347507640996620\", \"hash\": null, \"id\": \"1290568704943967230\", \"osFamily\": null, \"primaryDescription\": \"Alert created for powershell.exe from Custom Rule: PowershellExecutionPolicyChanged Indicator Monito in Group LAPTOP in Site DEFAULT of Account example.com, detected on host08.example.com.\", \"secondaryDescription\": \"9999999999999999999999999999999999999999\", \"siteId\": \"901144152460815495\", \"threatId\": null, \"updatedAt\": \"2021-11-16T15:29:38.429056Z\", \"userId\": \"111111111111111111\"}"
  },
  "expected": {
    "message": "{\"accountId\": \"333333333333333333\", \"activityType\": 3608, \"agentId\": \"1183145065000215213\", \"agentUpdatedVersion\": null, \"applications\": null, \"comments\": null, \"createdAt\": \"2021-11-16T15:29:38.431997Z\", \"data\": {\"accountName\": \"example.com\", \"alertId\": 1290568698312097725, \"alertid\": 1290568698312097725, \"detectedat\": 1637076565467, \"dveventid\": \"\", \"dveventtype\": \"BEHAVIORALINDICATORS\", \"fullScopeDetails\": \"Group LAPTOP in Site DEFAULT of Account example.com\", \"groupName\": \"LAPTOP\", \"k8sclustername\": \"\", \"k8scontainerid\": \"\", \"k8scontainerimage\": \"\", \"k8scontainerlabels\": \"\", \"k8scontainername\": \"\", \"k8scontrollerkind\": \"\", \"k8scontrollerlabels\": \"\", \"k8scontrollername\": \"\", \"k8snamespace\": \"\", \"k8snamespacelabels\": \"\", \"k8snode\": \"\", \"k8spod\": \"\", \"k8spodlabels\": \"\", \"origagentmachinetype\": \"laptop\", \"origagentname\": \"host08.example.com\", \"origagentosfamily\": \"windows\", \"origagentosname\": \"Windows 10 Pro\", \"origagentosrevision\": \"19042\", \"origagentsiteid\": \"901144152460815495\", \"origagentuuid\": \"058fd4868adb4b87be24a4c5e9f89220\", \"origagentversion\": \"4.6.14.304\", \"ruleId\": 1259119070812474070, \"ruledescription\": \"Rule migrated from Watchlist\", \"ruleid\": 1259119070812474070, \"rulename\": \"PowershellExecutionPolicyChanged Indicator Monito\", \"rulescopeid\": 901144152460815495, \"rulescopelevel\": \"E_SITE\", \"scopeId\": 901144152460815495, \"scopeLevel\": \"Group\", \"scopeName\": \"LAPTOP\", \"severity\": \"E_MEDIUM\", \"siteName\": \"DEFAULT\", \"sourcename\": \"STAR\", \"sourceparentprocesscommandline\": \"C:\\\\WINDOWS\\\\Explorer.EXE\", \"sourceparentprocessintegritylevel\": \"medium\", \"sourceparentprocesskey\": \"811577BA383803B5\", \"sourceparentprocessmd5\": \"77777777777777777777777777777777\", \"sourceparentprocessname\": \"explorer.exe\", \"sourceparentprocesspath\": \"C:\\\\WINDOWS\\\\explorer.exe\", \"sourceparentprocesspid\": 11196, \"sourceparentprocesssha1\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", \"sourceparentprocesssha256\": \"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\", \"sourceparentprocesssigneridentity\": \"MICROSOFT WINDOWS\", \"sourceparentprocessstarttime\": 1636964894046, \"sourceparentprocessstoryline\": \"E1798FE5683F14CF\", \"sourceparentprocesssubsystem\": \"win32\", \"sourceparentprocessusername\": \"example.com\\\\testuser\", \"sourceprocesscommandline\": \"\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" \\\"-Command\\\" \\\"if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\\\\testusers\\\\testuser\\\\Documents\\\\git\\\\DSP2\\\\API HUB\\\\Documentation\\\\Generate.ps1'\\\"\", \"sourceprocessfilepath\": \"C:\\\\WINDOWS\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\", \"sourceprocessfilesingeridentity\": \"MICROSOFT WINDOWS\", \"sourceprocessintegritylevel\": \"medium\", \"sourceprocesskey\": \"8C3CD6D2478943E5\", \"sourceprocessmd5\": \"88888888888888888888888888888888\", \"sourceprocessname\": \"powershell.exe\", \"sourceprocesspid\": 6676, \"sourceprocesssha1\": \"9999999999999999999999999999999999999999\", \"sourceprocesssha256\": \"cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc\", \"sourceprocessstarttime\": 1637076505627, \"sourceprocessstoryline\": \"5D1F81C984CFD44D\", \"sourceprocesssubsystem\": \"win32\", \"sourceprocessusername\": \"example.com\\\\testuser\", \"systemUser\": 0, \"userId\": 111111111111111111, \"username\": \"sentinelone\"}, \"description\": null, \"groupId\": \"924347507640996620\", \"hash\": null, \"id\": \"1290568704943967230\", \"osFamily\": null, \"primaryDescription\": \"Alert created for powershell.exe from Custom Rule: PowershellExecutionPolicyChanged Indicator Monito in Group LAPTOP in Site DEFAULT of Account example.com, detected on host08.example.com.\", \"secondaryDescription\": \"9999999999999999999999999999999999999999\", \"siteId\": \"901144152460815495\", \"threatId\": null, \"updatedAt\": \"2021-11-16T15:29:38.429056Z\", \"userId\": \"111111111111111111\"}",
    "event": {
      "action": "Custom Rules - New Alert",
      "category": [
        "intrusion_detection"
      ],
      "reason": "Alert created for powershell.exe from Custom Rule: PowershellExecutionPolicyChanged Indicator Monito in Group LAPTOP in Site DEFAULT of Account example.com, detected on host08.example.com.",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2021-11-16T15:29:38.431997Z",
    "action": {
      "type": "3608"
    },
    "agent": {
      "id": "1183145065000215213"
    },
    "file": {
      "name": "powershell.exe"
    },
    "group": {
      "id": "924347507640996620"
    },
    "host": {
      "name": "host08.example.com",
      "os": {
        "family": "windows",
        "name": "Windows 10 Pro"
      }
    },
    "organization": {
      "id": "333333333333333333"
    },
    "process": {
      "command_line": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \"-Command\" \"if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\\testusers\\testuser\\Documents\\git\\DSP2\\API HUB\\Documentation\\Generate.ps1'\"",
      "executable": "C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\powershell.exe",
      "hash": {
        "md5": "88888888888888888888888888888888",
        "sha1": "9999999999999999999999999999999999999999",
        "sha256": "cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
      },
      "name": "powershell.exe",
      "parent": {
        "code_signature": {
          "subject_name": "MICROSOFT WINDOWS"
        },
        "command_line": "C:\\WINDOWS\\Explorer.EXE",
        "executable": "C:\\WINDOWS\\explorer.exe",
        "hash": {
          "md5": "77777777777777777777777777777777",
          "sha1": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
          "sha256": "bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb"
        },
        "name": "explorer.exe",
        "pid": 11196,
        "start": "2021-11-15T08:28:14.046000Z"
      },
      "pid": 6676,
      "start": "2021-11-16T15:28:25.627000Z",
      "user": {
        "domain": "example.com",
        "name": "testuser"
      }
    },
    "related": {
      "hash": [
        "77777777777777777777777777777777",
        "88888888888888888888888888888888",
        "9999999999999999999999999999999999999999",
        "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
        "cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
      ],
      "user": [
        "testuser"
      ]
    },
    "rule": {
      "description": "Rule migrated from Watchlist",
      "id": "1259119070812474070",
      "name": "PowershellExecutionPolicyChanged Indicator Monito"
    },
    "sentinelone": {
      "createdAt": "2021-11-16T15:29:38.431997Z",
      "data": {
        "accountName": "example.com",
        "alertId": 1290568698312097725,
        "alertid": 1290568698312097725,
        "detectedat": 1637076565467,
        "dveventtype": "BEHAVIORALINDICATORS",
        "fullScopeDetails": "Group LAPTOP in Site DEFAULT of Account example.com",
        "groupName": "LAPTOP",
        "origagentmachinetype": "laptop",
        "origagentname": "host08.example.com",
        "origagentosfamily": "windows",
        "origagentosname": "Windows 10 Pro",
        "origagentosrevision": "19042",
        "origagentsiteid": 901144152460815495,
        "origagentuuid": "058fd4868adb4b87be24a4c5e9f89220",
        "origagentversion": "4.6.14.304",
        "rulescopeid": 901144152460815495,
        "rulescopelevel": "E_SITE",
        "scopeId": 901144152460815495,
        "scopeLevel": "Group",
        "scopeName": "LAPTOP",
        "severity": "E_MEDIUM",
        "siteName": "DEFAULT",
        "sourcename": "STAR",
        "sourceparentprocesscommandline": "C:\\WINDOWS\\Explorer.EXE",
        "sourceparentprocessintegritylevel": "medium",
        "sourceparentprocesskey": "811577BA383803B5",
        "sourceparentprocessmd5": "77777777777777777777777777777777",
        "sourceparentprocessname": "explorer.exe",
        "sourceparentprocesspath": "C:\\WINDOWS\\explorer.exe",
        "sourceparentprocesspid": 11196,
        "sourceparentprocesssha1": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "sourceparentprocesssha256": "bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
        "sourceparentprocesssigneridentity": "MICROSOFT WINDOWS",
        "sourceparentprocessstarttime": 1636964894046,
        "sourceparentprocessstoryline": "E1798FE5683F14CF",
        "sourceparentprocesssubsystem": "win32",
        "sourceparentprocessusername": "example.com\\testuser",
        "sourceprocesscommandline": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \"-Command\" \"if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\\testusers\\testuser\\Documents\\git\\DSP2\\API HUB\\Documentation\\Generate.ps1'\"",
        "sourceprocessfilepath": "C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\powershell.exe",
        "sourceprocessfilesingeridentity": "MICROSOFT WINDOWS",
        "sourceprocessintegritylevel": "medium",
        "sourceprocesskey": "8C3CD6D2478943E5",
        "sourceprocessmd5": "88888888888888888888888888888888",
        "sourceprocessname": "powershell.exe",
        "sourceprocesspid": 6676,
        "sourceprocesssha1": "9999999999999999999999999999999999999999",
        "sourceprocesssha256": "cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc",
        "sourceprocessstarttime": 1637076505627,
        "sourceprocessstoryline": "5D1F81C984CFD44D",
        "sourceprocesssubsystem": "win32",
        "sourceprocessusername": "example.com\\testuser",
        "systemUser": 0,
        "userId": 111111111111111111
      },
      "eventid": 1290568704943967230,
      "secondaryDescription": "9999999999999999999999999999999999999999",
      "siteId": 901144152460815495,
      "updatedAt": "2021-11-16T15:29:38.429056Z"
    },
    "user": {
      "name": "testuser"
    }
  }
}