{
  "input": {
    "message": "{\"time\": \"2025-10-24T09:44:46.9278379Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-MessagePostDeliveryEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:43:16.2740000Z\", \"properties\": {\"Timestamp\": \"2025-10-24T09:43:16.274Z\", \"TeamsMessageId\": \"/chats/mythreadid/messages/1111111111111\", \"Action\": \"Blocked\", \"ActionType\": \"Manual remediation\", \"ActionTrigger\": \"SpecialAction\", \"ActionResult\": \"Success\", \"SenderEmailAddress\": \"john.doe@example.com\", \"RecipientDetails\": [{\"RecipientSmtpAddress\": \"jane.doe@example.org\", \"RecipientDisplayName\": \"DOE, Jane\", \"RecipientObjectId\": \"00000000-0000-0000-0000-000000000000\", \"RecipientType\": \"User\"}], \"ThreadTypes\": \"malware\", \"ConfidenceLevel\": null, \"DetectionMethods\": null, \"LatestDeliveryLocation\": \"Teams\", \"ReportId\": \"00000000-0000-0000-0000-000000000000\", \"IsExternalThread\": false}, \"Tenant\": \"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\": \"2025-10-24T09:44:46.9278379Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-MessagePostDeliveryEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:43:16.2740000Z\", \"properties\": {\"Timestamp\": \"2025-10-24T09:43:16.274Z\", \"TeamsMessageId\": \"/chats/mythreadid/messages/1111111111111\", \"Action\": \"Blocked\", \"ActionType\": \"Manual remediation\", \"ActionTrigger\": \"SpecialAction\", \"ActionResult\": \"Success\", \"SenderEmailAddress\": \"john.doe@example.com\", \"RecipientDetails\": [{\"RecipientSmtpAddress\": \"jane.doe@example.org\", \"RecipientDisplayName\": \"DOE, Jane\", \"RecipientObjectId\": \"00000000-0000-0000-0000-000000000000\", \"RecipientType\": \"User\"}], \"ThreadTypes\": \"malware\", \"ConfidenceLevel\": null, \"DetectionMethods\": null, \"LatestDeliveryLocation\": \"Teams\", \"ReportId\": \"00000000-0000-0000-0000-000000000000\", \"IsExternalThread\": false}, \"Tenant\": \"DefaultTenant\"}",
    "event": {
      "action": "Blocked",
      "dataset": "message_post_delivery_events",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-10-24T09:43:16.274000Z",
    "action": {
      "properties": {
        "ActionResult": "Success",
        "ActionTrigger": "SpecialAction",
        "IsExternalThread": false,
        "LatestDeliveryLocation": "Teams",
        "RecipientDetails": [
          {
            "RecipientDisplayName": "DOE, Jane",
            "RecipientObjectId": "00000000-0000-0000-0000-000000000000",
            "RecipientSmtpAddress": "jane.doe@example.org",
            "RecipientType": "User"
          }
        ],
        "SenderEmailAddress": "john.doe@example.com"
      },
      "type": "Manual remediation"
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "00000000-0000-0000-0000-000000000000"
        }
      }
    }
  }
}