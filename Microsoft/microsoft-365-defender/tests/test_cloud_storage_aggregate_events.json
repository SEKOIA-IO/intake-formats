{
  "input": {
    "message": "{\"time\": \"2025-10-24T09:33:37.8503491Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudStorageAggregatedEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:33:35.0911634Z\", \"properties\": {\"DataAggregationStartTime\": \"2025-10-24T08:00:00Z\", \"DataAggregationEndTime\": \"2025-10-24T09:00:00Z\", \"DataSource\": \"Azure Storage\", \"SubscriptionId\": \"00000000-0000-0000-0000-000000000000\", \"ResourceGroup\": \"my-rsg\", \"StorageAccount\": \"mystorageaccount\", \"StorageContainer\": null, \"StorageFileShare\": null, \"ServiceType\": \"Files.SMB\", \"IPAddress\": \"8.7.6.5\", \"UserAgentHeader\": \"\", \"OperationNamesList\": [\"SessionSetup\"], \"AuthenticationType\": \"Kerberos\", \"AccountObjectId\": null, \"AccountTenantId\": null, \"AccountApplicationId\": null, \"AccountUpn\": null, \"AccountType\": \"\", \"OperationsCount\": 1, \"SuccessfulOperationsCount\": 1, \"FailedOperationsCount\": 0, \"TotalResponseLength\": 0, \"SuccessfulReadOperations\": null, \"DistinctGetOperations\": 0, \"AnonymousSuccessfulOperations\": null, \"HasAnonymousResourceNotFoundFailures\": null, \"Md5Hashes\": [], \"AzureResourceId\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-rsg/providers/Microsoft.Storage/storageAccounts/mystorageaccount\", \"Location\": \"centraleurope\", \"ActionType\": \"Data Aggregation\", \"AdditionalFields\": {\"FirstEventTimestamp\": \"2025-10-24T08:49:03.343374Z\", \"LastEventTimestamp\": \"2025-10-24T08:49:03.343374Z\", \"ClientCloudPlatformName\": \"N/A\", \"IsTorExitNode\": false, \"IsKnownSuspiciousIp\": false, \"IsPrivateIp\": true}, \"Timestamp\": \"2025-10-24T09:32:14.353694Z\", \"ReportId\": \"00000000-0000-0000-0000-000000000000\"}, \"Tenant\": \"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\": \"2025-10-24T09:33:37.8503491Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudStorageAggregatedEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:33:35.0911634Z\", \"properties\": {\"DataAggregationStartTime\": \"2025-10-24T08:00:00Z\", \"DataAggregationEndTime\": \"2025-10-24T09:00:00Z\", \"DataSource\": \"Azure Storage\", \"SubscriptionId\": \"00000000-0000-0000-0000-000000000000\", \"ResourceGroup\": \"my-rsg\", \"StorageAccount\": \"mystorageaccount\", \"StorageContainer\": null, \"StorageFileShare\": null, \"ServiceType\": \"Files.SMB\", \"IPAddress\": \"8.7.6.5\", \"UserAgentHeader\": \"\", \"OperationNamesList\": [\"SessionSetup\"], \"AuthenticationType\": \"Kerberos\", \"AccountObjectId\": null, \"AccountTenantId\": null, \"AccountApplicationId\": null, \"AccountUpn\": null, \"AccountType\": \"\", \"OperationsCount\": 1, \"SuccessfulOperationsCount\": 1, \"FailedOperationsCount\": 0, \"TotalResponseLength\": 0, \"SuccessfulReadOperations\": null, \"DistinctGetOperations\": 0, \"AnonymousSuccessfulOperations\": null, \"HasAnonymousResourceNotFoundFailures\": null, \"Md5Hashes\": [], \"AzureResourceId\": \"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-rsg/providers/Microsoft.Storage/storageAccounts/mystorageaccount\", \"Location\": \"centraleurope\", \"ActionType\": \"Data Aggregation\", \"AdditionalFields\": {\"FirstEventTimestamp\": \"2025-10-24T08:49:03.343374Z\", \"LastEventTimestamp\": \"2025-10-24T08:49:03.343374Z\", \"ClientCloudPlatformName\": \"N/A\", \"IsTorExitNode\": false, \"IsKnownSuspiciousIp\": false, \"IsPrivateIp\": true}, \"Timestamp\": \"2025-10-24T09:32:14.353694Z\", \"ReportId\": \"00000000-0000-0000-0000-000000000000\"}, \"Tenant\": \"DefaultTenant\"}",
    "event": {
      "category": [
        "network"
      ],
      "dataset": "cloud_storage_aggregate_events",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-10-24T09:32:14.353694Z",
    "action": {
      "properties": {
        "AuthenticationType": "Kerberos",
        "AzureResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-rsg/providers/Microsoft.Storage/storageAccounts/mystorageaccount",
        "DataSource": "Azure Storage",
        "DistinctGetOperations": 0,
        "FailedOperationsCount": 0,
        "Location": "centraleurope",
        "OperationNamesList": [
          "SessionSetup"
        ],
        "OperationsCount": 1,
        "ResourceGroup": "my-rsg",
        "ServiceType": "Files.SMB",
        "StorageAccount": "mystorageaccount",
        "SubscriptionId": "00000000-0000-0000-0000-000000000000",
        "SuccessfulOperationsCount": 1
      },
      "type": "Data Aggregation"
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "00000000-0000-0000-0000-000000000000"
        }
      }
    },
    "related": {
      "ip": [
        "8.7.6.5"
      ]
    },
    "source": {
      "address": "8.7.6.5",
      "ip": "8.7.6.5"
    }
  }
}