{
  "input": {
    "message": "{\"time\":\"2024-09-24T14:19:47.7143361Z\",\"tenantId\":\"16ffffff-0000-3333-8888-addddddddd\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"_TimeReceivedBySvc\":\"2024-09-24T14:18:24.0670725Z\",\"properties\":{\"InitiatingProcessSHA1\":\"ff77777000aaaaaaaaaffb100000c0fb25ccccc6\",\"InitiatingProcessFileSize\":11864,\"InitiatingProcessMD5\":\"eeeee2999444ddaaaaa08598b06eafe7\",\"InitiatingProcessFileName\":\"platform-python3.6\",\"InitiatingProcessParentFileName\":\"platform-python3.6\",\"InitiatingProcessFolderPath\":\"/usr/test/platform-python3.6\",\"InitiatingProcessCommandLine\":\"/usr/test/platform-python /usr/lib/python3.6/run.py --register\",\"SHA1\":\"ff000000000aaaaaaaaaffb100000c0fb25ccccc6\",\"FileSize\":193333,\"MD5\":\"ff000000000aaaaaaaaaffb100000c0fb25ccccc6\",\"FolderPath\":\"/usr/bin/grep\",\"ProcessCommandLine\":\"grep -F smtpd_tls_protocols\\\\commandtest\",\"FileName\":\"grep\",\"ProcessId\":408996,\"InitiatingProcessId\":408996,\"ProcessCreationTime\":\"2024-09-24T14:18:11.864114Z\",\"DeviceName\":\"testDevice\",\"DeviceId\":\"123412341234123412341234\",\"InitiatingProcessCreationTime\":\"2024-09-24T14:18:11.85Z\",\"InitiatingProcessAccountName\":\"testaccount\",\"InitiatingProcessAccountDomain\":\"testdomain\",\"InitiatingProcessAccountSid\":null,\"InitiatingProcessSignatureStatus\":\"Unknown\",\"InitiatingProcessSignerType\":\"Unknown\",\"InitiatingProcessParentId\":408229,\"ReportId\":49226,\"InitiatingProcessParentCreationTime\":\"2024-09-24T14:17:34.79Z\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"AccountDomain\":\"testDomain\",\"AccountName\":\"testaccount\",\"ProcessTokenElevation\":\"None\",\"ProcessIntegrityLevel\":null,\"AccountSid\":null,\"AppGuardContainerId\":null,\"SHA256\":\"8def33333333643356354032379388263138839b9503f269f82e978413d669a0\",\"InitiatingProcessSHA256\":\"3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565\",\"InitiatingProcessLogonId\":0,\"LogonId\":0,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":\"{\\\"InitiatingProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"testDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixProcessGroupId\\\":408125,\\\"InitiatingProcessPosixSessionId\\\":0,\\\"InitiatingProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"InitiatingProcessPosixUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixRealUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"ProcessPosixProcessGroupId\\\":408125,\\\"ProcessPosixSessionId\\\":408125,\\\"ProcessCurrentWorkingDirectory\\\":\\\"/testname\\\",\\\"ProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"ProcessPosixFileUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixFileGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}}\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"ProcessVersionInfoCompanyName\":null,\"ProcessVersionInfoProductName\":null,\"ProcessVersionInfoProductVersion\":null,\"ProcessVersionInfoInternalFileName\":null,\"ProcessVersionInfoOriginalFileName\":null,\"ProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"CreatedProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"ActionType\":\"ProcessCreated\",\"Timestamp\":\"2024-09-24T14:18:11.864114Z\",\"MachineGroup\":\"test Group\"},\"Tenant\":\"DefaultTenant\"}",
    "sekoiaio": {
      "intake": {
        "dialect": "Microsoft 365 Defender",
        "dialect_uuid": "05e6f36d-cee0-4f06-b575-9e43af779f9f"
      }
    }
  },
  "expected": {
    "message": "{\"time\":\"2024-09-24T14:19:47.7143361Z\",\"tenantId\":\"16ffffff-0000-3333-8888-addddddddd\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"_TimeReceivedBySvc\":\"2024-09-24T14:18:24.0670725Z\",\"properties\":{\"InitiatingProcessSHA1\":\"ff77777000aaaaaaaaaffb100000c0fb25ccccc6\",\"InitiatingProcessFileSize\":11864,\"InitiatingProcessMD5\":\"eeeee2999444ddaaaaa08598b06eafe7\",\"InitiatingProcessFileName\":\"platform-python3.6\",\"InitiatingProcessParentFileName\":\"platform-python3.6\",\"InitiatingProcessFolderPath\":\"/usr/test/platform-python3.6\",\"InitiatingProcessCommandLine\":\"/usr/test/platform-python /usr/lib/python3.6/run.py --register\",\"SHA1\":\"ff000000000aaaaaaaaaffb100000c0fb25ccccc6\",\"FileSize\":193333,\"MD5\":\"ff000000000aaaaaaaaaffb100000c0fb25ccccc6\",\"FolderPath\":\"/usr/bin/grep\",\"ProcessCommandLine\":\"grep -F smtpd_tls_protocols\\\\commandtest\",\"FileName\":\"grep\",\"ProcessId\":408996,\"InitiatingProcessId\":408996,\"ProcessCreationTime\":\"2024-09-24T14:18:11.864114Z\",\"DeviceName\":\"testDevice\",\"DeviceId\":\"123412341234123412341234\",\"InitiatingProcessCreationTime\":\"2024-09-24T14:18:11.85Z\",\"InitiatingProcessAccountName\":\"testaccount\",\"InitiatingProcessAccountDomain\":\"testdomain\",\"InitiatingProcessAccountSid\":null,\"InitiatingProcessSignatureStatus\":\"Unknown\",\"InitiatingProcessSignerType\":\"Unknown\",\"InitiatingProcessParentId\":408229,\"ReportId\":49226,\"InitiatingProcessParentCreationTime\":\"2024-09-24T14:17:34.79Z\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"AccountDomain\":\"testDomain\",\"AccountName\":\"testaccount\",\"ProcessTokenElevation\":\"None\",\"ProcessIntegrityLevel\":null,\"AccountSid\":null,\"AppGuardContainerId\":null,\"SHA256\":\"8def33333333643356354032379388263138839b9503f269f82e978413d669a0\",\"InitiatingProcessSHA256\":\"3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565\",\"InitiatingProcessLogonId\":0,\"LogonId\":0,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":\"{\\\"InitiatingProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"testDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixProcessGroupId\\\":408125,\\\"InitiatingProcessPosixSessionId\\\":0,\\\"InitiatingProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"InitiatingProcessPosixUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixRealUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"ProcessPosixProcessGroupId\\\":408125,\\\"ProcessPosixSessionId\\\":408125,\\\"ProcessCurrentWorkingDirectory\\\":\\\"/testname\\\",\\\"ProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"ProcessPosixFileUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixFileGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}}\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"ProcessVersionInfoCompanyName\":null,\"ProcessVersionInfoProductName\":null,\"ProcessVersionInfoProductVersion\":null,\"ProcessVersionInfoInternalFileName\":null,\"ProcessVersionInfoOriginalFileName\":null,\"ProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"CreatedProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"ActionType\":\"ProcessCreated\",\"Timestamp\":\"2024-09-24T14:18:11.864114Z\",\"MachineGroup\":\"test Group\"},\"Tenant\":\"DefaultTenant\"}",
    "event": {
      "category": [
        "process"
      ],
      "dataset": "device_process_events",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2024-09-24T14:18:11.864114Z",
    "action": {
      "properties": {
        "InitiatingProcessCommandLine": "/usr/test/platform-python /usr/lib/python3.6/run.py --register",
        "InitiatingProcessFileSize": 11864,
        "InitiatingProcessLogonId": "0",
        "InitiatingProcessParentFileName": "platform-python3.6",
        "LogonId": "0"
      },
      "type": "ProcessCreated"
    },
    "file": {
      "directory": "/usr/bin/grep",
      "hash": {
        "md5": "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
        "sha1": "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
        "sha256": "8def33333333643356354032379388263138839b9503f269f82e978413d669a0"
      },
      "name": "grep",
      "size": 193333
    },
    "host": {
      "id": "123412341234123412341234",
      "name": "testDevice",
      "os": {
        "type": "linux"
      }
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "49226"
        }
      }
    },
    "process": {
      "args": [
        "-F",
        "smtpd_tls_protocols\\commandtest"
      ],
      "command_line": "grep -F smtpd_tls_protocols\\commandtest",
      "executable": "/usr/bin/grep",
      "name": "grep",
      "parent": {
        "args": [
          "--register",
          "/usr/lib/python3.6/run.py"
        ],
        "code_signature": {
          "status": "Unknown",
          "subject_name": "Unknown"
        },
        "command_line": "/usr/test/platform-python /usr/lib/python3.6/run.py --register",
        "executable": "/usr/test/platform-python3.6",
        "hash": {
          "md5": "eeeee2999444ddaaaaa08598b06eafe7",
          "sha1": "ff77777000aaaaaaaaaffb100000c0fb25ccccc6",
          "sha256": "3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565"
        },
        "name": "platform-python3.6",
        "pid": 408996,
        "start": "2024-09-24T14:18:11.850000Z",
        "user": {
          "domain": "testdomain",
          "name": "testaccount"
        },
        "working_directory": "/usr/test"
      },
      "pid": 408996,
      "start": "2024-09-24T14:18:11.864114Z",
      "working_directory": "/usr/bin"
    },
    "related": {
      "hash": [
        "3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565",
        "8def33333333643356354032379388263138839b9503f269f82e978413d669a0",
        "eeeee2999444ddaaaaa08598b06eafe7",
        "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
        "ff77777000aaaaaaaaaffb100000c0fb25ccccc6"
      ],
      "user": [
        "testaccount"
      ]
    },
    "user": {
      "domain": "testDomain",
      "name": "testaccount"
    }
  }
}