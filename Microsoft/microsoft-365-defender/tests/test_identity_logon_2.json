{
  "input": {
    "message": "{\"time\": \"2024-10-03T11:27:16.2140248Z\", \"tenantId\": \"33333333-3333-3333-3333-333333333333\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityLogonEvents\", \"_TimeReceivedBySvc\": \"2024-10-03T11:24:42.5340000Z\", \"properties\": {\"ActionType\": \"LogonSuccess\", \"LogonType\": \"OAuth2:Authorize\", \"Protocol\": null, \"AccountDisplayName\": \"John DOE\", \"AccountUpn\": \"john.doe@example.com\", \"AccountName\": \"john.doe\", \"AccountDomain\": \"example.com\", \"AccountSid\": null, \"AccountObjectId\": \"11111111-1111-1111-1111-111111111111\", \"IPAddress\": \"1.1.1.1\", \"Location\": \"FR\", \"DeviceName\": null, \"OSPlatform\": \"Windows 10\", \"DeviceType\": \"Desktop\", \"ISP\": \"neoma business school\", \"DestinationDeviceName\": null, \"TargetDeviceName\": null, \"FailureReason\": null, \"Port\": null, \"DestinationPort\": null, \"DestinationIPAddress\": null, \"TargetAccountDisplayName\": null, \"AdditionalFields\": {\"ACTOR.ENTITY_USER\": \"John DOE\", \"ACTOR.ALIAS\": \"John DOE\", \"ARG.CLOUD_SERVICE\": \"Editor Browser Extension\", \"Pass-through authentication\": \"false\", \"Request ID\": \"22222222-2222-2222-2222-222222222222\"}, \"ReportId\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"Timestamp\": \"2024-10-03T11:23:16.963Z\", \"Application\": \"Microsoft 365\"}, \"Tenant\": \"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\": \"2024-10-03T11:27:16.2140248Z\", \"tenantId\": \"33333333-3333-3333-3333-333333333333\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityLogonEvents\", \"_TimeReceivedBySvc\": \"2024-10-03T11:24:42.5340000Z\", \"properties\": {\"ActionType\": \"LogonSuccess\", \"LogonType\": \"OAuth2:Authorize\", \"Protocol\": null, \"AccountDisplayName\": \"John DOE\", \"AccountUpn\": \"john.doe@example.com\", \"AccountName\": \"john.doe\", \"AccountDomain\": \"example.com\", \"AccountSid\": null, \"AccountObjectId\": \"11111111-1111-1111-1111-111111111111\", \"IPAddress\": \"1.1.1.1\", \"Location\": \"FR\", \"DeviceName\": null, \"OSPlatform\": \"Windows 10\", \"DeviceType\": \"Desktop\", \"ISP\": \"neoma business school\", \"DestinationDeviceName\": null, \"TargetDeviceName\": null, \"FailureReason\": null, \"Port\": null, \"DestinationPort\": null, \"DestinationIPAddress\": null, \"TargetAccountDisplayName\": null, \"AdditionalFields\": {\"ACTOR.ENTITY_USER\": \"John DOE\", \"ACTOR.ALIAS\": \"John DOE\", \"ARG.CLOUD_SERVICE\": \"Editor Browser Extension\", \"Pass-through authentication\": \"false\", \"Request ID\": \"22222222-2222-2222-2222-222222222222\"}, \"ReportId\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"Timestamp\": \"2024-10-03T11:23:16.963Z\", \"Application\": \"Microsoft 365\"}, \"Tenant\": \"DefaultTenant\"}",
    "event": {
      "category": [
        "authentication"
      ],
      "dataset": "identity_logon_events",
      "outcome": "success",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2024-10-03T11:23:16.963000Z",
    "action": {
      "name": "Publish",
      "properties": {
        "AccountUPN": "john.doe@example.com",
        "Application": "Microsoft 365",
        "ISP": "neoma business school",
        "Location": "FR",
        "LogonType": "OAuth2:Authorize"
      },
      "type": "LogonSuccess"
    },
    "host": {
      "os": {
        "full": "Windows 10"
      },
      "type": "Desktop"
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
        }
      }
    },
    "related": {
      "ip": [
        "1.1.1.1"
      ],
      "user": [
        "john.doe"
      ]
    },
    "source": {
      "address": "1.1.1.1",
      "ip": "1.1.1.1"
    },
    "user": {
      "domain": "example.com",
      "full_name": "John DOE",
      "name": "john.doe"
    }
  }
}