{
  "input": {
    "message": "{\"time\": \"2025-10-24T09:44:46.9278379Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-MessageEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:43:16.2740000Z\", \"properties\": {\"Timestamp\": \"2025-10-24T09:43:16.274Z\", \"LastEditedTime\": \"2025-10-24T09:43:16.274Z\", \"TeamsMessageId\": \"/chats/mythreadid/messages/1111111111111\", \"SenderEmailAddress\": \"john.doe@example.com\", \"SenderDisplayName\": \"DOE, John\", \"SenderObjectId\": \"00000000-0000-0000-0000-000000000000\", \"SenderType\": \"User\", \"RecipientDetails\": [{\"RecipientSmtpAddress\": \"jane.doe@example.org\", \"RecipientDisplayName\": \"DOE, Jane\", \"RecipientObjectId\": \"00000000-0000-0000-0000-000000000000\", \"RecipientType\": \"User\"}], \"IsOwnedThread\": true, \"MessageId\": \"1111111111111\", \"ParentMessageId\": \"1111111111111\", \"GroupId\": null, \"GroupName\": null, \"ThreadId\": \"mythreadid\", \"ThreadName\": null, \"ThreadType\": \"chat\", \"ThreadSubType\": \"None\", \"IsExternalThread\": false, \"MessageType\": \"RichText\", \"MessageSubtype\": \"Html\", \"MessageVersion\": \"1111111111111\", \"Subject\": null, \"ThreatTypes\": null, \"DetectionMethods\": null, \"ConfidenceLevel\": null, \"DeliveryAction\": \"Delivered\", \"DeliveryLocation\": \"Teams\", \"ReportId\": \"00000000-0000-0000-0000-000000000000\"}, \"Tenant\": \"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\": \"2025-10-24T09:44:46.9278379Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-MessageEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:43:16.2740000Z\", \"properties\": {\"Timestamp\": \"2025-10-24T09:43:16.274Z\", \"LastEditedTime\": \"2025-10-24T09:43:16.274Z\", \"TeamsMessageId\": \"/chats/mythreadid/messages/1111111111111\", \"SenderEmailAddress\": \"john.doe@example.com\", \"SenderDisplayName\": \"DOE, John\", \"SenderObjectId\": \"00000000-0000-0000-0000-000000000000\", \"SenderType\": \"User\", \"RecipientDetails\": [{\"RecipientSmtpAddress\": \"jane.doe@example.org\", \"RecipientDisplayName\": \"DOE, Jane\", \"RecipientObjectId\": \"00000000-0000-0000-0000-000000000000\", \"RecipientType\": \"User\"}], \"IsOwnedThread\": true, \"MessageId\": \"1111111111111\", \"ParentMessageId\": \"1111111111111\", \"GroupId\": null, \"GroupName\": null, \"ThreadId\": \"mythreadid\", \"ThreadName\": null, \"ThreadType\": \"chat\", \"ThreadSubType\": \"None\", \"IsExternalThread\": false, \"MessageType\": \"RichText\", \"MessageSubtype\": \"Html\", \"MessageVersion\": \"1111111111111\", \"Subject\": null, \"ThreatTypes\": null, \"DetectionMethods\": null, \"ConfidenceLevel\": null, \"DeliveryAction\": \"Delivered\", \"DeliveryLocation\": \"Teams\", \"ReportId\": \"00000000-0000-0000-0000-000000000000\"}, \"Tenant\": \"DefaultTenant\"}",
    "event": {
      "action": "Delivered",
      "dataset": "message_events",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-10-24T09:43:16.274000Z",
    "action": {
      "properties": {
        "DeliveryAction": "Delivered",
        "DeliveryLocation": "Teams",
        "IsExternalThread": false,
        "IsOwnedThread": true,
        "MessageId": "1111111111111",
        "ParentMessageId": "1111111111111",
        "RecipientDetails": [
          {
            "RecipientDisplayName": "DOE, Jane",
            "RecipientObjectId": "00000000-0000-0000-0000-000000000000",
            "RecipientSmtpAddress": "jane.doe@example.org",
            "RecipientType": "User"
          }
        ],
        "SenderDisplayName": "DOE, John",
        "SenderEmailAddress": "john.doe@example.com",
        "SenderObjectId": "00000000-0000-0000-0000-000000000000",
        "SenderType": "User",
        "TeamsMessageId": "/chats/mythreadid/messages/1111111111111",
        "ThreadId": "mythreadid"
      }
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "00000000-0000-0000-0000-000000000000"
        }
      }
    }
  }
}