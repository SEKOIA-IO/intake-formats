{
  "input": {
    "message": "{\"time\":\"2025-07-11T08:56:07.6459371Z\",\"tenantId\":\"f47ac10b-58cc-4372-a567-0e02b2c3d479\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2025-07-11T08:55:46.0035231Z\",\"properties\":{\"DeviceId\":\"a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2\",\"DeviceName\":\"example.com\",\"ReportId\":545956,\"InitiatingProcessId\":11948,\"InitiatingProcessCreationTime\":\"2025-07-11T08:52:42.1499232Z\",\"InitiatingProcessCommandLine\":\"\\\"mmc.exe\\\" C:\\\\Windows\\\\system32\\\\dnsmgmt.msc\",\"InitiatingProcessParentFileName\":\"svchost.exe\",\"InitiatingProcessParentId\":8568,\"InitiatingProcessParentCreationTime\":\"2025-07-10T08:08:33.9948453Z\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"mmc.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\mmc.exe\",\"InitiatingProcessAccountName\":\"j.doe\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":null,\"InitiatingProcessAccountSid\":\"user1\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"ScreenshotTaken\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":183710153,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"j.doe@acme-internal.net\",\"InitiatingProcessAccountObjectId\":null,\"FileSize\":null,\"InitiatingProcessFileSize\":1929216,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\\u00ae Windows\\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"10.0.20348.3804\",\"InitiatingProcessVersionInfoInternalFileName\":\"mmc.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"mmc.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Management Console\",\"InitiatingProcessSessionId\":\"00000000-0000-0000-0000-000000000000\",\"IsInitiatingProcessRemoteSession\":true,\"InitiatingProcessRemoteSessionDeviceName\":\"example.com\",\"InitiatingProcessRemoteSessionIP\":\"192.168.1.105\",\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"9007199254748871\",\"Timestamp\":\"2025-07-11T08:54:06.8522256Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\":\"2025-07-11T08:56:07.6459371Z\",\"tenantId\":\"f47ac10b-58cc-4372-a567-0e02b2c3d479\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2025-07-11T08:55:46.0035231Z\",\"properties\":{\"DeviceId\":\"a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2\",\"DeviceName\":\"example.com\",\"ReportId\":545956,\"InitiatingProcessId\":11948,\"InitiatingProcessCreationTime\":\"2025-07-11T08:52:42.1499232Z\",\"InitiatingProcessCommandLine\":\"\\\"mmc.exe\\\" C:\\\\Windows\\\\system32\\\\dnsmgmt.msc\",\"InitiatingProcessParentFileName\":\"svchost.exe\",\"InitiatingProcessParentId\":8568,\"InitiatingProcessParentCreationTime\":\"2025-07-10T08:08:33.9948453Z\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"mmc.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\mmc.exe\",\"InitiatingProcessAccountName\":\"j.doe\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":null,\"InitiatingProcessAccountSid\":\"user1\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"ScreenshotTaken\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":183710153,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"j.doe@acme-internal.net\",\"InitiatingProcessAccountObjectId\":null,\"FileSize\":null,\"InitiatingProcessFileSize\":1929216,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\\u00ae Windows\\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"10.0.20348.3804\",\"InitiatingProcessVersionInfoInternalFileName\":\"mmc.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"mmc.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Management Console\",\"InitiatingProcessSessionId\":\"00000000-0000-0000-0000-000000000000\",\"IsInitiatingProcessRemoteSession\":true,\"InitiatingProcessRemoteSessionDeviceName\":\"example.com\",\"InitiatingProcessRemoteSessionIP\":\"192.168.1.105\",\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"9007199254748871\",\"Timestamp\":\"2025-07-11T08:54:06.8522256Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}",
    "event": {
      "category": [
        "host"
      ],
      "dataset": "device_events",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-07-11T08:54:06.852225Z",
    "action": {
      "name": "Publish",
      "properties": {
        "InitiatingProcessCommandLine": "\"mmc.exe\" C:\\Windows\\system32\\dnsmgmt.msc",
        "InitiatingProcessFileSize": 1929216,
        "InitiatingProcessLogonId": "183710153",
        "InitiatingProcessSessionId": "00000000-0000-0000-0000-000000000000",
        "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
        "InitiatingProcessVersionInfoFileDescription": "Microsoft Management Console",
        "InitiatingProcessVersionInfoInternalFileName": "mmc.exe",
        "InitiatingProcessVersionInfoOriginalFileName": "mmc.exe",
        "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
        "InitiatingProcessVersionInfoProductVersion": "10.0.20348.3804",
        "IsInitiatingProcessRemoteSession": "true"
      },
      "type": "ScreenshotTaken"
    },
    "host": {
      "id": "a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2",
      "name": "example.com"
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "545956"
        }
      }
    },
    "process": {
      "args": [
        "C:\\Windows\\system32\\dnsmgmt.msc"
      ],
      "command_line": "\"mmc.exe\" C:\\Windows\\system32\\dnsmgmt.msc",
      "executable": "c:\\windows\\system32\\mmc.exe",
      "hash": {
        "md5": "68b329da9893e34099c7d8ad5cb9c940",
        "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
        "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
      },
      "name": "mmc.exe",
      "parent": {
        "name": "svchost.exe",
        "pid": 8568,
        "start": "2025-07-10T08:08:33.994845Z"
      },
      "pid": 11948,
      "start": "2025-07-11T08:52:42.149923Z",
      "user": {
        "domain": "example.com",
        "email": "j.doe@acme-internal.net",
        "id": "00000000-0000-0000-0000-000000000000",
        "name": "j.doe"
      },
      "working_directory": "c:\\windows\\system32"
    },
    "related": {
      "hash": [
        "b581f3f814f1eedac6fde28ffbac6725",
        "e67fccac1d9cf7398ff37e3864bddfbd83f076d99e25739d7856956b9e61bf4",
        "e780f205ceadaf2db75cf8b547b8cc02592caec9"
      ],
      "hosts": [
        "remote-cli-22"
      ],
      "ip": [
        "192.168.1.105"
      ]
    },
    "source": {
      "address": "remote-cli-22",
      "domain": "example.com",
      "ip": "192.168.1.105"
    }
  }
}
