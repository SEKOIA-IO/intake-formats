{
  "input": {
    "message": "{\"time\": \"2025-10-06T06:24:57.1637130Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudProcessEvents\", \"_TimeReceivedBySvc\": \"2025-10-06T06:24:54.0067997Z\", \"properties\": {\"AzureResourceId\": \"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/rg-pf-dmp-stg/providers/Microsoft.ContainerService/managedClusters/CLUSTER\", \"AwsResourceName\": null, \"GcpFullResourceName\": null, \"ContainerImageName\": \":\", \"KubernetesNamespace\": null, \"KubernetesPodName\": null, \"KubernetesResource\": \"\", \"ContainerName\": \"host\", \"ContainerId\": null, \"ActionType\": \"ProcessCreated\", \"FileName\": \"/usr/bin/bash\", \"FolderPath\": \"/usr/bin/bash\", \"ProcessId\": 123, \"ProcessName\": \"bash\", \"ParentProcessName\": \"check_terminate\", \"ParentProcessId\": 456, \"ProcessCommandLine\": \"/etc/node-problem-detector.d/plugin/check_scheduledevent.sh -t Terminate -m 54\", \"ProcessCreationTime\": \"2025-10-06T06:24:04.3899689Z\", \"ProcessCurrentWorkingDirectory\": \"/\", \"AccountName\": \"root\", \"LogonId\": 123456789, \"InitiatingProcessId\": 456, \"AdditionalFields\": {\"uid\": \"0\", \"gid\": \"0\", \"group\": \"root\", \"audit_user\": null, \"auid\": \"123456789\", \"UpperLayer\": \"False\", \"Memfd\": \"False\", \"DriftAction\": \"n/a\"}, \"Timestamp\": \"2025-10-06T06:24:04.3899689Z\", \"ReportId\": \"22222222-2222-2222-2222-222222222222\"}, \"Tenant\": \"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\": \"2025-10-06T06:24:57.1637130Z\", \"tenantId\": \"00000000-0000-0000-0000-000000000000\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudProcessEvents\", \"_TimeReceivedBySvc\": \"2025-10-06T06:24:54.0067997Z\", \"properties\": {\"AzureResourceId\": \"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/rg-pf-dmp-stg/providers/Microsoft.ContainerService/managedClusters/CLUSTER\", \"AwsResourceName\": null, \"GcpFullResourceName\": null, \"ContainerImageName\": \":\", \"KubernetesNamespace\": null, \"KubernetesPodName\": null, \"KubernetesResource\": \"\", \"ContainerName\": \"host\", \"ContainerId\": null, \"ActionType\": \"ProcessCreated\", \"FileName\": \"/usr/bin/bash\", \"FolderPath\": \"/usr/bin/bash\", \"ProcessId\": 123, \"ProcessName\": \"bash\", \"ParentProcessName\": \"check_terminate\", \"ParentProcessId\": 456, \"ProcessCommandLine\": \"/etc/node-problem-detector.d/plugin/check_scheduledevent.sh -t Terminate -m 54\", \"ProcessCreationTime\": \"2025-10-06T06:24:04.3899689Z\", \"ProcessCurrentWorkingDirectory\": \"/\", \"AccountName\": \"root\", \"LogonId\": 123456789, \"InitiatingProcessId\": 456, \"AdditionalFields\": {\"uid\": \"0\", \"gid\": \"0\", \"group\": \"root\", \"audit_user\": null, \"auid\": \"123456789\", \"UpperLayer\": \"False\", \"Memfd\": \"False\", \"DriftAction\": \"n/a\"}, \"Timestamp\": \"2025-10-06T06:24:04.3899689Z\", \"ReportId\": \"22222222-2222-2222-2222-222222222222\"}, \"Tenant\": \"DefaultTenant\"}",
    "event": {
      "category": [
        "process"
      ],
      "dataset": "cloud_process_events",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-10-06T06:24:04.389968Z",
    "action": {
      "properties": {
        "ActionType": "ProcessCreated",
        "AzureResourceId": "/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/rg-pf-dmp-stg/providers/Microsoft.ContainerService/managedClusters/CLUSTER",
        "ContainerImageName": ":",
        "ContainerName": "host",
        "LogonId": "123456789"
      },
      "type": "ProcessCreated"
    },
    "file": {
      "directory": "/usr/bin/bash",
      "name": "/usr/bin/bash"
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "22222222-2222-2222-2222-222222222222"
        }
      }
    },
    "process": {
      "args": [
        "-m",
        "-t",
        "54",
        "Terminate"
      ],
      "command_line": "/etc/node-problem-detector.d/plugin/check_scheduledevent.sh -t Terminate -m 54",
      "name": "bash",
      "parent": {
        "name": "check_terminate",
        "pid": 456
      },
      "pid": 123,
      "working_directory": "/"
    },
    "related": {
      "user": [
        "root"
      ]
    },
    "user": {
      "name": "root"
    }
  }
}