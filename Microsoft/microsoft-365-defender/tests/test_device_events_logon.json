{
  "input": {
    "message": "{\"time\":\"2025-08-28T13:45:40.0045125Z\",\"tenantId\":\"tenant-test\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceLogonEvents\",\"_TimeReceivedBySvc\":\"2025-08-28T13:43:56.5953305Z\",\"properties\":{\"AccountName\":\"$\",\"AccountDomain\":\"$\",\"LogonType\":\"Network\",\"DeviceName\":\"example.com\",\"DeviceId\":\"device-test\",\"ReportId\":270478,\"AccountSid\":null,\"AppGuardContainerId\":\"\",\"LogonId\":null,\"RemoteIP\":\"192.0.2.1\",\"RemotePort\":63914,\"RemoteDeviceName\":\"kali\",\"ActionType\":\"LogonFailed\",\"InitiatingProcessId\":\"0\",\"InitiatingProcessCreationTime\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessSHA256\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessParentId\":\"0\",\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentFileName\":null,\"AdditionalFields\":\"{\\\"IsLocalLogon\\\":false}\",\"RemoteIPType\":\"Private\",\"IsLocalAdmin\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"Protocol\":\"NTLM\",\"FailureReason\":\"InvalidUserNameOrPassword\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":\"00000000-0000-0000-0000-000000000000\",\"IsInitiatingProcessRemoteSession\":\"00000000-0000-0000-0000-000000000000\",\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"00000000-0000-0000-0000-000000000000\",\"Timestamp\":\"2025-08-28T13:42:11.0632078Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\":\"2025-08-28T13:45:40.0045125Z\",\"tenantId\":\"tenant-test\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceLogonEvents\",\"_TimeReceivedBySvc\":\"2025-08-28T13:43:56.5953305Z\",\"properties\":{\"AccountName\":\"$\",\"AccountDomain\":\"$\",\"LogonType\":\"Network\",\"DeviceName\":\"example.com\",\"DeviceId\":\"device-test\",\"ReportId\":270478,\"AccountSid\":null,\"AppGuardContainerId\":\"\",\"LogonId\":null,\"RemoteIP\":\"192.0.2.1\",\"RemotePort\":63914,\"RemoteDeviceName\":\"kali\",\"ActionType\":\"LogonFailed\",\"InitiatingProcessId\":\"0\",\"InitiatingProcessCreationTime\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessSHA256\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessParentId\":\"0\",\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentFileName\":null,\"AdditionalFields\":\"{\\\"IsLocalLogon\\\":false}\",\"RemoteIPType\":\"Private\",\"IsLocalAdmin\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"Protocol\":\"NTLM\",\"FailureReason\":\"InvalidUserNameOrPassword\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":\"00000000-0000-0000-0000-000000000000\",\"IsInitiatingProcessRemoteSession\":\"00000000-0000-0000-0000-000000000000\",\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"00000000-0000-0000-0000-000000000000\",\"Timestamp\":\"2025-08-28T13:42:11.0632078Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}",
    "event": {
      "category": [
        "authentication"
      ],
      "dataset": "device_logon_events",
      "outcome": "InvalidUserNameOrPassword",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-08-28T13:42:11.063207Z",
    "action": {
      "name": "Publish",
      "outcome": "InvalidUserNameOrPassword",
      "properties": {
        "InitiatingProcessSessionId": "00000000-0000-0000-0000-000000000000",
        "IsInitiatingProcessRemoteSession": "00000000-0000-0000-0000-000000000000",
        "LogonType": "Network",
        "RemoteDeviceName": "kali",
        "RemoteIPType": "Private"
      },
      "type": "LogonFailed"
    },
    "destination": {
      "address": "192.0.2.1",
      "ip": "192.0.2.1",
      "port": 63914
    },
    "host": {
      "id": "device-test",
      "name": "example.com"
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "270478"
        }
      }
    },
    "network": {
      "protocol": "NTLM"
    },
    "process": {
      "parent": {
        "pid": 0
      },
      "pid": 0
    },
    "related": {
      "ip": [
        "192.0.2.1"
      ]
    }
  }
}