{
  "input": {
    "message": "{\"time\":\"2023-01-04T14:07:32.6213639Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"example.com\",\"ReportId\":37827,\"Timestamp\":\"2023-01-04T14:05:32.3148625Z\",\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":443,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":59985,\"Protocol\":\"Tcp\",\"RemoteUrl\":\"www.example.org\",\"InitiatingProcessCreationTime\":\"2023-01-04T14:05:22.8079798Z\",\"InitiatingProcessId\":18288,\"InitiatingProcessCommandLine\":\"ANONYMIZED_VALUE\",\"InitiatingProcessParentCreationTime\":\"2023-01-04T14:04:35.708037Z\",\"InitiatingProcessParentId\":23332,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFolderPath\":\"c:\\\\program files\\\\microsoft office\\\\root\\\\office16\\\\excel.exe\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessFileName\":\"EXCEL.EXE\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"AppGuardContainerId\":\"\",\"LocalIPType\":\"Private\",\"RemoteIPType\":\"Public\",\"ActionType\":\"ConnectionSuccess\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessAccountUpn\":\"john.doe@example.org\",\"InitiatingProcessAccountObjectId\":\"e0e5e759-c1e1-4cf9-91d5-c1099ef74614\",\"AdditionalFields\":null,\"InitiatingProcessFileSize\":63984520,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Office\",\"InitiatingProcessVersionInfoProductVersion\":\"16.0.15601.20538\",\"InitiatingProcessVersionInfoInternalFileName\":\"Excel\",\"InitiatingProcessVersionInfoOriginalFileName\":\"Excel.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Excel\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}"
  },
  "expected": {
    "message": "{\"time\":\"2023-01-04T14:07:32.6213639Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"example.com\",\"ReportId\":37827,\"Timestamp\":\"2023-01-04T14:05:32.3148625Z\",\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":443,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":59985,\"Protocol\":\"Tcp\",\"RemoteUrl\":\"www.example.org\",\"InitiatingProcessCreationTime\":\"2023-01-04T14:05:22.8079798Z\",\"InitiatingProcessId\":18288,\"InitiatingProcessCommandLine\":\"ANONYMIZED_VALUE\",\"InitiatingProcessParentCreationTime\":\"2023-01-04T14:04:35.708037Z\",\"InitiatingProcessParentId\":23332,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFolderPath\":\"c:\\\\program files\\\\microsoft office\\\\root\\\\office16\\\\excel.exe\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessFileName\":\"EXCEL.EXE\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"AppGuardContainerId\":\"\",\"LocalIPType\":\"Private\",\"RemoteIPType\":\"Public\",\"ActionType\":\"ConnectionSuccess\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessAccountUpn\":\"john.doe@example.org\",\"InitiatingProcessAccountObjectId\":\"e0e5e759-c1e1-4cf9-91d5-c1099ef74614\",\"AdditionalFields\":null,\"InitiatingProcessFileSize\":63984520,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Office\",\"InitiatingProcessVersionInfoProductVersion\":\"16.0.15601.20538\",\"InitiatingProcessVersionInfoInternalFileName\":\"Excel\",\"InitiatingProcessVersionInfoOriginalFileName\":\"Excel.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Excel\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
    "event": {
      "category": [
        "network"
      ],
      "dataset": "device_network_events",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2023-01-04T14:05:32.314862Z",
    "action": {
      "name": "Publish",
      "properties": {
        "InitiatingProcessAccountObjectId": "e0e5e759-c1e1-4cf9-91d5-c1099ef74614",
        "InitiatingProcessCommandLine": "ANONYMIZED_VALUE",
        "InitiatingProcessFileSize": 63984520,
        "InitiatingProcessIntegrityLevel": "Medium",
        "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
        "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
        "InitiatingProcessVersionInfoFileDescription": "Microsoft Excel",
        "InitiatingProcessVersionInfoInternalFileName": "Excel",
        "InitiatingProcessVersionInfoOriginalFileName": "Excel.exe",
        "InitiatingProcessVersionInfoProductName": "Microsoft Office",
        "InitiatingProcessVersionInfoProductVersion": "16.0.15601.20538",
        "LocalIPType": "Private",
        "RemoteIPType": "Public"
      },
      "type": "ConnectionSuccess"
    },
    "destination": {
      "address": "5.6.7.8",
      "ip": "5.6.7.8",
      "port": 443
    },
    "host": {
      "id": "dbe5c34434fb4792bea6874dd0b1f107",
      "name": "example.com"
    },
    "microsoft": {
      "defender": {
        "report": {
          "id": "37827"
        }
      }
    },
    "network": {
      "protocol": "Tcp"
    },
    "process": {
      "command_line": "ANONYMIZED_VALUE",
      "executable": "c:\\program files\\microsoft office\\root\\office16\\excel.exe",
      "hash": {
        "md5": "68b329da9893e34099c7d8ad5cb9c940",
        "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
        "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
      },
      "name": "EXCEL.EXE",
      "parent": {
        "name": "explorer.exe",
        "pid": 23332,
        "start": "2023-01-04T14:04:35.708037Z"
      },
      "pid": 18288,
      "start": "2023-01-04T14:05:22.807979Z",
      "user": {
        "domain": "example.com",
        "email": "john.doe@example.org",
        "id": "user1",
        "name": "user1"
      },
      "working_directory": "c:\\program files\\microsoft office\\root\\office16"
    },
    "related": {
      "hash": [
        "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
        "68b329da9893e34099c7d8ad5cb9c940",
        "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
      ],
      "hosts": [
        "www.example.org"
      ],
      "ip": [
        "1.2.3.4",
        "5.6.7.8"
      ]
    },
    "source": {
      "address": "1.2.3.4",
      "ip": "1.2.3.4",
      "port": 59985
    },
    "url": {
      "domain": "www.example.org",
      "registered_domain": "example.org",
      "subdomain": "www",
      "top_level_domain": "org"
    }
  }
}