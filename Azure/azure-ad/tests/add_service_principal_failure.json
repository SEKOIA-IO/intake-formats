{
  "input": {
    "message": "{\"time\": \"2019-06-24T09:18:23.5860200Z\", \"resourceId\": \"/tenants/33333333-3333-3333-3333-333333333333/providers/Microsoft.aadiam\", \"operationName\": \"Add service principal\", \"operationVersion\": \"1.0\", \"category\": \"AuditLogs\", \"tenantId\": \"33333333-3333-3333-3333-333333333333\", \"resultSignature\": \"None\", \"resultDescription\": \"Microsoft.Online.Workflows.SpnValidationException\", \"durationMs\": 0, \"callerIpAddress\": \"<null>\", \"correlationId\": \"11111111-1111-1111-1111-111111111111\", \"identity\": \"Microsoft Azure AD Internal - Jit Provisioning\", \"level\": \"Informational\", \"properties\": {\"id\": \"Directory_GMR7H_185505965\", \"category\": \"ApplicationManagement\", \"correlationId\": \"11111111-1111-1111-1111-111111111111\", \"result\": \"failure\", \"resultReason\": \"Microsoft.Online.Workflows.SpnValidationException\", \"activityDisplayName\": \"Add service principal\", \"activityDateTime\": \"2019-06-24T09:18:23.58602+00:00\", \"loggedByService\": \"Core Directory\", \"operationType\": \"Add\", \"initiatedBy\": {}, \"targetResources\": [{\"id\": \"44444444-4444-4444-4444-444444444444\", \"displayName\": \"Azure AD Identity Protection\", \"type\": \"ServicePrincipal\", \"modifiedProperties\": [{\"displayName\": \"AccountEnabled\", \"oldValue\": \"[]\", \"newValue\": \"[true]\"}, {\"displayName\": \"AppAddress\", \"oldValue\": \"[]\", \"newValue\": \"[{\\\"AddressType\\\":0,\\\"Address\\\":\\\"https://main.protectioncenter.ext.azure.com\\\",\\\"ReplyAddressClientType\\\":0},{\\\"AddressType\\\":0,\\\"Address\\\":\\\"https://s2.cloudappdiscovery.ext.azure.com/\\\",\\\"ReplyAddressClientType\\\":0}]\"}, {\"displayName\": \"AppPrincipalId\", \"oldValue\": \"[]\", \"newValue\": \"[\\\"66666666-6666-6666-6666-666666666666\\\"]\"}, {\"displayName\": \"DisplayName\", \"oldValue\": \"[]\", \"newValue\": \"[\\\"Azure AD Identity Protection\\\"]\"}, {\"displayName\": \"ServicePrincipalName\", \"oldValue\": \"[]\", \"newValue\": \"[\\\"https://s2.cloudappdiscovery.ext.azure.com/\\\",\\\"https://main.protectioncenter.ext.azure.com\\\",\\\"66666666-6666-6666-6666-666666666666\\\"]\"}, {\"displayName\": \"Credential\", \"oldValue\": \"[]\", \"newValue\": \"[{\\\"CredentialType\\\":2,\\\"KeyStoreId\\\":\\\"55555555-5555-5555-5555-555555555555\\\",\\\"KeyGroupId\\\":\\\"22222222-2222-2222-2222-222222222222\\\"}]\"}, {\"displayName\": \"Included Updated Properties\", \"oldValue\": null, \"newValue\": \"\\\"AccountEnabled, AppAddress, AppPrincipalId, DisplayName, ServicePrincipalName, Credential\\\"\"}, {\"displayName\": \"MethodExecutionResult.\", \"oldValue\": null, \"newValue\": \"\\\"Microsoft.Online.Workflows.SpnValidationException\\\"\"}, {\"displayName\": \"TargetId.ServicePrincipalNames\", \"oldValue\": null, \"newValue\": \"\\\"https://s2.cloudappdiscovery.ext.azure.com/;https://main.protectioncenter.ext.azure.com;66666666-6666-6666-6666-666666666666\\\"\"}]}], \"additionalDetails\": []}}"
  },
  "expected": {
    "message": "{\"time\": \"2019-06-24T09:18:23.5860200Z\", \"resourceId\": \"/tenants/33333333-3333-3333-3333-333333333333/providers/Microsoft.aadiam\", \"operationName\": \"Add service principal\", \"operationVersion\": \"1.0\", \"category\": \"AuditLogs\", \"tenantId\": \"33333333-3333-3333-3333-333333333333\", \"resultSignature\": \"None\", \"resultDescription\": \"Microsoft.Online.Workflows.SpnValidationException\", \"durationMs\": 0, \"callerIpAddress\": \"<null>\", \"correlationId\": \"11111111-1111-1111-1111-111111111111\", \"identity\": \"Microsoft Azure AD Internal - Jit Provisioning\", \"level\": \"Informational\", \"properties\": {\"id\": \"Directory_GMR7H_185505965\", \"category\": \"ApplicationManagement\", \"correlationId\": \"11111111-1111-1111-1111-111111111111\", \"result\": \"failure\", \"resultReason\": \"Microsoft.Online.Workflows.SpnValidationException\", \"activityDisplayName\": \"Add service principal\", \"activityDateTime\": \"2019-06-24T09:18:23.58602+00:00\", \"loggedByService\": \"Core Directory\", \"operationType\": \"Add\", \"initiatedBy\": {}, \"targetResources\": [{\"id\": \"44444444-4444-4444-4444-444444444444\", \"displayName\": \"Azure AD Identity Protection\", \"type\": \"ServicePrincipal\", \"modifiedProperties\": [{\"displayName\": \"AccountEnabled\", \"oldValue\": \"[]\", \"newValue\": \"[true]\"}, {\"displayName\": \"AppAddress\", \"oldValue\": \"[]\", \"newValue\": \"[{\\\"AddressType\\\":0,\\\"Address\\\":\\\"https://main.protectioncenter.ext.azure.com\\\",\\\"ReplyAddressClientType\\\":0},{\\\"AddressType\\\":0,\\\"Address\\\":\\\"https://s2.cloudappdiscovery.ext.azure.com/\\\",\\\"ReplyAddressClientType\\\":0}]\"}, {\"displayName\": \"AppPrincipalId\", \"oldValue\": \"[]\", \"newValue\": \"[\\\"66666666-6666-6666-6666-666666666666\\\"]\"}, {\"displayName\": \"DisplayName\", \"oldValue\": \"[]\", \"newValue\": \"[\\\"Azure AD Identity Protection\\\"]\"}, {\"displayName\": \"ServicePrincipalName\", \"oldValue\": \"[]\", \"newValue\": \"[\\\"https://s2.cloudappdiscovery.ext.azure.com/\\\",\\\"https://main.protectioncenter.ext.azure.com\\\",\\\"66666666-6666-6666-6666-666666666666\\\"]\"}, {\"displayName\": \"Credential\", \"oldValue\": \"[]\", \"newValue\": \"[{\\\"CredentialType\\\":2,\\\"KeyStoreId\\\":\\\"55555555-5555-5555-5555-555555555555\\\",\\\"KeyGroupId\\\":\\\"22222222-2222-2222-2222-222222222222\\\"}]\"}, {\"displayName\": \"Included Updated Properties\", \"oldValue\": null, \"newValue\": \"\\\"AccountEnabled, AppAddress, AppPrincipalId, DisplayName, ServicePrincipalName, Credential\\\"\"}, {\"displayName\": \"MethodExecutionResult.\", \"oldValue\": null, \"newValue\": \"\\\"Microsoft.Online.Workflows.SpnValidationException\\\"\"}, {\"displayName\": \"TargetId.ServicePrincipalNames\", \"oldValue\": null, \"newValue\": \"\\\"https://s2.cloudappdiscovery.ext.azure.com/;https://main.protectioncenter.ext.azure.com;66666666-6666-6666-6666-666666666666\\\"\"}]}], \"additionalDetails\": []}}",
    "event": {
      "action": "Add service principal",
      "category": [
        "iam"
      ],
      "outcome": "failure",
      "reason": "Microsoft.Online.Workflows.SpnValidationException"
    },
    "@timestamp": "2019-06-24T09:18:23.586020Z",
    "action": {
      "name": "Add service principal",
      "outcome": "failure",
      "outcome_reason": "Microsoft.Online.Workflows.SpnValidationException",
      "properties": [
        {
          "name": "AccountEnabled",
          "newValue": "[true]",
          "oldValue": "[]"
        },
        {
          "name": "AppAddress",
          "newValue": "[{\"AddressType\":0,\"Address\":\"https://main.protectioncenter.ext.azure.com\",\"ReplyAddressClientType\":0},{\"AddressType\":0,\"Address\":\"https://s2.cloudappdiscovery.ext.azure.com/\",\"ReplyAddressClientType\":0}]",
          "oldValue": "[]"
        },
        {
          "name": "AppPrincipalId",
          "newValue": "[\"66666666-6666-6666-6666-666666666666\"]",
          "oldValue": "[]"
        },
        {
          "name": "DisplayName",
          "newValue": "[\"Azure AD Identity Protection\"]",
          "oldValue": "[]"
        },
        {
          "name": "ServicePrincipalName",
          "newValue": "[\"https://s2.cloudappdiscovery.ext.azure.com/\",\"https://main.protectioncenter.ext.azure.com\",\"66666666-6666-6666-6666-666666666666\"]",
          "oldValue": "[]"
        },
        {
          "name": "Credential",
          "newValue": "[{\"CredentialType\":2,\"KeyStoreId\":\"55555555-5555-5555-5555-555555555555\",\"KeyGroupId\":\"22222222-2222-2222-2222-222222222222\"}]",
          "oldValue": "[]"
        },
        {
          "name": "MethodExecutionResult.",
          "newValue": "\"Microsoft.Online.Workflows.SpnValidationException\"",
          "oldValue": ""
        },
        {
          "name": "TargetId.ServicePrincipalNames",
          "newValue": "\"https://s2.cloudappdiscovery.ext.azure.com/;https://main.protectioncenter.ext.azure.com;66666666-6666-6666-6666-666666666666\"",
          "oldValue": ""
        }
      ],
      "type": "add"
    },
    "azuread": {
      "category": "AuditLogs",
      "correlationId": "11111111-1111-1111-1111-111111111111",
      "durationMs": 0,
      "identity": "Microsoft Azure AD Internal - Jit Provisioning",
      "operationName": "Add service principal",
      "operationVersion": "1.0",
      "properties": {
        "correlationId": "11111111-1111-1111-1111-111111111111",
        "id": "Directory_GMR7H_185505965",
        "targetServicePrincipalDisplayName": "Azure AD Identity Protection"
      },
      "resourceId": "/tenants/33333333-3333-3333-3333-333333333333/providers/Microsoft.aadiam",
      "resultDescription": "Microsoft.Online.Workflows.SpnValidationException",
      "tenantId": "33333333-3333-3333-3333-333333333333"
    },
    "service": {
      "name": "Azure Active Directory",
      "type": "ldap"
    }
  }
}