{
  "input": {
    "message": "{\"time\": \"2025-10-27T10:15:15.8442646Z\", \"resourceId\": \"/tenants/11111111-1111-1111-1111-111111111111/providers/Microsoft.aadiam\", \"operationName\": \"Add app role assignment to service principal\", \"operationVersion\": \"1.0\", \"category\": \"AuditLogs\", \"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"resultSignature\": \"None\", \"durationMs\": 0, \"callerIpAddress\": \"5.6.7.8\", \"correlationId\": \"44444444-4444-4444-4444-444444444444\", \"Level\": 4, \"properties\": {\"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"resultType\": \"\", \"resultDescription\": \"\", \"operationName\": \"Add app role assignment to service principal\", \"identity\": \"\", \"tenantGeo\": \"EU\", \"id\": \"Directory_44444444-4444-4444-4444-444444444444_SAMPLE_123456\", \"category\": \"ApplicationManagement\", \"correlationId\": \"44444444-4444-4444-4444-444444444444\", \"result\": \"success\", \"resultReason\": \"\", \"activityDisplayName\": \"Add app role assignment to service principal\", \"activityDateTime\": \"2025-10-27T10:15:15.8442646+00:00\", \"loggedByService\": \"Core Directory\", \"operationType\": \"Assign\", \"userAgent\": null, \"initiatedBy\": {\"user\": {\"id\": \"55555555-5555-5555-5555-555555555555\", \"displayName\": null, \"userPrincipalName\": \"JDOE-AAD@example.onmicrosoft.com\", \"ipAddress\": \"5.6.7.8\", \"roles\": []}}, \"performedBy\": null, \"targetResources\": [{\"id\": \"77777777-7777-7777-7777-777777777777\", \"displayName\": \"Office 365 Exchange Online\", \"type\": \"ServicePrincipal\", \"modifiedProperties\": [{\"displayName\": \"AppRole.Id\", \"oldValue\": null, \"newValue\": \"\\\"66666666-6666-6666-6666-666666666666\\\"\"}, {\"displayName\": \"AppRole.Value\", \"oldValue\": null, \"newValue\": \"\\\"SMTP.SendAsApp\\\"\"}, {\"displayName\": \"AppRole.DisplayName\", \"oldValue\": null, \"newValue\": \"\\\"Application access for sending emails via SMTP AUTH\\\"\"}, {\"displayName\": \"AppRoleAssignment.CreatedDateTime\", \"oldValue\": null, \"newValue\": \"\\\"2025-10-27T10:15:15.7952638Z\\\"\"}, {\"displayName\": \"AppRoleAssignment.LastModifiedDateTime\", \"oldValue\": null, \"newValue\": \"\\\"2025-10-27T10:15:15.7952638Z\\\"\"}, {\"displayName\": \"ServicePrincipal.ObjectID\", \"oldValue\": null, \"newValue\": \"\\\"22222222-2222-2222-2222-222222222222\\\"\"}, {\"displayName\": \"ServicePrincipal.DisplayName\", \"oldValue\": null, \"newValue\": \"\\\"Apps_Test_SOC\\\"\"}, {\"displayName\": \"ServicePrincipal.AppId\", \"oldValue\": null, \"newValue\": \"\\\"88888888-8888-8888-8888-888888888888\\\"\"}, {\"displayName\": \"ServicePrincipal.Name\", \"oldValue\": null, \"newValue\": \"\\\"88888888-8888-8888-8888-888888888888\\\"\"}, {\"displayName\": \"TargetId.ServicePrincipalNames\", \"oldValue\": null, \"newValue\": \"\\\"https://outlook.office.com;https://ps.outlook.com;https://outlook-tdf-2.office.com/;https://outlook-tdf.office.com/;https://ps.compliance.protection.outlook.com;https://autodiscover-s.office365.us/;https://outlook.office365.us/;https://outlook-sdf.office.com/;https://outlook-sdf.office365.com/;https://outlook.office365.com:443/;https://outlook.office.com/;https://outlook.office365.com/;https://outlook.com/;https://outlook-dod.office365.us/;https://ps.protection.outlook.com/;https://webmail.apps.mil/;Office 365 Exchange Online;Microsoft.Exchange\\\"\"}], \"administrativeUnits\": []}, {\"id\": \"22222222-2222-2222-2222-222222222222\", \"displayName\": \"88888888-8888-8888-8888-888888888888\", \"type\": \"ServicePrincipal\", \"modifiedProperties\": [], \"administrativeUnits\": []}], \"additionalDetails\": [{\"key\": \"User-Agent\", \"value\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/1.2.3.4 Safari/537.36 Edg/1.2.3.4\"}, {\"key\": \"AppId\", \"value\": \"33333333-3333-3333-3333-333333333333\"}]}}"
  },
  "expected": {
    "message": "{\"time\": \"2025-10-27T10:15:15.8442646Z\", \"resourceId\": \"/tenants/11111111-1111-1111-1111-111111111111/providers/Microsoft.aadiam\", \"operationName\": \"Add app role assignment to service principal\", \"operationVersion\": \"1.0\", \"category\": \"AuditLogs\", \"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"resultSignature\": \"None\", \"durationMs\": 0, \"callerIpAddress\": \"5.6.7.8\", \"correlationId\": \"44444444-4444-4444-4444-444444444444\", \"Level\": 4, \"properties\": {\"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"resultType\": \"\", \"resultDescription\": \"\", \"operationName\": \"Add app role assignment to service principal\", \"identity\": \"\", \"tenantGeo\": \"EU\", \"id\": \"Directory_44444444-4444-4444-4444-444444444444_SAMPLE_123456\", \"category\": \"ApplicationManagement\", \"correlationId\": \"44444444-4444-4444-4444-444444444444\", \"result\": \"success\", \"resultReason\": \"\", \"activityDisplayName\": \"Add app role assignment to service principal\", \"activityDateTime\": \"2025-10-27T10:15:15.8442646+00:00\", \"loggedByService\": \"Core Directory\", \"operationType\": \"Assign\", \"userAgent\": null, \"initiatedBy\": {\"user\": {\"id\": \"55555555-5555-5555-5555-555555555555\", \"displayName\": null, \"userPrincipalName\": \"JDOE-AAD@example.onmicrosoft.com\", \"ipAddress\": \"5.6.7.8\", \"roles\": []}}, \"performedBy\": null, \"targetResources\": [{\"id\": \"77777777-7777-7777-7777-777777777777\", \"displayName\": \"Office 365 Exchange Online\", \"type\": \"ServicePrincipal\", \"modifiedProperties\": [{\"displayName\": \"AppRole.Id\", \"oldValue\": null, \"newValue\": \"\\\"66666666-6666-6666-6666-666666666666\\\"\"}, {\"displayName\": \"AppRole.Value\", \"oldValue\": null, \"newValue\": \"\\\"SMTP.SendAsApp\\\"\"}, {\"displayName\": \"AppRole.DisplayName\", \"oldValue\": null, \"newValue\": \"\\\"Application access for sending emails via SMTP AUTH\\\"\"}, {\"displayName\": \"AppRoleAssignment.CreatedDateTime\", \"oldValue\": null, \"newValue\": \"\\\"2025-10-27T10:15:15.7952638Z\\\"\"}, {\"displayName\": \"AppRoleAssignment.LastModifiedDateTime\", \"oldValue\": null, \"newValue\": \"\\\"2025-10-27T10:15:15.7952638Z\\\"\"}, {\"displayName\": \"ServicePrincipal.ObjectID\", \"oldValue\": null, \"newValue\": \"\\\"22222222-2222-2222-2222-222222222222\\\"\"}, {\"displayName\": \"ServicePrincipal.DisplayName\", \"oldValue\": null, \"newValue\": \"\\\"Apps_Test_SOC\\\"\"}, {\"displayName\": \"ServicePrincipal.AppId\", \"oldValue\": null, \"newValue\": \"\\\"88888888-8888-8888-8888-888888888888\\\"\"}, {\"displayName\": \"ServicePrincipal.Name\", \"oldValue\": null, \"newValue\": \"\\\"88888888-8888-8888-8888-888888888888\\\"\"}, {\"displayName\": \"TargetId.ServicePrincipalNames\", \"oldValue\": null, \"newValue\": \"\\\"https://outlook.office.com;https://ps.outlook.com;https://outlook-tdf-2.office.com/;https://outlook-tdf.office.com/;https://ps.compliance.protection.outlook.com;https://autodiscover-s.office365.us/;https://outlook.office365.us/;https://outlook-sdf.office.com/;https://outlook-sdf.office365.com/;https://outlook.office365.com:443/;https://outlook.office.com/;https://outlook.office365.com/;https://outlook.com/;https://outlook-dod.office365.us/;https://ps.protection.outlook.com/;https://webmail.apps.mil/;Office 365 Exchange Online;Microsoft.Exchange\\\"\"}], \"administrativeUnits\": []}, {\"id\": \"22222222-2222-2222-2222-222222222222\", \"displayName\": \"88888888-8888-8888-8888-888888888888\", \"type\": \"ServicePrincipal\", \"modifiedProperties\": [], \"administrativeUnits\": []}], \"additionalDetails\": [{\"key\": \"User-Agent\", \"value\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/1.2.3.4 Safari/537.36 Edg/1.2.3.4\"}, {\"key\": \"AppId\", \"value\": \"33333333-3333-3333-3333-333333333333\"}]}}",
    "event": {
      "action": "Add app role assignment to service principal",
      "category": [
        "iam"
      ],
      "outcome": "success"
    },
    "@timestamp": "2025-10-27T10:15:15.844264Z",
    "action": {
      "name": "Add app role assignment to service principal",
      "outcome": "success",
      "properties": [
        {
          "name": "AppRole.Id",
          "newValue": "\"66666666-6666-6666-6666-666666666666\"",
          "oldValue": ""
        },
        {
          "name": "AppRole.Value",
          "newValue": "\"SMTP.SendAsApp\"",
          "oldValue": ""
        },
        {
          "name": "AppRole.DisplayName",
          "newValue": "\"Application access for sending emails via SMTP AUTH\"",
          "oldValue": ""
        },
        {
          "name": "AppRoleAssignment.CreatedDateTime",
          "newValue": "\"2025-10-27T10:15:15.7952638Z\"",
          "oldValue": ""
        },
        {
          "name": "AppRoleAssignment.LastModifiedDateTime",
          "newValue": "\"2025-10-27T10:15:15.7952638Z\"",
          "oldValue": ""
        },
        {
          "name": "ServicePrincipal.ObjectID",
          "newValue": "\"22222222-2222-2222-2222-222222222222\"",
          "oldValue": ""
        },
        {
          "name": "ServicePrincipal.DisplayName",
          "newValue": "\"Apps_Test_SOC\"",
          "oldValue": ""
        },
        {
          "name": "ServicePrincipal.AppId",
          "newValue": "\"88888888-8888-8888-8888-888888888888\"",
          "oldValue": ""
        },
        {
          "name": "ServicePrincipal.Name",
          "newValue": "\"88888888-8888-8888-8888-888888888888\"",
          "oldValue": ""
        },
        {
          "name": "TargetId.ServicePrincipalNames",
          "newValue": "\"https://outlook.office.com;https://ps.outlook.com;https://outlook-tdf-2.office.com/;https://outlook-tdf.office.com/;https://ps.compliance.protection.outlook.com;https://autodiscover-s.office365.us/;https://outlook.office365.us/;https://outlook-sdf.office.com/;https://outlook-sdf.office365.com/;https://outlook.office365.com:443/;https://outlook.office.com/;https://outlook.office365.com/;https://outlook.com/;https://outlook-dod.office365.us/;https://ps.protection.outlook.com/;https://webmail.apps.mil/;Office 365 Exchange Online;Microsoft.Exchange\"",
          "oldValue": ""
        }
      ],
      "target": "user",
      "type": "assign"
    },
    "azuread": {
      "callerIpAddress": "5.6.7.8",
      "category": "AuditLogs",
      "correlationId": "44444444-4444-4444-4444-444444444444",
      "durationMs": 0,
      "operationName": "Add app role assignment to service principal",
      "operationVersion": "1.0",
      "properties": {
        "appId": "33333333-3333-3333-3333-333333333333",
        "correlationId": "44444444-4444-4444-4444-444444444444",
        "id": "Directory_44444444-4444-4444-4444-444444444444_SAMPLE_123456",
        "newDisplayName": "Application access for sending emails via SMTP AUTH"
      },
      "resourceId": "/tenants/11111111-1111-1111-1111-111111111111/providers/Microsoft.aadiam",
      "tenantId": "11111111-1111-1111-1111-111111111111"
    },
    "log": {
      "level": "4"
    },
    "related": {
      "ip": [
        "5.6.7.8"
      ],
      "user": [
        "JDOE-AAD@example.onmicrosoft.com"
      ]
    },
    "service": {
      "name": "Azure Active Directory",
      "type": "ldap"
    },
    "source": {
      "address": "5.6.7.8",
      "ip": "5.6.7.8"
    },
    "user": {
      "id": "55555555-5555-5555-5555-555555555555",
      "name": "JDOE-AAD@example.onmicrosoft.com"
    }
  }
}