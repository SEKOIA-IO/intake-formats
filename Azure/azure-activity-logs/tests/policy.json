{
  "input": {
    "message": "{\"authorization\": {\"action\": \"Microsoft.Resources/checkPolicyCompliance/read\", \"scope\": \"/subscriptions/<subscriptionID>\"}, \"caller\": \"99999999-9999-9999-9999-999999999999\", \"channels\": \"Operation\", \"claims\": {\"aud\": \"https://management.azure.com/\", \"iss\": \"https://sts.windows.net/55555555-5555-5555-5555-555555555555/\", \"iat\": \"1234567890\", \"nbf\": \"1234567890\", \"exp\": \"1234567890\", \"aio\": \"AIOEXAMPLE\", \"appid\": \"22222222-2222-2222-2222-222222222222\", \"appidacr\": \"2\", \"http://schemas.microsoft.com/identity/claims/identityprovider\": \"https://sts.windows.net/55555555-5555-5555-5555-555555555555/\", \"http://schemas.microsoft.com/identity/claims/objectidentifier\": \"33333333-3333-3333-3333-333333333333\", \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\": \"NAMEIDENTIFIER\", \"http://schemas.microsoft.com/identity/claims/tenantid\": \"66666666-6666-6666-6666-666666666666\", \"uti\": \"UTI\", \"ver\": \"1.0\"}, \"correlationId\": \"AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA\", \"description\": \"\", \"eventDataId\": \"11111111-1111-1111-1111-111111111111\", \"eventName\": {\"value\": \"EndRequest\", \"localizedValue\": \"End request\"}, \"category\": {\"value\": \"Policy\", \"localizedValue\": \"Policy\"}, \"eventTimestamp\": \"2019-01-15T13:19:56.1227642Z\", \"id\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy/events/11111111-1111-1111-1111-111111111111/ticks/636831551961227642\", \"level\": \"Warning\", \"operationId\": \"88888888-8888-8888-8888-888888888888\", \"operationName\": {\"value\": \"Microsoft.Authorization/policies/audit/action\", \"localizedValue\": \"Microsoft.Authorization/policies/audit/action\"}, \"resourceGroupName\": \"myResourceGroup\", \"resourceProviderName\": {\"value\": \"Microsoft.Sql\", \"localizedValue\": \"Microsoft SQL\"}, \"resourceType\": {\"value\": \"Microsoft.Resources/checkPolicyCompliance\", \"localizedValue\": \"Microsoft.Resources/checkPolicyCompliance\"}, \"resourceId\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy\", \"status\": {\"value\": \"Succeeded\", \"localizedValue\": \"Succeeded\"}, \"subStatus\": {\"value\": \"\", \"localizedValue\": \"\"}, \"submissionTimestamp\": \"2019-01-15T13:20:17.1077672Z\", \"subscriptionId\": \"<subscriptionID>\", \"properties\": {\"isComplianceCheck\": \"True\", \"resourceLocation\": \"westus2\", \"ancestors\": \"44444444-4444-4444-4444-444444444444\", \"policies\": \"[{\\\"policyDefinitionId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyDefinitions/77777777-7777-7777-7777-777777777777/\\\",\\\"policyDefinitionName\\\":\\\"77777777-7777-7777-7777-777777777777\\\",\\\"policyDefinitionEffect\\\":\\\"Deny\\\",\\\"policyAssignmentId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyAssignments/1234567890abcdef/\\\",\\\"policyAssignmentName\\\":\\\"1234567890abcdef\\\",\\\"policyAssignmentScope\\\":\\\"/subscriptions/<subscriptionID>\\\",\\\"policyAssignmentParameters\\\":{}}]\"}, \"relatedEvents\": []}"
  },
  "expected": {
    "message": "{\"authorization\": {\"action\": \"Microsoft.Resources/checkPolicyCompliance/read\", \"scope\": \"/subscriptions/<subscriptionID>\"}, \"caller\": \"99999999-9999-9999-9999-999999999999\", \"channels\": \"Operation\", \"claims\": {\"aud\": \"https://management.azure.com/\", \"iss\": \"https://sts.windows.net/55555555-5555-5555-5555-555555555555/\", \"iat\": \"1234567890\", \"nbf\": \"1234567890\", \"exp\": \"1234567890\", \"aio\": \"AIOEXAMPLE\", \"appid\": \"22222222-2222-2222-2222-222222222222\", \"appidacr\": \"2\", \"http://schemas.microsoft.com/identity/claims/identityprovider\": \"https://sts.windows.net/55555555-5555-5555-5555-555555555555/\", \"http://schemas.microsoft.com/identity/claims/objectidentifier\": \"33333333-3333-3333-3333-333333333333\", \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\": \"NAMEIDENTIFIER\", \"http://schemas.microsoft.com/identity/claims/tenantid\": \"66666666-6666-6666-6666-666666666666\", \"uti\": \"UTI\", \"ver\": \"1.0\"}, \"correlationId\": \"AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA\", \"description\": \"\", \"eventDataId\": \"11111111-1111-1111-1111-111111111111\", \"eventName\": {\"value\": \"EndRequest\", \"localizedValue\": \"End request\"}, \"category\": {\"value\": \"Policy\", \"localizedValue\": \"Policy\"}, \"eventTimestamp\": \"2019-01-15T13:19:56.1227642Z\", \"id\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy/events/11111111-1111-1111-1111-111111111111/ticks/636831551961227642\", \"level\": \"Warning\", \"operationId\": \"88888888-8888-8888-8888-888888888888\", \"operationName\": {\"value\": \"Microsoft.Authorization/policies/audit/action\", \"localizedValue\": \"Microsoft.Authorization/policies/audit/action\"}, \"resourceGroupName\": \"myResourceGroup\", \"resourceProviderName\": {\"value\": \"Microsoft.Sql\", \"localizedValue\": \"Microsoft SQL\"}, \"resourceType\": {\"value\": \"Microsoft.Resources/checkPolicyCompliance\", \"localizedValue\": \"Microsoft.Resources/checkPolicyCompliance\"}, \"resourceId\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy\", \"status\": {\"value\": \"Succeeded\", \"localizedValue\": \"Succeeded\"}, \"subStatus\": {\"value\": \"\", \"localizedValue\": \"\"}, \"submissionTimestamp\": \"2019-01-15T13:20:17.1077672Z\", \"subscriptionId\": \"<subscriptionID>\", \"properties\": {\"isComplianceCheck\": \"True\", \"resourceLocation\": \"westus2\", \"ancestors\": \"44444444-4444-4444-4444-444444444444\", \"policies\": \"[{\\\"policyDefinitionId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyDefinitions/77777777-7777-7777-7777-777777777777/\\\",\\\"policyDefinitionName\\\":\\\"77777777-7777-7777-7777-777777777777\\\",\\\"policyDefinitionEffect\\\":\\\"Deny\\\",\\\"policyAssignmentId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyAssignments/1234567890abcdef/\\\",\\\"policyAssignmentName\\\":\\\"1234567890abcdef\\\",\\\"policyAssignmentScope\\\":\\\"/subscriptions/<subscriptionID>\\\",\\\"policyAssignmentParameters\\\":{}}]\"}, \"relatedEvents\": []}",
    "event": {
      "action": "Microsoft.Authorization/policies/audit/action",
      "category": [
        "network"
      ],
      "dataset": "Policy",
      "provider": "Microsoft.Sql",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2019-01-15T13:19:56.122764Z",
    "azure": {
      "activity_logs": {
        "channels": "Operation",
        "correlation_id": "AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA",
        "operation_id": "88888888-8888-8888-8888-888888888888",
        "policies": [
          {
            "assignment_id": "/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyAssignments/1234567890abcdef/",
            "assignment_name": "1234567890abcdef",
            "definition_id": "/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyDefinitions/77777777-7777-7777-7777-777777777777/",
            "definition_name": "77777777-7777-7777-7777-777777777777"
          }
        ],
        "resource": {
          "group": "myResourceGroup",
          "id": "/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy",
          "location": "westus2",
          "type": "Microsoft.Resources/checkPolicyCompliance"
        }
      }
    },
    "log": {
      "level": "Warning"
    },
    "source": {
      "user": {
        "id": "99999999-9999-9999-9999-999999999999"
      }
    }
  }
}