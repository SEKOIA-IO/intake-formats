{
  "input": {
    "message": "{\"authorization\": {\"action\": \"Microsoft.Resources/checkPolicyCompliance/read\", \"scope\": \"/subscriptions/<subscriptionID>\"}, \"caller\": \"33a68b9d-63ce-484c-a97e-94aef4c89648\", \"channels\": \"Operation\", \"claims\": {\"aud\": \"https://management.azure.com/\", \"iss\": \"https://sts.windows.net/1114444b-7467-4144-a616-e3a5d63e147b/\", \"iat\": \"1234567890\", \"nbf\": \"1234567890\", \"exp\": \"1234567890\", \"aio\": \"A3GgTJdwK4vy7Fa7l6DgJC2mI0GX44tML385OpU1Q+z+jaPnFMwB\", \"appid\": \"1d78a85d-813d-46f0-b496-dd72f50a3ec0\", \"appidacr\": \"2\", \"http://schemas.microsoft.com/identity/claims/identityprovider\": \"https://sts.windows.net/1114444b-7467-4144-a616-e3a5d63e147b/\", \"http://schemas.microsoft.com/identity/claims/objectidentifier\": \"f409edeb-4d29-44b5-9763-ee9348ad91bb\", \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\": \"b-24Jf94A3FH2sHWVIFqO3-RSJEiv24Jnif3gj7s\", \"http://schemas.microsoft.com/identity/claims/tenantid\": \"aaaabbbb-0000-cccc-1111-dddd2222eeee\", \"uti\": \"IdP3SUJGtkGlt7dDQVRPAA\", \"ver\": \"1.0\"}, \"correlationId\": \"aaaa0000-bb11-2222-33cc-444444dddddd\", \"description\": \"\", \"eventDataId\": \"aaaa0a0a-bb1b-cc2c-dd3d-eeeeee4e4e4e\", \"eventName\": {\"value\": \"EndRequest\", \"localizedValue\": \"End request\"}, \"category\": {\"value\": \"Policy\", \"localizedValue\": \"Policy\"}, \"eventTimestamp\": \"2019-01-15T13:19:56.1227642Z\", \"id\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy/events/aaaa0a0a-bb1b-cc2c-dd3d-eeeeee4e4e4e/ticks/636831551961227642\", \"level\": \"Warning\", \"operationId\": \"04e575f8-48d0-4c43-a8b3-78c4eb01d287\", \"operationName\": {\"value\": \"Microsoft.Authorization/policies/audit/action\", \"localizedValue\": \"Microsoft.Authorization/policies/audit/action\"}, \"resourceGroupName\": \"myResourceGroup\", \"resourceProviderName\": {\"value\": \"Microsoft.Sql\", \"localizedValue\": \"Microsoft SQL\"}, \"resourceType\": {\"value\": \"Microsoft.Resources/checkPolicyCompliance\", \"localizedValue\": \"Microsoft.Resources/checkPolicyCompliance\"}, \"resourceId\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy\", \"status\": {\"value\": \"Succeeded\", \"localizedValue\": \"Succeeded\"}, \"subStatus\": {\"value\": \"\", \"localizedValue\": \"\"}, \"submissionTimestamp\": \"2019-01-15T13:20:17.1077672Z\", \"subscriptionId\": \"<subscriptionID>\", \"properties\": {\"isComplianceCheck\": \"True\", \"resourceLocation\": \"westus2\", \"ancestors\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\", \"policies\": \"[{\\\"policyDefinitionId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyDefinitions/5775cdd5-d3d3-47bf-bc55-bb8b61746506/\\\",\\\"policyDefinitionName\\\":\\\"5775cdd5-d3d3-47bf-bc55-bb8b61746506\\\",\\\"policyDefinitionEffect\\\":\\\"Deny\\\",\\\"policyAssignmentId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyAssignments/991a69402a6c484cb0f9b673/\\\",\\\"policyAssignmentName\\\":\\\"991a69402a6c484cb0f9b673\\\",\\\"policyAssignmentScope\\\":\\\"/subscriptions/<subscriptionID>\\\",\\\"policyAssignmentParameters\\\":{}}]\"}, \"relatedEvents\": []}"
  },
  "expected": {
    "message": "{\"authorization\": {\"action\": \"Microsoft.Resources/checkPolicyCompliance/read\", \"scope\": \"/subscriptions/<subscriptionID>\"}, \"caller\": \"33a68b9d-63ce-484c-a97e-94aef4c89648\", \"channels\": \"Operation\", \"claims\": {\"aud\": \"https://management.azure.com/\", \"iss\": \"https://sts.windows.net/1114444b-7467-4144-a616-e3a5d63e147b/\", \"iat\": \"1234567890\", \"nbf\": \"1234567890\", \"exp\": \"1234567890\", \"aio\": \"A3GgTJdwK4vy7Fa7l6DgJC2mI0GX44tML385OpU1Q+z+jaPnFMwB\", \"appid\": \"1d78a85d-813d-46f0-b496-dd72f50a3ec0\", \"appidacr\": \"2\", \"http://schemas.microsoft.com/identity/claims/identityprovider\": \"https://sts.windows.net/1114444b-7467-4144-a616-e3a5d63e147b/\", \"http://schemas.microsoft.com/identity/claims/objectidentifier\": \"f409edeb-4d29-44b5-9763-ee9348ad91bb\", \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\": \"b-24Jf94A3FH2sHWVIFqO3-RSJEiv24Jnif3gj7s\", \"http://schemas.microsoft.com/identity/claims/tenantid\": \"aaaabbbb-0000-cccc-1111-dddd2222eeee\", \"uti\": \"IdP3SUJGtkGlt7dDQVRPAA\", \"ver\": \"1.0\"}, \"correlationId\": \"aaaa0000-bb11-2222-33cc-444444dddddd\", \"description\": \"\", \"eventDataId\": \"aaaa0a0a-bb1b-cc2c-dd3d-eeeeee4e4e4e\", \"eventName\": {\"value\": \"EndRequest\", \"localizedValue\": \"End request\"}, \"category\": {\"value\": \"Policy\", \"localizedValue\": \"Policy\"}, \"eventTimestamp\": \"2019-01-15T13:19:56.1227642Z\", \"id\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy/events/aaaa0a0a-bb1b-cc2c-dd3d-eeeeee4e4e4e/ticks/636831551961227642\", \"level\": \"Warning\", \"operationId\": \"04e575f8-48d0-4c43-a8b3-78c4eb01d287\", \"operationName\": {\"value\": \"Microsoft.Authorization/policies/audit/action\", \"localizedValue\": \"Microsoft.Authorization/policies/audit/action\"}, \"resourceGroupName\": \"myResourceGroup\", \"resourceProviderName\": {\"value\": \"Microsoft.Sql\", \"localizedValue\": \"Microsoft SQL\"}, \"resourceType\": {\"value\": \"Microsoft.Resources/checkPolicyCompliance\", \"localizedValue\": \"Microsoft.Resources/checkPolicyCompliance\"}, \"resourceId\": \"/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy\", \"status\": {\"value\": \"Succeeded\", \"localizedValue\": \"Succeeded\"}, \"subStatus\": {\"value\": \"\", \"localizedValue\": \"\"}, \"submissionTimestamp\": \"2019-01-15T13:20:17.1077672Z\", \"subscriptionId\": \"<subscriptionID>\", \"properties\": {\"isComplianceCheck\": \"True\", \"resourceLocation\": \"westus2\", \"ancestors\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\", \"policies\": \"[{\\\"policyDefinitionId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyDefinitions/5775cdd5-d3d3-47bf-bc55-bb8b61746506/\\\",\\\"policyDefinitionName\\\":\\\"5775cdd5-d3d3-47bf-bc55-bb8b61746506\\\",\\\"policyDefinitionEffect\\\":\\\"Deny\\\",\\\"policyAssignmentId\\\":\\\"/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyAssignments/991a69402a6c484cb0f9b673/\\\",\\\"policyAssignmentName\\\":\\\"991a69402a6c484cb0f9b673\\\",\\\"policyAssignmentScope\\\":\\\"/subscriptions/<subscriptionID>\\\",\\\"policyAssignmentParameters\\\":{}}]\"}, \"relatedEvents\": []}",
    "event": {
      "action": "Microsoft.Authorization/policies/audit/action",
      "category": [
        "network"
      ],
      "dataset": "Policy",
      "provider": "Microsoft.Sql",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2019-01-15T13:19:56.122764Z",
    "azure": {
      "activity_logs": {
        "channels": "Operation",
        "correlation_id": "aaaa0000-bb11-2222-33cc-444444dddddd",
        "operation_id": "04e575f8-48d0-4c43-a8b3-78c4eb01d287",
        "policies": [
          {
            "assignment_id": "/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyAssignments/991a69402a6c484cb0f9b673/",
            "assignment_name": "991a69402a6c484cb0f9b673",
            "definition_id": "/subscriptions/<subscriptionID>/providers/Microsoft.Authorization/policyDefinitions/5775cdd5-d3d3-47bf-bc55-bb8b61746506/",
            "definition_name": "5775cdd5-d3d3-47bf-bc55-bb8b61746506"
          }
        ],
        "resource": {
          "group": "myResourceGroup",
          "id": "/subscriptions/<subscriptionID>/resourceGroups/myResourceGroup/providers/Microsoft.Sql/servers/contososqlpolicy",
          "location": "westus2",
          "type": "Microsoft.Resources/checkPolicyCompliance"
        }
      }
    },
    "log": {
      "level": "Warning"
    },
    "source": {
      "user": {
        "id": "33a68b9d-63ce-484c-a97e-94aef4c89648"
      }
    }
  }
}