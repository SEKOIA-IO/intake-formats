{
  "input": {
    "message": "{\"category\":\"WindowsEventLogsTable\",\"level\":\"Informational\",\"properties\":{\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"DeploymentId\":\"cbfba34a-3d3d-4425-aefb-968ee470a8f4\",\"Description\":\"Network connection detected:\\r\\nRuleName: \\r\\nUtcTime: 2019-12-18 16:57:18.516\\r\\nProcessGuid: {4A43FA81-5A68-5DFA-0000-0010A992AC18}\\r\\nProcessId: 4364\\r\\nImage: C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\r\\nUser: NT AUTHORITY\\\\SYSTEM\\r\\nProtocol: tcp\\r\\nInitiated: true\\r\\nSourceIsIpv6: false\\r\\nSourceIp: 10.100.8.36\\r\\nSourceHostname: AZNTPI-01.acme.local\\r\\nSourcePort: 55664\\r\\nSourcePortName: \\r\\nDestinationIsIpv6: false\\r\\nDestinationIp: 169.254.169.254\\r\\nDestinationHostname: \\r\\nDestinationPort: 80\\r\\nDestinationPortName: http\",\"EventId\":3,\"Level\":4,\"Opcode\":0,\"Pid\":2116,\"ProviderGuid\":\"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}\",\"ProviderName\":\"Microsoft-Windows-Sysmon\",\"RawXml\":\"<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385F-C22A-43E0-BF4C-06F5698FFBD9}'/><EventID>3</EventID><Version>5</Version><Level>4</Level><Task>3</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime='2019-12-18T16:57:17.936358800Z'/><EventRecordID>189923</EventRecordID><Correlation/><Execution ProcessID='2116' ThreadID='3760'/><Channel>Microsoft-Windows-Sysmon/Operational</Channel><Computer>AZNTPI-01.acme.local</Computer><Security UserID='S-1-5-18'/></System><EventData><Data Name='RuleName'></Data><Data Name='UtcTime'>2019-12-18 16:57:18.516</Data><Data Name='ProcessGuid'>{4A43FA81-5A68-5DFA-0000-0010A992AC18}</Data><Data Name='ProcessId'>4364</Data><Data Name='Image'>C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe</Data><Data Name='User'>NT AUTHORITY\\\\SYSTEM</Data><Data Name='Protocol'>tcp</Data><Data Name='Initiated'>true</Data><Data Name='SourceIsIpv6'>false</Data><Data Name='SourceIp'>10.100.8.36</Data><Data Name='SourceHostname'>AZNTPI-01.acme.local</Data><Data Name='SourcePort'>55664</Data><Data Name='SourcePortName'></Data><Data Name='DestinationIsIpv6'>false</Data><Data Name='DestinationIp'>169.254.169.254</Data><Data Name='DestinationHostname'></Data><Data Name='DestinationPort'>80</Data><Data Name='DestinationPortName'>http</Data></EventData></Event>\",\"Role\":\"IaaS\",\"RoleInstance\":\"_AZNTPI-01\",\"Task\":3,\"Tid\":3760},\"time\":\"2019-12-18T16:57:17.9363588Z\"}"
  },
  "expected": {
    "message": "{\"category\":\"WindowsEventLogsTable\",\"level\":\"Informational\",\"properties\":{\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"DeploymentId\":\"cbfba34a-3d3d-4425-aefb-968ee470a8f4\",\"Description\":\"Network connection detected:\\r\\nRuleName: \\r\\nUtcTime: 2019-12-18 16:57:18.516\\r\\nProcessGuid: {4A43FA81-5A68-5DFA-0000-0010A992AC18}\\r\\nProcessId: 4364\\r\\nImage: C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\r\\nUser: NT AUTHORITY\\\\SYSTEM\\r\\nProtocol: tcp\\r\\nInitiated: true\\r\\nSourceIsIpv6: false\\r\\nSourceIp: 10.100.8.36\\r\\nSourceHostname: AZNTPI-01.acme.local\\r\\nSourcePort: 55664\\r\\nSourcePortName: \\r\\nDestinationIsIpv6: false\\r\\nDestinationIp: 169.254.169.254\\r\\nDestinationHostname: \\r\\nDestinationPort: 80\\r\\nDestinationPortName: http\",\"EventId\":3,\"Level\":4,\"Opcode\":0,\"Pid\":2116,\"ProviderGuid\":\"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}\",\"ProviderName\":\"Microsoft-Windows-Sysmon\",\"RawXml\":\"<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385F-C22A-43E0-BF4C-06F5698FFBD9}'/><EventID>3</EventID><Version>5</Version><Level>4</Level><Task>3</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime='2019-12-18T16:57:17.936358800Z'/><EventRecordID>189923</EventRecordID><Correlation/><Execution ProcessID='2116' ThreadID='3760'/><Channel>Microsoft-Windows-Sysmon/Operational</Channel><Computer>AZNTPI-01.acme.local</Computer><Security UserID='S-1-5-18'/></System><EventData><Data Name='RuleName'></Data><Data Name='UtcTime'>2019-12-18 16:57:18.516</Data><Data Name='ProcessGuid'>{4A43FA81-5A68-5DFA-0000-0010A992AC18}</Data><Data Name='ProcessId'>4364</Data><Data Name='Image'>C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe</Data><Data Name='User'>NT AUTHORITY\\\\SYSTEM</Data><Data Name='Protocol'>tcp</Data><Data Name='Initiated'>true</Data><Data Name='SourceIsIpv6'>false</Data><Data Name='SourceIp'>10.100.8.36</Data><Data Name='SourceHostname'>AZNTPI-01.acme.local</Data><Data Name='SourcePort'>55664</Data><Data Name='SourcePortName'></Data><Data Name='DestinationIsIpv6'>false</Data><Data Name='DestinationIp'>169.254.169.254</Data><Data Name='DestinationHostname'></Data><Data Name='DestinationPort'>80</Data><Data Name='DestinationPortName'>http</Data></EventData></Event>\",\"Role\":\"IaaS\",\"RoleInstance\":\"_AZNTPI-01\",\"Task\":3,\"Tid\":3760},\"time\":\"2019-12-18T16:57:17.9363588Z\"}",
    "event": {
      "code": "3",
      "outcome": "success",
      "provider": "Microsoft-Windows-Sysmon"
    },
    "action": {
      "id": 3,
      "name": "Network connection",
      "outcome": "success",
      "properties": {
        "DestinationHostname": null,
        "DestinationIp": "169.254.169.254",
        "DestinationIsIpv6": "false",
        "DestinationPort": "80",
        "DestinationPortName": "http",
        "Image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
        "Initiated": "true",
        "Opcode": 0,
        "ProcessGuid": "{4A43FA81-5A68-5DFA-0000-0010A992AC18}",
        "ProcessId": "4364",
        "Protocol": "tcp",
        "RuleName": null,
        "SourceHostname": "AZNTPI-01.acme.local",
        "SourceIp": "10.100.8.36",
        "SourceIsIpv6": "false",
        "SourcePort": "55664",
        "SourcePortName": null,
        "User": "NT AUTHORITY\\SYSTEM",
        "UtcTime": "2019-12-18 16:57:18.516"
      },
      "record_id": 189923,
      "target": "network-traffic",
      "type": "Microsoft-Windows-Sysmon/Operational"
    },
    "azure_windows": {
      "opcode": "0",
      "provider_guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "provider_name": "Microsoft-Windows-Sysmon",
      "task": "3"
    },
    "destination": {
      "address": "169.254.169.254",
      "ip": "169.254.169.254",
      "port": 80
    },
    "host": {
      "hostname": "AZNTPI-01.acme.local",
      "name": "AZNTPI-01.acme.local"
    },
    "log": {
      "hostname": "AZNTPI-01.acme.local"
    },
    "network": {
      "transport": "tcp",
      "type": "ipv4"
    },
    "os": {
      "family": "windows",
      "platform": "windows"
    },
    "process": {
      "executable": "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe",
      "name": "powershell.exe",
      "parent": {
        "pid": 4364
      },
      "pid": 2116,
      "thread": {
        "id": 3760
      },
      "working_directory": "c:\\windows\\system32\\windowspowershell\\v1.0"
    },
    "related": {
      "hosts": [
        "AZNTPI-01.acme.local"
      ],
      "ip": [
        "10.100.8.36",
        "169.254.169.254"
      ],
      "user": [
        "SYSTEM"
      ]
    },
    "source": {
      "address": "AZNTPI-01.acme.local",
      "domain": "AZNTPI-01.acme.local",
      "ip": "10.100.8.36",
      "port": 55664,
      "size_in_char": 20,
      "subdomain": "AZNTPI-01.acme"
    },
    "user": {
      "domain": "NT AUTHORITY",
      "name": "SYSTEM"
    }
  }
}