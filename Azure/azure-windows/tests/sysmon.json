{
  "input": {
    "sekoiaio": {
      "intake": {
        "dialect": "Azure Windows",
        "dialect_uuid": "2815eaab-2425-4eff-8038-3f7d5a3b8b11"
      }
    },
    "message": "{\"category\":\"WindowsEventLogsTable\",\"level\":\"Informational\",\"properties\":{\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"DeploymentId\":\"86d017b9-31b7-47d4-98e0-667a2ac68873\",\"Description\":\"Process Create:\\r\\nRuleName: \\r\\nUtcTime: 2019-08-30 14:53:03.012\\r\\nProcessGuid: {f67648d5-384f-5d69-0000-00101bd8b501}\\r\\nProcessId: 6272\\r\\nImage: C:\\\\Windows\\\\System32\\\\cscript.exe\\r\\nFileVersion: 5.812.10240.16384\\r\\nDescription: Microsoft \\u00ae Console Based Script Host\\r\\nProduct: Microsoft \\u00ae Windows Script Host\\r\\nCompany: Microsoft Corporation\\r\\nOriginalFileName: cscript.exe\\r\\nCommandLine: \\\"C:\\\\windows\\\\system32\\\\cscript.exe\\\" /nologo \\\"MonitorKnowledgeDiscovery.vbs\\\"\\r\\nCurrentDirectory: C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\Health Service State\\\\Monitoring Host Temporary Files 3\\\\507\\\\\\r\\nUser: NT AUTHORITY\\\\SYSTEM\\r\\nLogonGuid: {f67648d5-e752-5d68-0000-0020e7030000}\\r\\nLogonId: 0x3E7\\r\\nTerminalSessionId: 0\\r\\nIntegrityLevel: System\\r\\nHashes: MD5=A45586B3A5A291516CD10EF4FD3EE768,SHA256=59D3CDC7D51FA34C6B27B8B04EA17992955466EB25022B7BD64880AB35DF0BBC\\r\\nParentProcessGuid: {f67648d5-e7c8-5d68-0000-00109ed81e00}\\r\\nParentProcessId: 10068\\r\\nParentImage: C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe\\r\\nParentCommandLine: \\\"C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe\\\" -Embedding\",\"EventId\":1,\"Level\":4,\"Opcode\":0,\"Pid\":3272,\"ProviderGuid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\",\"ProviderName\":\"Microsoft-Windows-Sysmon\",\"RawXml\":\"<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385f-c22a-43e0-bf4c-06f5698ffbd9}'/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime='2019-08-30T14:53:03.064863900Z'/><EventRecordID>120166</EventRecordID><Correlation/><Execution ProcessID='3272' ThreadID='5036'/><Channel>Microsoft-Windows-Sysmon/Operational</Channel><Computer>WindowsDesktop</Computer><Security UserID='S-1-5-18'/></System><EventData><Data Name='RuleName'></Data><Data Name='UtcTime'>2019-08-30 14:53:03.012</Data><Data Name='ProcessGuid'>{f67648d5-384f-5d69-0000-00101bd8b501}</Data><Data Name='ProcessId'>6272</Data><Data Name='Image'>C:\\\\Windows\\\\System32\\\\cscript.exe</Data><Data Name='FileVersion'>5.812.10240.16384</Data><Data Name='Description'>Microsoft \\u00ae Console Based Script Host</Data><Data Name='Product'>Microsoft \\u00ae Windows Script Host</Data><Data Name='Company'>Microsoft Corporation</Data><Data Name='OriginalFileName'>cscript.exe</Data><Data Name='CommandLine'>\\\"C:\\\\windows\\\\system32\\\\cscript.exe\\\" /nologo \\\"MonitorKnowledgeDiscovery.vbs\\\"</Data><Data Name='CurrentDirectory'>C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\Health Service State\\\\Monitoring Host Temporary Files 3\\\\507\\\\</Data><Data Name='User'>NT AUTHORITY\\\\SYSTEM</Data><Data Name='LogonGuid'>{f67648d5-e752-5d68-0000-0020e7030000}</Data><Data Name='LogonId'>0x3e7</Data><Data Name='TerminalSessionId'>0</Data><Data Name='IntegrityLevel'>System</Data><Data Name='Hashes'>MD5=A45586B3A5A291516CD10EF4FD3EE768,SHA256=59D3CDC7D51FA34C6B27B8B04EA17992955466EB25022B7BD64880AB35DF0BBC</Data><Data Name='ParentProcessGuid'>{f67648d5-e7c8-5d68-0000-00109ed81e00}</Data><Data Name='ParentProcessId'>10068</Data><Data Name='ParentImage'>C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe</Data><Data Name='ParentCommandLine'>\\\"C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe\\\" -Embedding</Data></EventData></Event>\",\"Role\":\"IaaS\",\"RoleInstance\":\"_WindowsDesktop\",\"Task\":1,\"Tid\":5036},\"time\":\"2019-08-30T14:53:03.0648639Z\"}"
  },
  "expected": {
    "message": "{\"category\":\"WindowsEventLogsTable\",\"level\":\"Informational\",\"properties\":{\"Channel\":\"Microsoft-Windows-Sysmon/Operational\",\"DeploymentId\":\"86d017b9-31b7-47d4-98e0-667a2ac68873\",\"Description\":\"Process Create:\\r\\nRuleName: \\r\\nUtcTime: 2019-08-30 14:53:03.012\\r\\nProcessGuid: {f67648d5-384f-5d69-0000-00101bd8b501}\\r\\nProcessId: 6272\\r\\nImage: C:\\\\Windows\\\\System32\\\\cscript.exe\\r\\nFileVersion: 5.812.10240.16384\\r\\nDescription: Microsoft \\u00ae Console Based Script Host\\r\\nProduct: Microsoft \\u00ae Windows Script Host\\r\\nCompany: Microsoft Corporation\\r\\nOriginalFileName: cscript.exe\\r\\nCommandLine: \\\"C:\\\\windows\\\\system32\\\\cscript.exe\\\" /nologo \\\"MonitorKnowledgeDiscovery.vbs\\\"\\r\\nCurrentDirectory: C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\Health Service State\\\\Monitoring Host Temporary Files 3\\\\507\\\\\\r\\nUser: NT AUTHORITY\\\\SYSTEM\\r\\nLogonGuid: {f67648d5-e752-5d68-0000-0020e7030000}\\r\\nLogonId: 0x3E7\\r\\nTerminalSessionId: 0\\r\\nIntegrityLevel: System\\r\\nHashes: MD5=A45586B3A5A291516CD10EF4FD3EE768,SHA256=59D3CDC7D51FA34C6B27B8B04EA17992955466EB25022B7BD64880AB35DF0BBC\\r\\nParentProcessGuid: {f67648d5-e7c8-5d68-0000-00109ed81e00}\\r\\nParentProcessId: 10068\\r\\nParentImage: C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe\\r\\nParentCommandLine: \\\"C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe\\\" -Embedding\",\"EventId\":1,\"Level\":4,\"Opcode\":0,\"Pid\":3272,\"ProviderGuid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\",\"ProviderName\":\"Microsoft-Windows-Sysmon\",\"RawXml\":\"<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385f-c22a-43e0-bf4c-06f5698ffbd9}'/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime='2019-08-30T14:53:03.064863900Z'/><EventRecordID>120166</EventRecordID><Correlation/><Execution ProcessID='3272' ThreadID='5036'/><Channel>Microsoft-Windows-Sysmon/Operational</Channel><Computer>WindowsDesktop</Computer><Security UserID='S-1-5-18'/></System><EventData><Data Name='RuleName'></Data><Data Name='UtcTime'>2019-08-30 14:53:03.012</Data><Data Name='ProcessGuid'>{f67648d5-384f-5d69-0000-00101bd8b501}</Data><Data Name='ProcessId'>6272</Data><Data Name='Image'>C:\\\\Windows\\\\System32\\\\cscript.exe</Data><Data Name='FileVersion'>5.812.10240.16384</Data><Data Name='Description'>Microsoft \\u00ae Console Based Script Host</Data><Data Name='Product'>Microsoft \\u00ae Windows Script Host</Data><Data Name='Company'>Microsoft Corporation</Data><Data Name='OriginalFileName'>cscript.exe</Data><Data Name='CommandLine'>\\\"C:\\\\windows\\\\system32\\\\cscript.exe\\\" /nologo \\\"MonitorKnowledgeDiscovery.vbs\\\"</Data><Data Name='CurrentDirectory'>C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\Health Service State\\\\Monitoring Host Temporary Files 3\\\\507\\\\</Data><Data Name='User'>NT AUTHORITY\\\\SYSTEM</Data><Data Name='LogonGuid'>{f67648d5-e752-5d68-0000-0020e7030000}</Data><Data Name='LogonId'>0x3e7</Data><Data Name='TerminalSessionId'>0</Data><Data Name='IntegrityLevel'>System</Data><Data Name='Hashes'>MD5=A45586B3A5A291516CD10EF4FD3EE768,SHA256=59D3CDC7D51FA34C6B27B8B04EA17992955466EB25022B7BD64880AB35DF0BBC</Data><Data Name='ParentProcessGuid'>{f67648d5-e7c8-5d68-0000-00109ed81e00}</Data><Data Name='ParentProcessId'>10068</Data><Data Name='ParentImage'>C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe</Data><Data Name='ParentCommandLine'>\\\"C:\\\\Program Files\\\\Microsoft Monitoring Agent\\\\Agent\\\\MonitoringHost.exe\\\" -Embedding</Data></EventData></Event>\",\"Role\":\"IaaS\",\"RoleInstance\":\"_WindowsDesktop\",\"Task\":1,\"Tid\":5036},\"time\":\"2019-08-30T14:53:03.0648639Z\"}",
    "event": {
      "code": "1",
      "provider": "Microsoft-Windows-Sysmon"
    },
    "os": {
      "family": "windows",
      "platform": "windows"
    },
    "host": {
      "hostname": "WindowsDesktop",
      "name": "WindowsDesktop"
    },
    "user": {
      "name": "SYSTEM",
      "domain": "NT AUTHORITY"
    },
    "process": {
      "thread": {
        "id": 5036
      },
      "pid": 3272,
      "hash": {
        "md5": "a45586b3a5a291516cd10ef4fd3ee768",
        "sha256": "59d3cdc7d51fa34c6b27b8b04ea17992955466eb25022b7bd64880ab35df0bbc"
      },
      "name": "cscript.exe",
      "working_directory": "c:\\windows\\system32",
      "executable": "c:\\windows\\system32\\cscript.exe",
      "command_line": "c:\\windows\\system32\\cscript.exe /nologo monitorknowledgediscovery.vbs",
      "parent": {
        "name": "monitoringhost.exe",
        "working_directory": "c:\\program files\\microsoft monitoring agent\\agent",
        "executable": "c:\\program files\\microsoft monitoring agent\\agent\\monitoringhost.exe",
        "command_line": "c:\\program files\\microsoft monitoring agent\\agent\\monitoringhost.exe -embedding",
        "pid": 6272
      }
    },
    "azure_windows": {
      "task": "1",
      "opcode": "0",
      "provider_guid": "5770385f-c22a-43e0-bf4c-06f5698ffbd9",
      "provider_name": "Microsoft-Windows-Sysmon",
      "event_data": {
        "RuleName": null,
        "UtcTime": "2019-08-30 14:53:03.012",
        "ProcessGuid": "{f67648d5-384f-5d69-0000-00101bd8b501}",
        "ProcessId": "6272",
        "Image": "C:\\Windows\\System32\\cscript.exe",
        "FileVersion": "5.812.10240.16384",
        "Description": "Microsoft \u00ae Console Based Script Host",
        "Product": "Microsoft \u00ae Windows Script Host",
        "Company": "Microsoft Corporation",
        "OriginalFileName": "cscript.exe",
        "CommandLine": "\"C:\\windows\\system32\\cscript.exe\" /nologo \"MonitorKnowledgeDiscovery.vbs\"",
        "CurrentDirectory": "C:\\Program Files\\Microsoft Monitoring Agent\\Agent\\Health Service State\\Monitoring Host Temporary Files 3\\507\\",
        "User": "NT AUTHORITY\\SYSTEM",
        "LogonGuid": "{f67648d5-e752-5d68-0000-0020e7030000}",
        "LogonId": "0x3e7",
        "TerminalSessionId": "0",
        "IntegrityLevel": "System",
        "Hashes": "MD5=A45586B3A5A291516CD10EF4FD3EE768,SHA256=59D3CDC7D51FA34C6B27B8B04EA17992955466EB25022B7BD64880AB35DF0BBC",
        "ParentProcessGuid": "{f67648d5-e7c8-5d68-0000-00109ed81e00}",
        "ParentProcessId": "10068",
        "ParentImage": "C:\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe",
        "ParentCommandLine": "\"C:\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe\" -Embedding"
      }
    },
    "action": {
      "type": "Microsoft-Windows-Sysmon/Operational",
      "id": 1,
      "record_id": 120166,
      "properties": [
        {
          "opcode": 0,
          "ParentImage": "c:\\program files\\microsoft monitoring agent\\agent\\monitoringhost.exe"
        }
      ],
      "name": "Process creation",
      "outcome": "success"
    },
    "related": {
      "hash": [
        "59d3cdc7d51fa34c6b27b8b04ea17992955466eb25022b7bd64880ab35df0bbc",
        "a45586b3a5a291516cd10ef4fd3ee768"
      ],
      "hosts": [
        "WindowsDesktop"
      ],
      "user": [
        "SYSTEM"
      ]
    }
  }
}