{
  "input": {
    "message": "{\n  \"time\": \"2024-07-12T11:54:54.8818733Z\",\n  \"category\": \"WindowsEventLogsTable\",\n  \"level\": \"Informational\",\n  \"properties\": {\n    \"DeploymentId\": \"xxxxx-xxxxx-xxxxxx-xxxxx\",\n    \"Role\": \"IaaS\",\n    \"RoleInstance\": \"_testcomputer\",\n    \"ProviderGuid\": \"{xxxxx-xxxxx-xxxxx}\",\n    \"ProviderName\": \"Microsoft-Windows-Security-Auditing\",\n    \"EventId\": 4768,\n    \"Level\": 0,\n    \"Pid\": 740,\n    \"Tid\": 9900,\n    \"Opcode\": 0,\n    \"Task\": 14339,\n    \"Channel\": \"Security\",\n    \"Description\": \"A Kerberos authentication ticket (TGT) was requested.\\r\\n\\r\\nAccount Information:\\r\\n\\tAccount Name:\\t\\tTargetUsername\\r\\n\\tSupplied Realm Name:\\tFR.test.local\\r\\n\\tUser ID:\\t\\t\\tS-1-5-21-xxxxxx-xxxxx-xxxxx\\r\\n\\r\\nService Information:\\r\\n\\tService Name:\\t\\tkrbtgt\\r\\n\\tService ID:\\t\\tS-1-5-21-xxxxx-xxxxx-xxxxx\\r\\n\\r\\nNetwork Information:\\r\\n\\tClient Address:\\t\\t::ffff:1.2.3.4\\r\\n\\tClient Port:\\t\\t8080\\r\\n\\r\\nAdditional Information:\\r\\n\\tTicket Options:\\t\\t0x40810010\\r\\n\\tResult Code:\\t\\t0x0\\r\\n\\tTicket Encryption Type:\\t0x12\\r\\n\\tPre-Authentication Type:\\t2\\r\\n\\r\\nCertificate Information:\\r\\n\\tCertificate Issuer Name:\\t\\t\\r\\n\\tCertificate Serial Number:\\t\\r\\n\\tCertificate Thumbprint:\\t\\t\\r\\n\\r\\nCertificate information is only provided if a certificate was used for pre-authentication.\\r\\n\\r\\nPre-authentication types, ticket options, encryption types and result codes are defined in RFC 4120.\",\n    \"RawXml\": \"<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Security-Auditing' Guid='{xxxxx-xxxxx-xxxxx}'/><EventID>4768</EventID><Version>0</Version><Level>0</Level><Task>14339</Task><Opcode>0</Opcode><Keywords>0x10000000000000</Keywords><TimeCreated SystemTime='2024-07-12T11:54:54.881873300Z'/><EventRecordID>111111111</EventRecordID><Correlation/><Execution ProcessID='740' ThreadID='9900'/><Channel>Security</Channel><Computer>testcomputer.fr.test.local</Computer><Security/></System><EventData><Data Name='TargetUserName'>TargetUsername</Data><Data Name='TargetDomainName'>FR.test.local</Data><Data Name='TargetSid'>S-1-5-21-xxxxxx-xxxxx-xxxxx</Data><Data Name='ServiceName'>krbtgt</Data><Data Name='ServiceSid'>S-1-5-21-xxxxx-xxxxx-xxxxx</Data><Data Name='TicketOptions'>0x40810010</Data><Data Name='Status'>0x0</Data><Data Name='TicketEncryptionType'>0x12</Data><Data Name='PreAuthType'>2</Data><Data Name='IpAddress'>::ffff:1.2.3.4</Data><Data Name='IpPort'>8080</Data><Data Name='CertIssuerName'></Data><Data Name='CertSerialNumber'></Data><Data Name='CertThumbprint'></Data></EventData></Event>\"\n  }\n}"
  },
  "expected": {
    "message": "{\n  \"time\": \"2024-07-12T11:54:54.8818733Z\",\n  \"category\": \"WindowsEventLogsTable\",\n  \"level\": \"Informational\",\n  \"properties\": {\n    \"DeploymentId\": \"xxxxx-xxxxx-xxxxxx-xxxxx\",\n    \"Role\": \"IaaS\",\n    \"RoleInstance\": \"_testcomputer\",\n    \"ProviderGuid\": \"{xxxxx-xxxxx-xxxxx}\",\n    \"ProviderName\": \"Microsoft-Windows-Security-Auditing\",\n    \"EventId\": 4768,\n    \"Level\": 0,\n    \"Pid\": 740,\n    \"Tid\": 9900,\n    \"Opcode\": 0,\n    \"Task\": 14339,\n    \"Channel\": \"Security\",\n    \"Description\": \"A Kerberos authentication ticket (TGT) was requested.\\r\\n\\r\\nAccount Information:\\r\\n\\tAccount Name:\\t\\tTargetUsername\\r\\n\\tSupplied Realm Name:\\tFR.test.local\\r\\n\\tUser ID:\\t\\t\\tS-1-5-21-xxxxxx-xxxxx-xxxxx\\r\\n\\r\\nService Information:\\r\\n\\tService Name:\\t\\tkrbtgt\\r\\n\\tService ID:\\t\\tS-1-5-21-xxxxx-xxxxx-xxxxx\\r\\n\\r\\nNetwork Information:\\r\\n\\tClient Address:\\t\\t::ffff:1.2.3.4\\r\\n\\tClient Port:\\t\\t8080\\r\\n\\r\\nAdditional Information:\\r\\n\\tTicket Options:\\t\\t0x40810010\\r\\n\\tResult Code:\\t\\t0x0\\r\\n\\tTicket Encryption Type:\\t0x12\\r\\n\\tPre-Authentication Type:\\t2\\r\\n\\r\\nCertificate Information:\\r\\n\\tCertificate Issuer Name:\\t\\t\\r\\n\\tCertificate Serial Number:\\t\\r\\n\\tCertificate Thumbprint:\\t\\t\\r\\n\\r\\nCertificate information is only provided if a certificate was used for pre-authentication.\\r\\n\\r\\nPre-authentication types, ticket options, encryption types and result codes are defined in RFC 4120.\",\n    \"RawXml\": \"<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-Security-Auditing' Guid='{xxxxx-xxxxx-xxxxx}'/><EventID>4768</EventID><Version>0</Version><Level>0</Level><Task>14339</Task><Opcode>0</Opcode><Keywords>0x10000000000000</Keywords><TimeCreated SystemTime='2024-07-12T11:54:54.881873300Z'/><EventRecordID>111111111</EventRecordID><Correlation/><Execution ProcessID='740' ThreadID='9900'/><Channel>Security</Channel><Computer>testcomputer.fr.test.local</Computer><Security/></System><EventData><Data Name='TargetUserName'>TargetUsername</Data><Data Name='TargetDomainName'>FR.test.local</Data><Data Name='TargetSid'>S-1-5-21-xxxxxx-xxxxx-xxxxx</Data><Data Name='ServiceName'>krbtgt</Data><Data Name='ServiceSid'>S-1-5-21-xxxxx-xxxxx-xxxxx</Data><Data Name='TicketOptions'>0x40810010</Data><Data Name='Status'>0x0</Data><Data Name='TicketEncryptionType'>0x12</Data><Data Name='PreAuthType'>2</Data><Data Name='IpAddress'>::ffff:1.2.3.4</Data><Data Name='IpPort'>8080</Data><Data Name='CertIssuerName'></Data><Data Name='CertSerialNumber'></Data><Data Name='CertThumbprint'></Data></EventData></Event>\"\n  }\n}",
    "event": {
      "code": "4768",
      "outcome": "success",
      "provider": "Microsoft-Windows-Security-Auditing"
    },
    "action": {
      "id": 4768,
      "name": "A Kerberos authentication ticket (TGT) was requested",
      "outcome": "success",
      "properties": [
        {
          "EventType": "AUDIT_FAILURE",
          "opcode": 0
        }
      ],
      "record_id": 111111111,
      "type": "Security"
    },
    "azure_windows": {
      "event_data": {
        "CertIssuerName": null,
        "CertSerialNumber": null,
        "CertThumbprint": null,
        "IpAddress": "::ffff:1.2.3.4",
        "IpPort": "8080",
        "PreAuthType": "2",
        "ServiceName": "krbtgt",
        "ServiceSid": "S-1-5-21-xxxxx-xxxxx-xxxxx",
        "Status": "0x0",
        "TargetDomainName": "FR.test.local",
        "TargetSid": "S-1-5-21-xxxxxx-xxxxx-xxxxx",
        "TargetUserName": "TargetUsername",
        "TicketEncryptionType": "0x12",
        "TicketOptions": "0x40810010"
      },
      "opcode": "0",
      "provider_guid": "xxxxx-xxxxx-xxxxx",
      "provider_name": "Microsoft-Windows-Security-Auditing",
      "task": "14339"
    },
    "host": {
      "hostname": "testcomputer.fr.test.local",
      "name": "testcomputer.fr.test.local"
    },
    "log": {
      "hostname": "testcomputer.fr.test.local"
    },
    "os": {
      "family": "windows",
      "platform": "windows"
    },
    "process": {
      "pid": 740,
      "thread": {
        "id": 9900
      }
    },
    "related": {
      "hosts": [
        "testcomputer.fr.test.local"
      ],
      "ip": [
        "::ffff:102:304"
      ]
    },
    "source": {
      "address": "::ffff:102:304",
      "ip": "::ffff:102:304",
      "port": 8080
    }
  }
}