{
  "input": {
    "message": "CEF:0|Fortinet|Fortigate|v6.0.3|30258|utm:waf waf-http-constraint passthrough|4|deviceExternalId=FGT5HD3915800610 FTNTFGTlogid=1203030258 cat=utm:waf FTNTFGTsubtype=waf FTNTFGTeventtype=waf-http-constraint FTNTFGTlevel=warning FTNTFGTvd=vdom1 FTNTFGTeventtime=1545951320 FTNTFGTpolicyid=1 externalId=13614 duser=bob FTNTFGTprofile=waf_test src=10.1.100.11 spt=57304 dst=example.com dpt=80 deviceInboundInterface=port12 FTNTFGTsrcintfrole=lan deviceOutboundInterface=port11 FTNTFGTdstintfrole=wan proto=6 app=HTTP request=http://example.com/index.html?https://example.com/ FTNTFGTseverity=medium act=passthrough deviceDirection=0 requestClientApplication=curl/7.47.0 FTNTFGTconstraint=url-param-num FTNTFGTrawdata=Method\\=GET|User-Agent\\=curl/7.47.0"
  },
  "expected": {
    "message": "CEF:0|Fortinet|Fortigate|v6.0.3|30258|utm:waf waf-http-constraint passthrough|4|deviceExternalId=FGT5HD3915800610 FTNTFGTlogid=1203030258 cat=utm:waf FTNTFGTsubtype=waf FTNTFGTeventtype=waf-http-constraint FTNTFGTlevel=warning FTNTFGTvd=vdom1 FTNTFGTeventtime=1545951320 FTNTFGTpolicyid=1 externalId=13614 duser=bob FTNTFGTprofile=waf_test src=10.1.100.11 spt=57304 dst=example.com dpt=80 deviceInboundInterface=port12 FTNTFGTsrcintfrole=lan deviceOutboundInterface=port11 FTNTFGTdstintfrole=wan proto=6 app=HTTP request=http://example.com/index.html?https://example.com/ FTNTFGTseverity=medium act=passthrough deviceDirection=0 requestClientApplication=curl/7.47.0 FTNTFGTconstraint=url-param-num FTNTFGTrawdata=Method\\=GET|User-Agent\\=curl/7.47.0",
    "event": {
      "action": "passthrough",
      "category": "utm",
      "code": "1203030258",
      "dataset": "utm:waf",
      "outcome": "success"
    },
    "@timestamp": "2018-12-27T22:55:20Z",
    "action": {
      "name": "passthrough",
      "outcome": "success",
      "target": "network-traffic",
      "type": "waf-http-constraint - waf"
    },
    "destination": {
      "address": "example.com",
      "port": 80,
      "user": {
        "name": "bob"
      }
    },
    "fortinet": {
      "fortigate": {
        "event": {
          "severity": "medium"
        },
        "policyid": "1",
        "security_profile": "waf_test",
        "virtual_domain": "vdom1"
      }
    },
    "log": {
      "level": "warning"
    },
    "network": {
      "application": "HTTP",
      "direction": "inbound",
      "protocol": "http",
      "transport": "tcp"
    },
    "observer": {
      "egress": {
        "interface": {
          "alias": "wan",
          "name": "port11"
        }
      },
      "ingress": {
        "interface": {
          "alias": "lan",
          "name": "port12"
        }
      },
      "serial_number": "FGT5HD3915800610",
      "type": "Fortigate",
      "vendor": "Fortinet",
      "version": "v6.0.3"
    },
    "related": {
      "ip": [
        "10.1.100.11"
      ],
      "user": [
        "bob"
      ]
    },
    "source": {
      "address": "10.1.100.11",
      "ip": "10.1.100.11",
      "port": 57304
    },
    "url": {
      "domain": "example.com",
      "full": "http://example.com/index.html?https://example.com/",
      "original": "http://example.com/index.html?https://example.com/",
      "path": "/index.html",
      "port": 80,
      "query": "https://example.com/",
      "registered_domain": "example.com",
      "scheme": "http",
      "top_level_domain": "com"
    },
    "user_agent": {
      "device": {
        "name": "Other"
      },
      "name": "curl",
      "original": "curl/7.47.0",
      "os": {
        "name": "Other"
      },
      "version": "7.47.0"
    }
  }
}