{
  "input": {
    "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"fileName\": \"tpsreport.docx\", \"sha256\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"subject\": \"Redacted\", \"senderEnvelope\": \"john.doe@example.com\", \"messageId\": \"11111111111111111111111111111111111111@example.com\", \"senderDomainInternal\": \"true\", \"eventType\": \"av\", \"sha1\": \"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\", \"accountId\": \"ANONYMIZED\", \"virusFound\": \"bad.virus.found\", \"route\": \"Inbound\", \"recipients\": \"john.doe@example.com\", \"fileExtension\": \"docx\", \"subType\": null, \"senderIp\": \"1.2.3.4\", \"senderDomain\": \"mimecast.com\", \"timestamp\": 1689685338586, \"emailSize\": \"1648832\", \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\"}"
  },
  "expected": {
    "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"fileName\": \"tpsreport.docx\", \"sha256\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"subject\": \"Redacted\", \"senderEnvelope\": \"john.doe@example.com\", \"messageId\": \"11111111111111111111111111111111111111@example.com\", \"senderDomainInternal\": \"true\", \"eventType\": \"av\", \"sha1\": \"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\", \"accountId\": \"ANONYMIZED\", \"virusFound\": \"bad.virus.found\", \"route\": \"Inbound\", \"recipients\": \"john.doe@example.com\", \"fileExtension\": \"docx\", \"subType\": null, \"senderIp\": \"1.2.3.4\", \"senderDomain\": \"mimecast.com\", \"timestamp\": 1689685338586, \"emailSize\": \"1648832\", \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\"}",
    "event": {
      "category": [
        "email"
      ],
      "dataset": "av",
      "provider": "Mimecast",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2023-07-18T13:02:18.586000Z",
    "email": {
      "attachments": [
        {
          "file": {
            "hash": {
              "md5": "68b329da9893e34099c7d8ad5cb9c940",
              "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
              "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "tpsreport.docx"
          }
        }
      ],
      "from": {
        "address": [
          "john.doe@example.com"
        ]
      },
      "message_id": "11111111111111111111111111111111111111@example.com",
      "subject": "Redacted",
      "to": {
        "address": [
          "john.doe@example.com"
        ]
      }
    },
    "file": {
      "name": "tpsreport.docx"
    },
    "mimecast": {
      "siem": {
        "aggregate_id": "aggregateId",
        "processing_id": "processingId",
        "virus_found": "bad.virus.found"
      }
    },
    "network": {
      "direction": "inbound"
    },
    "organization": {
      "id": "ANONYMIZED"
    },
    "related": {
      "ip": [
        "1.2.3.4"
      ]
    },
    "source": {
      "address": "1.2.3.4",
      "ip": "1.2.3.4"
    }
  }
}