{
  "input": {
    "message": "{\"genTime\": \"2025-08-20T13:37:22Z\", \"timestamp\": \"2025-08-20T13:37:13Z\", \"deliveryTime\": \"2025-08-20T13:37:16Z\", \"sender\": \"john.doe@example.org\", \"direction\": \"in\", \"messageID\": \"<11111111111111111111111111111111111111@example.org>\", \"subject\": \"Test subject\", \"size\": 41499, \"mailID\": \"663e0c94-1988-4de6-bbbf-a60f015fd7cd\", \"recipient\": \"jane.doe@example.org\", \"action\": \"Delivered\", \"tlsInfo\": \"upstreamTLS: TLS 1.3; downstreamTLS: TLS 1.3\", \"headerFrom\": \"john.doe@example.org\", \"headerTo\": [\"jane.doe@example.org\"], \"senderIP\": \"1.2.3.4\", \"deliveredTo\": \"antispam.example.org[5.6.7.8]:25\", \"attachments\": [{\"fileName\": \"image001.png\", \"sha256\": \"1b4f0e9851971998e732078544c96b36c3d01cedf7caa332359d6f1d83567014\"}, {\"fileName\": \"image_emb_001.png\", \"sha256\": \"60303ae22b998861bce3b28f33eec1be758a213c86c93c076dbe9f558c11c752\"}], \"embeddedUrls\": [\"https://aws.amazon.com\", \"https://cloud.google.com\", \"https://www.azure.com\"], \"details\": \"250 2.6.0 v [InternalId=123456, Hostname=EXAMPLE.PROD.OUTLOOK.COM] 57370 bytes in 0.843, 66.399 KB/sec Queued mail for delivery\"}"
  },
  "expected": {
    "message": "{\"genTime\": \"2025-08-20T13:37:22Z\", \"timestamp\": \"2025-08-20T13:37:13Z\", \"deliveryTime\": \"2025-08-20T13:37:16Z\", \"sender\": \"john.doe@example.org\", \"direction\": \"in\", \"messageID\": \"<11111111111111111111111111111111111111@example.org>\", \"subject\": \"Test subject\", \"size\": 41499, \"mailID\": \"663e0c94-1988-4de6-bbbf-a60f015fd7cd\", \"recipient\": \"jane.doe@example.org\", \"action\": \"Delivered\", \"tlsInfo\": \"upstreamTLS: TLS 1.3; downstreamTLS: TLS 1.3\", \"headerFrom\": \"john.doe@example.org\", \"headerTo\": [\"jane.doe@example.org\"], \"senderIP\": \"1.2.3.4\", \"deliveredTo\": \"antispam.example.org[5.6.7.8]:25\", \"attachments\": [{\"fileName\": \"image001.png\", \"sha256\": \"1b4f0e9851971998e732078544c96b36c3d01cedf7caa332359d6f1d83567014\"}, {\"fileName\": \"image_emb_001.png\", \"sha256\": \"60303ae22b998861bce3b28f33eec1be758a213c86c93c076dbe9f558c11c752\"}], \"embeddedUrls\": [\"https://aws.amazon.com\", \"https://cloud.google.com\", \"https://www.azure.com\"], \"details\": \"250 2.6.0 v [InternalId=123456, Hostname=EXAMPLE.PROD.OUTLOOK.COM] 57370 bytes in 0.843, 66.399 KB/sec Queued mail for delivery\"}",
    "event": {
      "action": "Delivered",
      "category": [
        "email"
      ],
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-08-20T13:37:13Z",
    "email": {
      "attachments": [
        {
          "file": {
            "hash": {
              "sha256": "1b4f0e9851971998e732078544c96b36c3d01cedf7caa332359d6f1d83567014"
            },
            "name": "image001.png"
          }
        },
        {
          "file": {
            "hash": {
              "sha256": "60303ae22b998861bce3b28f33eec1be758a213c86c93c076dbe9f558c11c752"
            },
            "name": "image_emb_001.png"
          }
        }
      ],
      "from": {
        "address": "john.doe@example.org"
      },
      "local_id": "663e0c94-1988-4de6-bbbf-a60f015fd7cd",
      "message_id": "11111111111111111111111111111111111111@example.org",
      "sender": {
        "address": "john.doe@example.org"
      },
      "subject": "Test subject",
      "to": {
        "address": [
          "jane.doe@example.org"
        ]
      }
    },
    "trendmicro": {
      "email": {
        "embedded_urls": [
          "https://aws.amazon.com",
          "https://cloud.google.com",
          "https://www.azure.com"
        ]
      }
    }
  }
}