[
  {
    "value": "{source.ip} performed a DNS query of type {dns.question.type} for name {dns.question.name}",
    "relationships": [
      {
        "source": "source.ip",
        "target": "dns.question.name",
        "type": "resolved"
      }
    ],
    "conditions": [
      { "field": "source.ip" },
      { "field": "dns.question.type" },
      { "field": "dns.question.name" }
    ]
  },
  {
    "value": "{source.ip} resolved domain name {dns.question.name}",
    "relationships": [
      {
        "source": "source.ip",
        "target": "dns.question.name",
        "type": "resolved"
      }
    ],
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "dns.question.type",
        "value": "A"
      }
    ]
  },
  {
    "value": "DNS reply from {source.ip}: {dns.response_code}",
    "conditions": [
      {
        "field": "dns.type",
        "value": "answer"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "dns.response_code"
      }
    ]
  }
]
