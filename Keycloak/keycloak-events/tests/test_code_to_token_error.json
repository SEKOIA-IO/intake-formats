{
  "input": {
    "message": "{\"@timestamp\":\"2025-11-21T13:55:09.111222333Z\",\"event.sequence\":4420,\"log.logger\":\"org.keycloak.events\",\"log.level\":\"WARN\",\"message\":\"type=\\\"CODE_TO_TOKEN_ERROR\\\", realmId=\\\"staging-realm\\\", realmName=\\\"staging\\\", clientId=\\\"test-client\\\", userId=\\\"null\\\", ipAddress=\\\"198.51.100.123\\\", error=\\\"invalid_code\\\", grant_type=\\\"authorization_code\\\"\",\"process.thread.name\":\"executor-thread-4\",\"process.thread.id\":30,\"mdc\":{},\"ndc\":\"\",\"host.hostname\":\"example.com\",\"process.name\":\"/usr/lib/jvm/java-21-openjdk/bin/java\",\"process.pid\":1,\"ecs.version\":\"1.12.2\",\"data_stream.type\":\"logs\",\"service.name\":\"Keycloak\",\"service.version\":\"26.4.2\",\"service.environment\":\"staging\"}"
  },
  "expected": {
    "message": "{\"@timestamp\":\"2025-11-21T13:55:09.111222333Z\",\"event.sequence\":4420,\"log.logger\":\"org.keycloak.events\",\"log.level\":\"WARN\",\"message\":\"type=\\\"CODE_TO_TOKEN_ERROR\\\", realmId=\\\"staging-realm\\\", realmName=\\\"staging\\\", clientId=\\\"test-client\\\", userId=\\\"null\\\", ipAddress=\\\"198.51.100.123\\\", error=\\\"invalid_code\\\", grant_type=\\\"authorization_code\\\"\",\"process.thread.name\":\"executor-thread-4\",\"process.thread.id\":30,\"mdc\":{},\"ndc\":\"\",\"host.hostname\":\"example.com\",\"process.name\":\"/usr/lib/jvm/java-21-openjdk/bin/java\",\"process.pid\":1,\"ecs.version\":\"1.12.2\",\"data_stream.type\":\"logs\",\"service.name\":\"Keycloak\",\"service.version\":\"26.4.2\",\"service.environment\":\"staging\"}",
    "event": {
      "category": [
        "authentication"
      ],
      "code": "CODE_TO_TOKEN_ERROR",
      "outcome": "failure",
      "provider": "test-client",
      "type": [
        "denied"
      ]
    },
    "@timestamp": "2025-11-21T13:55:09.111222Z",
    "error": {
      "code": "invalid_code"
    },
    "host": {
      "name": "example.com"
    },
    "keycloak": {
      "realm": {
        "id": "staging-realm",
        "name": "staging"
      },
      "service": {
        "environment": "staging"
      }
    },
    "log": {
      "level": "WARN",
      "logger": "org.keycloak.events"
    },
    "process": {
      "name": "/usr/lib/jvm/java-21-openjdk/bin/java",
      "pid": 1,
      "thread": {
        "id": 30,
        "name": "executor-thread-4"
      }
    },
    "related": {
      "ip": [
        "198.51.100.123"
      ]
    },
    "service": {
      "name": "Keycloak",
      "version": "26.4.2"
    },
    "source": {
      "address": "198.51.100.123",
      "ip": "198.51.100.123"
    }
  }
}