{
  "input": {
    "message": "{\n  \"external_id\": \"d87d5e06-8119-4106-b4ab-0000eaf838b9\",\n  \"severity\": \"low\",\n  \"matching_status\": \"MATCHED\",\n  \"end_match_attempt_ts\": null,\n  \"local_insert_ts\": 1737129154091,\n  \"last_modified_ts\": null,\n  \"bioc_indicator\": null,\n  \"matching_service_rule_id\": \"d87d5e06-8119-4106-b4ab-0000eaf838b9\",\n  \"attempt_counter\": 0,\n  \"bioc_category_enum_key\": null,\n  \"case_id\": null,\n  \"is_whitelisted\": false,\n  \"starred\": false,\n  \"deduplicate_tokens\": null,\n  \"filter_rule_id\": null,\n  \"mitre_technique_id_and_name\": [\n    \"T1071 - Application Layer Protocol\",\n    \"T1059 - Command and Scripting Interpreter\"\n  ],\n  \"mitre_tactic_id_and_name\": [\n    \"TA0011 - Command and Control\",\n    \"TA0002 - Execution\"\n  ],\n  \"agent_version\": \"8.6.1.5418\",\n  \"agent_ip_addresses_v6\": null,\n  \"agent_device_domain\": null,\n  \"agent_fqdn\": null,\n  \"agent_os_type\": \"Windows\",\n  \"agent_os_sub_type\": \"Windows 11 [10.0 (Build 22631)]\",\n  \"agent_data_collection_status\": null,\n  \"mac\": null,\n  \"is_pcap\": false,\n  \"alert_type\": \"Unclassified\",\n  \"resolution_status\": \"STATUS_010_NEW\",\n  \"resolution_comment\": null,\n  \"dynamic_fields\": null,\n  \"tags\": [\n    \"EG:Client\",\n    \"ET:Cyber Security\",\n    \"EG:Cyber Security\",\n    \"DS:PANW/XDR Agent\"\n  ],\n  \"malicious_urls\": null,\n  \"alert_id\": \"1111\",\n  \"detection_timestamp\": 1737128783611,\n  \"name\": \"Scripting engine connected to a rare external host\",\n  \"category\": \"Command and Control\",\n  \"endpoint_id\": \"d87d5e06-8119-4106-b4ab-0000eaf838b9\",\n  \"description\": \"The scripting engine java.exe connected to 5.6.7.8. The address 5.6.7.8 was connected by 0 different endpoints across 0 unique days in the last 30 days. Command line: \\\"C:\\\\Program Files\\\\XDR\\\\jre\\\\bin\\\\java\\\" -XX:+UseParallelGC -Dfile.encoding=Cp1252 -Dsun.stdout.encoding=Cp1252 -Dsun.stderr.encoding=Cp1252 -Dwrapper.use_sun_encoding=true -Xms64m -Xmx128m -Djava.library.path=\\\"./19.484-1/bin/native/lib\\\" -classpath \\\"./19.484-1/lib/ant-1.10.14.jar;./19.484-1/lib/ant-launcher-1.10.14.jar;./19.484-1/lib/aopalliance-repackaged-2.6.1.jar;./19.484-1/lib/avro-1.11.3.jar;./19.484-1/lib/avro-fastserde-0.4.13.jar;./19.484-1/lib/avro-ipc-1.11.3.jar;./19.484-1/lib/avrox-19.484-1.jar;./19.484-1/lib/aws-java-sdk-core-1.12.269.jar;./19.484-1/lib/aws-java-sdk-kms-1.12.269.jar;./19.484-1/lib/aws-java-sdk-s3-1.12.269.jar;./19.484-1/lib/checker-qual-3.41.0.jar;./19.484-1/lib/classgraph-4.8.165.jar;./19.484-1/lib/codemodel-2.6.jar;./19.484-1/lib/collector-19.484-1-resources.jar;./19.484-1/lib/collector-19.484-1.jar;./19.484-1/lib/collector-base-19.484-1.jar;./19.484-1/lib/collector-interchange-19.484-1.jar;./19.484-1/lib/collector-util-19.484-1.jar;./19.484-1/lib/commons-beanutils-1.9.4.jar;./19.484-1/lib/commons-cli-1.6.0.jar;./19.484-1/lib/commons-codec-1.16.1.jar;./19.484-1/lib/commons-collections4-4.4.jar;./19.484-1/lib/commons-collections-3.2.2.jar;./19.484-1/lib/commons-compress-1.25.0.jar;./19.484-1/lib/commons-configuration2-2.9.0.jar;./19.484-1/lib/commons-configuration-1.10.jar;./19.484-1/lib/commons-digester-2.1.jar\\\" -Dwrapper.key=\\\"aaaaaaaaaaaaaaaaaaaaaaaaa\\\" -Dwrapper.port=32000 -Dwrapper.jvm.port.min=31000 -Dwrapper.jvm.port.max=31999 -Dwrapper.pid=5040 -Dwrapper.version=\\\"3.5.49-st\\\" -Dwrapper.native_library=\\\"wrapper\\\" -Dwrapper.arch=\\\"x86\\\" -Dwrapper.service=\\\"TRUE\\\" -Dwrapper.cpu.timeout=\\\"10\\\" -Dwrapper.jvmid=1 -Dwrapper.lang.domain=\\\"wrapper\\\" -Dwrapper.lang.folder=\\\"../lang\\\" org.tanukisoftware.wrapper.WrapperSimpleApp com.xdr.scala.collector.Collector\",\n  \"host_ip\": [\n    \"1.2.3.4\"\n  ],\n  \"host_name\": \"DESKTOP01\",\n  \"mac_addresses\": null,\n  \"source\": \"XDR Analytics BIOC\",\n  \"action\": \"DETECTED\",\n  \"action_pretty\": \"Detected\"\n}",
    "sekoiaio": {
      "intake": {
        "dialect": "Palo Alto Cortex XDR (EDR)",
        "dialect_uuid": "9b95c9cf-8b78-4830-a1ed-b9e88f05e67a"
      }
    }
  },
  "expected": {
    "message": "{\n  \"external_id\": \"d87d5e06-8119-4106-b4ab-0000eaf838b9\",\n  \"severity\": \"low\",\n  \"matching_status\": \"MATCHED\",\n  \"end_match_attempt_ts\": null,\n  \"local_insert_ts\": 1737129154091,\n  \"last_modified_ts\": null,\n  \"bioc_indicator\": null,\n  \"matching_service_rule_id\": \"d87d5e06-8119-4106-b4ab-0000eaf838b9\",\n  \"attempt_counter\": 0,\n  \"bioc_category_enum_key\": null,\n  \"case_id\": null,\n  \"is_whitelisted\": false,\n  \"starred\": false,\n  \"deduplicate_tokens\": null,\n  \"filter_rule_id\": null,\n  \"mitre_technique_id_and_name\": [\n    \"T1071 - Application Layer Protocol\",\n    \"T1059 - Command and Scripting Interpreter\"\n  ],\n  \"mitre_tactic_id_and_name\": [\n    \"TA0011 - Command and Control\",\n    \"TA0002 - Execution\"\n  ],\n  \"agent_version\": \"8.6.1.5418\",\n  \"agent_ip_addresses_v6\": null,\n  \"agent_device_domain\": null,\n  \"agent_fqdn\": null,\n  \"agent_os_type\": \"Windows\",\n  \"agent_os_sub_type\": \"Windows 11 [10.0 (Build 22631)]\",\n  \"agent_data_collection_status\": null,\n  \"mac\": null,\n  \"is_pcap\": false,\n  \"alert_type\": \"Unclassified\",\n  \"resolution_status\": \"STATUS_010_NEW\",\n  \"resolution_comment\": null,\n  \"dynamic_fields\": null,\n  \"tags\": [\n    \"EG:Client\",\n    \"ET:Cyber Security\",\n    \"EG:Cyber Security\",\n    \"DS:PANW/XDR Agent\"\n  ],\n  \"malicious_urls\": null,\n  \"alert_id\": \"1111\",\n  \"detection_timestamp\": 1737128783611,\n  \"name\": \"Scripting engine connected to a rare external host\",\n  \"category\": \"Command and Control\",\n  \"endpoint_id\": \"d87d5e06-8119-4106-b4ab-0000eaf838b9\",\n  \"description\": \"The scripting engine java.exe connected to 5.6.7.8. The address 5.6.7.8 was connected by 0 different endpoints across 0 unique days in the last 30 days. Command line: \\\"C:\\\\Program Files\\\\XDR\\\\jre\\\\bin\\\\java\\\" -XX:+UseParallelGC -Dfile.encoding=Cp1252 -Dsun.stdout.encoding=Cp1252 -Dsun.stderr.encoding=Cp1252 -Dwrapper.use_sun_encoding=true -Xms64m -Xmx128m -Djava.library.path=\\\"./19.484-1/bin/native/lib\\\" -classpath \\\"./19.484-1/lib/ant-1.10.14.jar;./19.484-1/lib/ant-launcher-1.10.14.jar;./19.484-1/lib/aopalliance-repackaged-2.6.1.jar;./19.484-1/lib/avro-1.11.3.jar;./19.484-1/lib/avro-fastserde-0.4.13.jar;./19.484-1/lib/avro-ipc-1.11.3.jar;./19.484-1/lib/avrox-19.484-1.jar;./19.484-1/lib/aws-java-sdk-core-1.12.269.jar;./19.484-1/lib/aws-java-sdk-kms-1.12.269.jar;./19.484-1/lib/aws-java-sdk-s3-1.12.269.jar;./19.484-1/lib/checker-qual-3.41.0.jar;./19.484-1/lib/classgraph-4.8.165.jar;./19.484-1/lib/codemodel-2.6.jar;./19.484-1/lib/collector-19.484-1-resources.jar;./19.484-1/lib/collector-19.484-1.jar;./19.484-1/lib/collector-base-19.484-1.jar;./19.484-1/lib/collector-interchange-19.484-1.jar;./19.484-1/lib/collector-util-19.484-1.jar;./19.484-1/lib/commons-beanutils-1.9.4.jar;./19.484-1/lib/commons-cli-1.6.0.jar;./19.484-1/lib/commons-codec-1.16.1.jar;./19.484-1/lib/commons-collections4-4.4.jar;./19.484-1/lib/commons-collections-3.2.2.jar;./19.484-1/lib/commons-compress-1.25.0.jar;./19.484-1/lib/commons-configuration2-2.9.0.jar;./19.484-1/lib/commons-configuration-1.10.jar;./19.484-1/lib/commons-digester-2.1.jar\\\" -Dwrapper.key=\\\"aaaaaaaaaaaaaaaaaaaaaaaaa\\\" -Dwrapper.port=32000 -Dwrapper.jvm.port.min=31000 -Dwrapper.jvm.port.max=31999 -Dwrapper.pid=5040 -Dwrapper.version=\\\"3.5.49-st\\\" -Dwrapper.native_library=\\\"wrapper\\\" -Dwrapper.arch=\\\"x86\\\" -Dwrapper.service=\\\"TRUE\\\" -Dwrapper.cpu.timeout=\\\"10\\\" -Dwrapper.jvmid=1 -Dwrapper.lang.domain=\\\"wrapper\\\" -Dwrapper.lang.folder=\\\"../lang\\\" org.tanukisoftware.wrapper.WrapperSimpleApp com.xdr.scala.collector.Collector\",\n  \"host_ip\": [\n    \"1.2.3.4\"\n  ],\n  \"host_name\": \"DESKTOP01\",\n  \"mac_addresses\": null,\n  \"source\": \"XDR Analytics BIOC\",\n  \"action\": \"DETECTED\",\n  \"action_pretty\": \"Detected\"\n}",
    "event": {
      "action": "DETECTED",
      "category": [
        "intrusion_detection"
      ],
      "dataset": "alert",
      "kind": "alert",
      "outcome": "MATCHED",
      "reason": "The scripting engine java.exe connected to 5.6.7.8. The address 5.6.7.8 was connected by 0 different endpoints across 0 unique days in the last 30 days. Command line: \"C:\\Program Files\\XDR\\jre\\bin\\java\" -XX:+UseParallelGC -Dfile.encoding=Cp1252 -Dsun.stdout.encoding=Cp1252 -Dsun.stderr.encoding=Cp1252 -Dwrapper.use_sun_encoding=true -Xms64m -Xmx128m -Djava.library.path=\"./19.484-1/bin/native/lib\" -classpath \"./19.484-1/lib/ant-1.10.14.jar;./19.484-1/lib/ant-launcher-1.10.14.jar;./19.484-1/lib/aopalliance-repackaged-2.6.1.jar;./19.484-1/lib/avro-1.11.3.jar;./19.484-1/lib/avro-fastserde-0.4.13.jar;./19.484-1/lib/avro-ipc-1.11.3.jar;./19.484-1/lib/avrox-19.484-1.jar;./19.484-1/lib/aws-java-sdk-core-1.12.269.jar;./19.484-1/lib/aws-java-sdk-kms-1.12.269.jar;./19.484-1/lib/aws-java-sdk-s3-1.12.269.jar;./19.484-1/lib/checker-qual-3.41.0.jar;./19.484-1/lib/classgraph-4.8.165.jar;./19.484-1/lib/codemodel-2.6.jar;./19.484-1/lib/collector-19.484-1-resources.jar;./19.484-1/lib/collector-19.484-1.jar;./19.484-1/lib/collector-base-19.484-1.jar;./19.484-1/lib/collector-interchange-19.484-1.jar;./19.484-1/lib/collector-util-19.484-1.jar;./19.484-1/lib/commons-beanutils-1.9.4.jar;./19.484-1/lib/commons-cli-1.6.0.jar;./19.484-1/lib/commons-codec-1.16.1.jar;./19.484-1/lib/commons-collections4-4.4.jar;./19.484-1/lib/commons-collections-3.2.2.jar;./19.484-1/lib/commons-compress-1.25.0.jar;./19.484-1/lib/commons-configuration2-2.9.0.jar;./19.484-1/lib/commons-configuration-1.10.jar;./19.484-1/lib/commons-digester-2.1.jar\" -Dwrapper.key=\"aaaaaaaaaaaaaaaaaaaaaaaaa\" -Dwrapper.port=32000 -Dwrapper.jvm.port.min=31000 -Dwrapper.jvm.port.max=31999 -Dwrapper.pid=5040 -Dwrapper.version=\"3.5.49-st\" -Dwrapper.native_library=\"wrapper\" -Dwrapper.arch=\"x86\" -Dwrapper.service=\"TRUE\" -Dwrapper.cpu.timeout=\"10\" -Dwrapper.jvmid=1 -Dwrapper.lang.domain=\"wrapper\" -Dwrapper.lang.folder=\"../lang\" org.tanukisoftware.wrapper.WrapperSimpleApp com.xdr.scala.collector.Collector",
      "type": [
        "info"
      ]
    },
    "@timestamp": "2025-01-17T15:46:23.611000Z",
    "agent": {
      "version": "8.6.1.5418"
    },
    "destination": {
      "address": "5.6.7.8",
      "ip": "5.6.7.8"
    },
    "host": {
      "id": "d87d5e06-8119-4106-b4ab-0000eaf838b9",
      "ip": [
        "1.2.3.4"
      ],
      "name": "DESKTOP01",
      "os": {
        "name": "Windows"
      }
    },
    "observer": {
      "product": "Palo Alto Cortex XDR",
      "vendor": "Palo Alto"
    },
    "paloalto": {
      "cortex": {
        "xdr": {
          "alert": {
            "category": "Command and Control",
            "externalID": "d87d5e06-8119-4106-b4ab-0000eaf838b9",
            "id": "1111",
            "name": "Scripting engine connected to a rare external host",
            "ruleID": {
              "matching_service": "d87d5e06-8119-4106-b4ab-0000eaf838b9"
            },
            "severity": "low"
          }
        }
      }
    },
    "process": {
      "command_line": "\"C:\\Program Files\\XDR\\jre\\bin\\java\" -XX:+UseParallelGC -Dfile.encoding=Cp1252 -Dsun.stdout.encoding=Cp1252 -Dsun.stderr.encoding=Cp1252 -Dwrapper.use_sun_encoding=true -Xms64m -Xmx128m -Djava.library.path=\"./19.484-1/bin/native/lib\" -classpath \"./19.484-1/lib/ant-1.10.14.jar;./19.484-1/lib/ant-launcher-1.10.14.jar;./19.484-1/lib/aopalliance-repackaged-2.6.1.jar;./19.484-1/lib/avro-1.11.3.jar;./19.484-1/lib/avro-fastserde-0.4.13.jar;./19.484-1/lib/avro-ipc-1.11.3.jar;./19.484-1/lib/avrox-19.484-1.jar;./19.484-1/lib/aws-java-sdk-core-1.12.269.jar;./19.484-1/lib/aws-java-sdk-kms-1.12.269.jar;./19.484-1/lib/aws-java-sdk-s3-1.12.269.jar;./19.484-1/lib/checker-qual-3.41.0.jar;./19.484-1/lib/classgraph-4.8.165.jar;./19.484-1/lib/codemodel-2.6.jar;./19.484-1/lib/collector-19.484-1-resources.jar;./19.484-1/lib/collector-19.484-1.jar;./19.484-1/lib/collector-base-19.484-1.jar;./19.484-1/lib/collector-interchange-19.484-1.jar;./19.484-1/lib/collector-util-19.484-1.jar;./19.484-1/lib/commons-beanutils-1.9.4.jar;./19.484-1/lib/commons-cli-1.6.0.jar;./19.484-1/lib/commons-codec-1.16.1.jar;./19.484-1/lib/commons-collections4-4.4.jar;./19.484-1/lib/commons-collections-3.2.2.jar;./19.484-1/lib/commons-compress-1.25.0.jar;./19.484-1/lib/commons-configuration2-2.9.0.jar;./19.484-1/lib/commons-configuration-1.10.jar;./19.484-1/lib/commons-digester-2.1.jar\" -Dwrapper.key=\"aaaaaaaaaaaaaaaaaaaaaaaaa\" -Dwrapper.port=32000 -Dwrapper.jvm.port.min=31000 -Dwrapper.jvm.port.max=31999 -Dwrapper.pid=5040 -Dwrapper.version=\"3.5.49-st\" -Dwrapper.native_library=\"wrapper\" -Dwrapper.arch=\"x86\" -Dwrapper.service=\"TRUE\" -Dwrapper.cpu.timeout=\"10\" -Dwrapper.jvmid=1 -Dwrapper.lang.domain=\"wrapper\" -Dwrapper.lang.folder=\"../lang\" org.tanukisoftware.wrapper.WrapperSimpleApp com.xdr.scala.collector.Collector",
      "executable": "C:\\Program Files\\XDR\\jre\\bin\\java",
      "name": "java.exe"
    },
    "related": {
      "ip": [
        "1.2.3.4",
        "5.6.7.8"
      ]
    }
  }
}