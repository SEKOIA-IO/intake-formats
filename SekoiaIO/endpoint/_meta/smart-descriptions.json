[
  {
    "value": "Hostname: {host.hostname} - Source: {event.provider} - EventID: {event.code}",
    "conditions": []
  },
  {
    "value": "Action: {event.action} - Hostname: {host.hostname}",
    "conditions": [
      {
        "field": "event.action"
      }
    ]
  },
  {
    "value": "The agent on {host.hostname} didn't send events for the last {action.properties.time_without_events} seconds",
    "conditions": [
      {
        "field": "event.action",
        "value": "agent-inactivity"
      },
      {
        "field": "action.properties.time_without_events"
      }
    ]
  },
  {
    "value": "The agent is using {sekoiaio.agent.cpu_usage}% of CPU and {sekoiaio.agent.memory_usage} bytes of RAM on {host.hostname}",
    "conditions": [
      {
        "field": "event.action",
        "value": "stats"
      },
      {
        "field": "sekoiaio.agent.cpu_usage"
      }
    ]
  },
  {
    "value": "Process {process.command_line} was started on {host.hostname} by {user.domain}\\{user.name}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.command_line"
      },
      {
        "field": "user.domain"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Process {process.executable} was started on {host.hostname} by {user.domain}\\{user.name}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "user.domain"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.executable",
        "type": "executed"
      },
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Process {process.command_line} was started on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.command_line"
      }
    ],
    "relationships": [
      {
        "source": "process.command_line",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Process {process.executable} was started on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.executable"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Process {process.command_line} exited. It was executed on {host.hostname} by {user.domain}\\{user.name}",
    "conditions": [
      {
        "field": "event.code",
        "value": "5"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.command_line"
      },
      {
        "field": "user.domain"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Process {process.executable} exited. It was executed on {host.hostname} by {user.domain}\\{user.name}",
    "conditions": [
      {
        "field": "event.code",
        "value": "5"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.executable"
      },
      {
        "field": "user.domain"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.executable",
        "type": "executed"
      },
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Process {process.command_line} exited. It was executed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "5"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.command_line"
      }
    ],
    "relationships": [
      {
        "source": "process.command_line",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Process {process.executable} exited. It was executed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "5"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.executable"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} logged on to {host.hostname} (LogonType {action.properties.LogonType})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4624
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "logged on to"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} logged on to {host.hostname} from IP {source.ip} (LogonType {action.properties.LogonType})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4624
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "source.ip"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "logged on to"
      },
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "connected from"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} failed to log on to {host.hostname} (LogonType {action.properties.LogonType})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4625
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "failed to log on to"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} failed to log on to {host.hostname} from IP {source.ip} (LogonType {action.properties.LogonType})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4625
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "source.ip"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "failed to log on to"
      },
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "connected from"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} logged off from {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4634
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "logged off from"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} attempted to log on to {action.properties.TargetServerName} using explicit credentials",
    "conditions": [
      {
        "field": "action.id",
        "value": 4648
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.TargetServerName",
        "type": "attempted to log on to"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} attempted to log on to {host.hostname} using explicit credentials",
    "conditions": [
      {
        "field": "action.id",
        "value": 4648
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.TargetServerName",
        "value": "localhost"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "host.hostname",
        "type": "attempted to log on to"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} modified the value {action.properties.ObjectValueName} of the registry key {action.properties.ObjectName} to {action.properties.NewValue} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4657
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.ObjectName",
        "type": "modified registry value from"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} accessed the object {action.properties.ObjectName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4662
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.ObjectName",
        "type": "accessed"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} logged on to {host.hostname} with special privileges",
    "conditions": [
      {
        "field": "action.id",
        "value": 4672
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "logged on to"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} executed {process.command_line} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4688
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "user.name",
        "target": "process.parent.executable",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.executable",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "process.parent.executable",
        "target": "process.command_line",
        "type": "started"
      }
    ]
  },
  {
    "value": "Process {process.name} exited. It was executed by {user.domain}\\{user.name} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4689
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.executable",
        "type": "executed"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} created account {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4720
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetDomainName",
        "type": "created account"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} enabled account {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4722
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetDomainName",
        "type": "enabled account"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} changed their password on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4723
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "changed their password on"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} failed to change their password on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4723
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "failed to change their password on"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} disabled account {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4725
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "disabled account"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} deleted account {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4726
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "deleted account"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} created group {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4727
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "created group"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} failed to authenticate from {source.ip} (Error Code: {action.properties.Status})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4768
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "failed to log on to"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} successfully authenticated from {source.ip} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4768
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "logged on to"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} was granted a service ticket for {action.properties.ServiceName} from {source.ip}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4769
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.properties.EventType",
        "value": "AUDIT_SUCCESS"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.ServiceName",
        "type": "was granted a ticket for"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} was granted a service ticket for {action.properties.ServiceName} from {source.ip}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4769
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.ServiceName",
        "type": "was granted a ticket for"
      }
    ]
  },
  {
    "value": "{action.properties.TargetDomainName}\\{action.properties.TargetUserName} was denied a service ticket for {action.properties.ServiceName} from {source.ip} (Error Code: {action.properties.Status})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4769
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.ServiceName",
        "type": "was denied a ticket for"
      }
    ]
  },
  {
    "value": "{action.properties.TargetUserName} failed to authenticate from {source.ip} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4771
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "source.ip",
        "type": "failed to authenticate on"
      }
    ]
  },
  {
    "value": "{action.properties.TargetUserName} failed to authenticate on {action.properties.Workstation} on {host.hostname} (Reason: {action.properties.Status})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4776
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.Workstation",
        "type": "failed to log on to"
      }
    ]
  },
  {
    "value": "{action.properties.TargetUserName} successfully authenticated on {action.properties.Workstation} (hostname: {host.hostname})",
    "conditions": [
      {
        "field": "action.id",
        "value": 4776
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.TargetUserName",
        "target": "action.properties.Workstation",
        "type": "logged on to"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} enumerated local groups of {action.properties.TargetDomainName}\\{action.properties.TargetUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4798
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "enumerated local groups of"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} enumerated members of local group {action.properties.TargetUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4799
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.TargetUserName",
        "type": "enumerated members of"
      }
    ]
  },
  {
    "value": "Authenticated user {user.name} was denied the access to Remote Desktop to {host.hostname} from IP {action.properties.ClientAddress}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4825
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "wad denied RDP access to"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} was granted access to {action.properties.ShareName}\\{action.properties.RelativeTargetName} from IP {source.ip} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 5145
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.RelativeTargetName",
        "type": "accessed shared file"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} was denied access to {action.properties.ShareName}\\{action.properties.RelativeTargetName} from IP {source.ip} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 5145
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "action.properties.RelativeTargetName",
        "type": "failed to access shared file"
      }
    ]
  },
  {
    "value": "{action.properties.Application} was allowed to listen on {source.ip}:{source.port} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 5154
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.Application",
        "target": "host.hostname",
        "type": "listened to port {source.port} on"
      }
    ]
  },
  {
    "value": "{host.hostname} allowed a connection from {source.ip}:{source.port} to {destination.ip}:{destination.port}",
    "conditions": [
      {
        "field": "action.id",
        "value": 5156
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Security-Auditing"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} executed PowerShell code on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4103
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} executed PowerShell code on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4104
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Started invocation of PowerShell ScriptBlock on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4105
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Completed invocation of PowerShell ScriptBlock on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4106
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Vault credentials were read by {action.properties.SubjectUserName} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 5382
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "PowerShell console is starting up on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 40961
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "PowerShell console is ready for user input on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 40962
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Windows PowerShell has started an IPC listening thread on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 53504
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-PowerShell"
      }
    ]
  },
  {
    "value": "Process {process.executable} created by {user.name} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 1
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.command_line",
        "type": "executed"
      },
      {
        "source": "process.command_line",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "process.command_line",
        "target": "process.executable",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.parent.name",
        "type": "uses executable"
      },
      {
        "source": "process.parent.command_line",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "process.parent.command_line",
        "target": "process.command_line",
        "type": "started"
      }
    ]
  },
  {
    "value": "Process {process.executable} changed the creation time of the file {file.name} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 2
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "file.name",
        "type": "changed creation time of"
      },
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "executed on"
      }
    ]
  },
  {
    "value": "Network connection from {source.ip} to {destination.ip}:{destination.port} by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "3"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      }
    ]
  },
  {
    "value": "Sysmon service state changed to {action.properties.State} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 4
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Process {process.executable} terminated on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 5
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "terminated on"
      }
    ]
  },
  {
    "value": "Driver {process.executable} loaded on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 6
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "loaded on"
      }
    ]
  },
  {
    "value": "Process {process.executable} loaded image {action.properties.ImageLoaded} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 7
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "process.executable",
        "target": "action.properties.ImageLoaded",
        "type": "loaded image"
      }
    ]
  },
  {
    "value": "Process {action.properties.SourceImage} created a thread in process {action.properties.TargetImage} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 8
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.SourceImage",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "action.properties.TargetImage",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "action.properties.SourceImage",
        "target": "action.properties.TargetImage",
        "type": "created thread in"
      }
    ]
  },
  {
    "value": "Process {process.executable} read on {action.properties.Device} device on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 9
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "process.executable",
        "target": "action.properties.Device",
        "type": "read on"
      }
    ]
  },
  {
    "value": "{action.properties.SourceImage} was granted {action.properties.GrantedAccess} access to {action.properties.TargetImage} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 10
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ],
    "relationships": [
      {
        "source": "action.properties.SourceImage",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "action.properties.TargetImage",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "action.properties.SourceImage",
        "target": "action.properties.TargetImage",
        "type": "was granted access to"
      }
    ]
  },
  {
    "value": "Directory {file.name} created by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "event.action",
        "value": "directory-created"
      },
      {
        "field": "event.category",
        "value": "file"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      }
    ]
  },
  {
    "value": "{file.name} renamed by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "event.action",
        "value": "renamed"
      },
      {
        "field": "event.category",
        "value": "file"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      }
    ]
  },
  {
    "value": "{file.name} created by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "11"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      }
    ]
  },
  {
    "value": "Registry key {action.properties.TargetObject} created by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 12
      },
      {
        "field": "action.properties.MessEventType",
        "value": "CreateKey"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry value {action.properties.TargetObject} created by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 12
      },
      {
        "field": "action.properties.MessEventType",
        "value": "CreateValue"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry key {action.properties.TargetObject} deleted by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 12
      },
      {
        "field": "action.properties.MessEventType",
        "value": "DeleteKey"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry value {action.properties.TargetObject} deleted by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 12
      },
      {
        "field": "action.properties.MessEventType",
        "value": "DeleteValue"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry key {action.properties.TargetObject} set by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 13
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry key {action.properties.TargetObject} renamed to {action.properties.NewName} by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 14
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Registry value {action.properties.TargetObject} renamed to {action.properties.NewName} by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 14
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      },
      {
        "field": "action.properties.MessEventType",
        "value": "RenameValue"
      }
    ]
  },
  {
    "value": "{action.properties.Image} added a named stream to file {action.properties.TargetFilename} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 15
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Sysmon configuration was updated on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 16
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Pipe {action.properties.PipeName} created by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 17
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "Pipe {action.properties.PipeName} connected by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 18
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "{action.properties.User} created WMI Event Filter {action.properties.Name} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 19
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "{action.properties.User} {action.properties.Operation} WMI Consumer {action.properties.Name} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 20
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "{action.properties.User} bound WMI Consumer {action.properties.Consumer} to Event Filter {action.properties.Filter} on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 21
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Sysmon"
      }
    ]
  },
  {
    "value": "{host.hostname} performed a DNS query for {dns.question.name}",
    "conditions": [
      {
        "field": "event.code",
        "value": "22"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "dns.type",
        "value": "query"
      }
    ]
  },
  {
    "value": "{host.hostname} received a DNS answer for {dns.question.name}",
    "conditions": [
      {
        "field": "event.code",
        "value": "22"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "dns.type",
        "value": "answer"
      }
    ]
  },
  {
    "value": "Microsoft Defender Antivirus client is up and running in a healthy state on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 1150
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Windows Defender"
      }
    ]
  },
  {
    "value": "An anti-malware scan was stopped before it finished on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 1002
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Windows Defender"
      }
    ]
  },
  {
    "value": "An anti-malware scan finished on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 1001
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Windows Defender"
      }
    ]
  },
  {
    "value": "An anti-malware scan started on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 1000
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Windows Defender"
      }
    ]
  },
  {
    "value": "Windows Update successfully found updates on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 26
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WindowsUpdateClient"
      }
    ]
  },
  {
    "value": "W32time Service configuration parameters have been updated on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 263
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Time-Service"
      }
    ]
  },
  {
    "value": "Updated Windows Defender status successfully to SECURITY_PRODUCT_STATE_ON on {host.hostname}",
    "conditions": [
      {
        "field": "action.id",
        "value": 15
      },
      {
        "field": "event.provider",
        "value": "SecurityCenter"
      }
    ]
  },
  {
    "value": "Remote thread created from {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "8"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "process.executable"
      }
    ],
    "relationships": [
      {
        "source": "process.command_line",
        "target": "host.hostname",
        "type": "executed on"
      },
      {
        "source": "sekoiaio.source_process.command_line",
        "target": "sekoiaio.target_process.command_line",
        "type": "created remote thread in"
      }
    ]
  },
  {
    "value": "{file.name} deleted by {process.executable} on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "23"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "file.name"
      },
      {
        "field": "process.executable"
      }
    ],
    "relationships": [
      {
        "source": "file.name",
        "target": "process.executable",
        "type": "deleted by"
      }
    ]
  },
  {
    "value": "Operation {event.action} triggered for task {action.properties.TaskName} on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "26"
      },
      {
        "field": "event.provider",
        "value": "SEKOIA-IO-Endpoint"
      },
      {
        "field": "event.action"
      },
      {
        "field": "action.properties.TaskName"
      }
    ]
  },
  {
    "value": "RDP Server - Connection received",
    "conditions": [
      {
        "field": "event.code",
        "value": "261"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-RemoteConnectionManager"
      }
    ]
  },
  {
    "value": "RDP Server Connection started on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "272"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-RemoteConnectionManager"
      }
    ]
  },
  {
    "value": "RDP Server {host.hostname} - User successfully authenticated from {source.address} as {user.name}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1149"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-RemoteConnectionManager"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.address"
      }
    ],
    "relationships": [
      {
        "source": "source.address",
        "target": "host.hostname",
        "type": "connected to"
      },
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "authenticated on"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name}: Session logon success on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "21"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-LocalSessionManager"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "logged on"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name}: Session shell start on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "22"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-LocalSessionManager"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "started shell on"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name}: Session logoff on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "23"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-LocalSessionManager"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "logged off"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name}: Session disconnected on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "24"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-LocalSessionManager"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "session disconnected"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name}: Session reconnected on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "25"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-LocalSessionManager"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "session reconnected"
      }
    ]
  },
  {
    "value": "Session disconnected by other on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "39"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-LocalSessionManager"
      }
    ]
  },
  {
    "value": "Session disconnected on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "40"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-TerminalServices-LocalSessionManager"
      }
    ]
  },
  {
    "value": "DFSN namespace added on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "514"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DFSN-Server"
      }
    ]
  },
  {
    "value": "DFSN namespace removed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "515"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DFSN-Server"
      }
    ]
  },
  {
    "value": "DHCP Server - Callout DLL error on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1031"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DHCP-Server"
      }
    ]
  },
  {
    "value": "DHCP Server - Callout DLL error on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1032"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DHCP-Server"
      }
    ]
  },
  {
    "value": "DHCP Server - Load DLL success on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1033"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DHCP-Server"
      }
    ]
  },
  {
    "value": "DHCP Server - Load DLL error on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1034"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DHCP-Server"
      }
    ]
  },
  {
    "value": "DNS Server - Plugin load DLL success on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "770"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DNS-Server-Service"
      }
    ]
  },
  {
    "value": "DNS Server - Plugin load DLL error on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "150"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DNS-Server-Service"
      }
    ]
  },
  {
    "value": "DNS Server - Setting changed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "541"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-DNS-Server"
      }
    ]
  },
  {
    "value": "Eventlog shutdown on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1100"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Eventlog"
      }
    ]
  },
  {
    "value": "Eventlog cleared by {user.domain}\\{user.name} on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1102"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Eventlog"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.hostname",
        "type": "cleared eventlog"
      }
    ]
  },
  {
    "value": "System time changed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Kernel-General"
      }
    ]
  },
  {
    "value": "Windows startup on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "12"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Kernel-General"
      }
    ]
  },
  {
    "value": "Windows shutdown on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "13"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Kernel-General"
      }
    ]
  },
  {
    "value": "Hive access history cleared on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "16"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-Kernel-General"
      }
    ]
  },
  {
    "value": "LSA groups affected to session for user {user.domain}\\{user.name} on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "300"
      },
      {
        "field": "event.provider",
        "value": "LsaSrv"
      },
      {
        "field": "user.name"
      }
    ]
  },
  {
    "value": "New service installed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "7045"
      },
      {
        "field": "event.provider",
        "value": "Service Control Manager"
      }
    ]
  },
  {
    "value": "Smartcard verification failure on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "100"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-SmartCard-Audit"
      }
    ]
  },
  {
    "value": "Smartcard verification success on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "101"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-SmartCard-Audit"
      }
    ]
  },
  {
    "value": "Creating WS-Management session on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "6"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "Closing WS-Management session on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "8"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WS-Management shell created on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "11"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "Executing WS-Management command on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "13"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WS-Management command closed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "15"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WS-Management shell closed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "16"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WS-Management session created on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "31"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WS-Management session closed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "33"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WinRM user authentication-failed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "162"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WinRM user authorization-failed on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "192"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WinRM  user authenticated on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1295"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WinRM authorizing user on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1536"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "WinRM user authorized on {host.hostname}",
    "conditions": [
      {
        "field": "event.code",
        "value": "1537"
      },
      {
        "field": "event.provider",
        "value": "Microsoft-Windows-WinRM"
      }
    ]
  },
  {
    "value": "Agent log on {host.hostname}: [{log.level}]: {event.reason}",
    "conditions": [
      {
        "field": "event.reason"
      },
      {
        "field": "log.level"
      }
    ]
  },
  {
    "value": "Action: {event.action} - Executable {process.executable} - Hostname: {host.hostname}",
    "conditions": [
      {
        "field": "event.action"
      },
      {
        "field": "process.executable"
      }
    ]
  }
]
